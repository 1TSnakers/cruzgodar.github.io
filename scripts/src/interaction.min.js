import{Applet}from"../applets/applet.min.js";import{removeHoverEvents}from"./hoverEvents.min.js";import{addTemporaryListener}from"./main.min.js";let currentlyTouchDevice="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,lastMousemoveEvent=0;function initInteractionListeners(){var e=handleTouchEvent.bind(this);document.documentElement.addEventListener("touchstart",e,!1),document.documentElement.addEventListener("touchmove",e,!1),document.documentElement.addEventListener("mousemove",()=>{var e;currentlyTouchDevice&&(e=Date.now()-lastMousemoveEvent,lastMousemoveEvent=Date.now(),3<=e)&&e<=50&&33!=e&&(currentlyTouchDevice=!1)}),document.documentElement.addEventListener("keydown",e=>{"Enter"!==e.key||"BUTTON"===document.activeElement.tagName||"INPUT"===document.activeElement.tagName&&"button"!==document.activeElement.getAttribute("type")||document.activeElement.click()}),document.documentElement.addEventListener("pointerdown",()=>{"INPUT"===document.activeElement.tagName&&"range"!==document.activeElement.type||"TEXTAREA"===document.activeElement.tagName||document.activeElement.blur()}),document.documentElement.addEventListener("pointerup",()=>{"INPUT"===document.activeElement.tagName&&"range"!==document.activeElement.type||"TEXTAREA"===document.activeElement.tagName||document.activeElement.blur()})}function handleTouchEvent(){"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName&&"SELECT"!==document.activeElement.tagName&&document.activeElement.blur(),currentlyTouchDevice||(removeHoverEvents(),currentlyTouchDevice=!0)}function listenForFullscreenKey(){addTemporaryListener({object:document.documentElement,event:"keydown",callback:e=>{if("f"===e.key&&"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName){let e=1/0,t=0;for(let n=0;n<Applet.current.length;n++){var c=Applet.current[n];if(c.allowFullscreenWithKeyboard){var o=c.wilsonForFullscreen??c.wilson;if(o.fullscreen.currentlyFullscreen)return void o.fullscreen.switchFullscreen();o=c.canvas.getBoundingClientRect(),c=o.top+o.height/2,o=Math.abs(window.innerHeight/2-c);o<e&&(e=o,t=n)}}(Applet.current[t].wilsonForFullscreen??Applet.current[t].wilson).fullscreen.switchFullscreen()}}})}export{currentlyTouchDevice,initInteractionListeners,listenForFullscreenKey};