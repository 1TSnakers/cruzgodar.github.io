import anime from"../anime.min.js";import{cardAnimationTime}from"./animation.min.js";import{addHoverEventWithScale}from"./hoverEvents.min.js";import{$,$$,pageElement}from"./main.min.js";const contentsSelector=".notes-title:not(.notes-pf-title), .section-text, .heading-text";let contentsContainerElement,contentsElement,contentsShown=!1;function setUpPageContents(){const e=$(".nav-buttons");e&&(prepareContents(),e.lastElementChild.insertAdjacentHTML("afterend",`
		<div class="focus-on-child contents-button-container" tabindex="1">
			<button class="text-button linked-text-button" type="button" tabindex="-1">Contents</button>
		</div>
	`),e.classList.add("contents-container"),setTimeout(()=>{var t=e.lastElementChild.firstElementChild;addHoverEventWithScale(t,1.075),t.addEventListener("click",showContents)}))}function prepareContents(){(contentsContainerElement=document.createElement("div")).id="contents-container",pageElement.appendChild(contentsContainerElement),(contentsElement=document.createElement("div")).id="contents",contentsContainerElement.append(contentsElement),$$(contentsSelector).forEach(element=>{var t,e=element.cloneNode(!0);e.classList.contains("heading-text")&&-1!==(t=e.textContent.indexOf(":"))&&(e.textContent=e.textContent.slice(t+2)),contentsElement.appendChild(e),e.addEventListener("click",()=>{element.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),window.innerWidth<1e3&&hideContents()}),addHoverEventWithScale(e,1.025)}),contentsContainerElement.style.opacity=0,contentsContainerElement.style.marginRight="-32px",contentsContainerElement.style.display="none"}async function showContents(){contentsShown||(contentsShown=!0,contentsContainerElement.style.display="flex",await anime({targets:contentsContainerElement,opacity:1,marginRight:0,duration:cardAnimationTime,easing:"easeOutQuint"}).finished,document.documentElement.addEventListener("click",handleClickEvent))}async function hideContents(){contentsShown&&(document.documentElement.removeEventListener("click",handleClickEvent),await anime({targets:contentsContainerElement,opacity:0,marginRight:"-32px",duration:cardAnimationTime,easing:"easeOutQuint"}).finished,contentsContainerElement.style.display="none",contentsShown=!1)}function handleClickEvent(e){let t=e.target;for(;t!==pageElement;){if(t===contentsElement)return;t=t.parentElement}hideContents()}export{setUpPageContents};