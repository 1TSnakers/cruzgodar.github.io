import anime from"../anime.min.js";import{opacityAnimationTime}from"./animation.min.js";import{headerElement}from"./header.min.js";import{addHoverEvent}from"./hover-events.min.js";import{$$,addTemporaryListener,pageUrl}from"./main.min.js";import{redirect}from"./navigation.min.js";import{sitemap}from"./sitemap.min.js";function setUpTextButtons(){addTemporaryListener({object:window,event:"resize",callback:equalizeTextButtons}),setTimeout(equalizeTextButtons,50),setTimeout(equalizeTextButtons,500)}function equalizeTextButtons(){$$(".text-button").forEach(textButton=>textButton.parentNode.style.margin="0 auto");const e=[];let t=0;const n=[];let i=0;var o=$$(".linked-text-button");o.forEach((element,index)=>{element.style.height="fit-content",element.style.width="fit-content",e.push(element.offsetHeight),e[index]>t&&(t=e[index]),n.push(element.offsetWidth),n[index]>i&&(i=n[index])}),o.forEach((element,index)=>{e[index]<t?element.style.height=t+"px":element.style.height="fit-content",n[index]<i?element.style.width=i+"px":element.style.width="fit-content",element.parentNode.parentNode.style.gridTemplateColumns=`repeat(auto-fit, ${i}px`})}function setUpNavButtons(){if(sitemap[pageUrl].parent){const e=sitemap[sitemap[pageUrl].parent].children,t=e.indexOf(pageUrl);-1===t?console.error("Page not found in page list!"):(0<t?$$(".previous-nav-button").forEach(element=>{element.addEventListener("click",()=>redirect({url:e[t-1]}))}):$$(".previous-nav-button").forEach(element=>element.parentNode.remove()),$$(".home-nav-button").forEach(element=>{element.addEventListener("click",()=>redirect({url:sitemap[pageUrl].parent}))}),t<e.length-1?$$(".next-nav-button").forEach(element=>{element.addEventListener("click",()=>redirect({url:e[t+1]}))}):$$(".next-nav-button").forEach(element=>element.parentNode.remove()))}}function setUpDropdown(selectElement){let l=!1,o=0,s=1;const d=selectElement.previousElementSibling,m=(d.innerHTML="",d.parentNode.parentNode.style.gridTemplateColumns="repeat(auto-fit, 100%)",document.createElement("div")),p=(m.classList.add("option-container"),d.appendChild(m),[]),a=[];async function c(e){document.documentElement.removeEventListener("click",c),l=!1,d.classList.remove("expanded");var t=o;let n=document.elementFromPoint(e.clientX,e.clientY);for(;!n.hasAttribute("data-option-index")&&"HTML"!==n.tagName;)n=n.parentNode;o=parseInt(n.getAttribute("data-option-index")??o)||o,selectElement.value=a[o].value,t!==o&&selectElement.dispatchEvent(new Event("input"));t=p.slice(0,o).map(element=>element.getBoundingClientRect().height/s);let i=0;t.forEach(height=>i-=height),i-=10,await Promise.all([anime({targets:[d,d.parentNode.parentNode],height:p[o].getBoundingClientRect().height/s+4,width:p[o].getBoundingClientRect().width/s+16,translateY:0,scale:1,easing:"easeOutQuad",duration:opacityAnimationTime}).finished,anime({targets:m,translateY:i,easing:"easeOutQuad",duration:opacityAnimationTime}).finished])}selectElement.querySelectorAll("option").forEach((option,index)=>{var e=document.createElement("div");e.textContent=option.textContent,e.setAttribute("data-option-index",index),p.push(e),m.appendChild(e),a.push(option)}),setTimeout(()=>{p.slice(1).forEach(element=>{addHoverEvent(element)}),p[0].innerHTML+=' <span style="font-size: 12px; margin-right: -2px">&#x25BC;</span>',d.style.height=1.075*p[o].getBoundingClientRect().height+"px",d.style.width=p[o].getBoundingClientRect().width+16+"px",d.parentNode.parentNode.style.height=1.075*p[o].getBoundingClientRect().height+"px",d.parentNode.parentNode.style.width=p[o].getBoundingClientRect().width+16+"px",m.style.transform="translateY(-10px)"},16),d.addEventListener("click",()=>{l||!async function(){l=!0,d.classList.add("expanded");let e=0;p.forEach(element=>{e=Math.max(e,element.getBoundingClientRect().width)});var t=m.getBoundingClientRect().height+4,n=headerElement.getBoundingClientRect().height,i=window.innerHeight-n-20,i=t*(s=Math.min(i/t,1)),o=(a=d.getBoundingClientRect()).top+a.height/2-i/2,a=a.bottom-a.height/2+i/2;let r=0;a>window.innerHeight-10?r=window.innerHeight-10-a:o<10+n&&(r=10+n-o),await Promise.all([anime({targets:d,height:t,width:e+29.75-14,translateY:r,scale:s,easing:"easeOutQuad",duration:opacityAnimationTime}).finished,anime({targets:m,translateY:0,easing:"easeOutQuad",duration:opacityAnimationTime}).finished]),document.documentElement.addEventListener("click",c)}()})}function setUpDropdowns(){$$("select").forEach(element=>setUpDropdown(element))}export{setUpTextButtons,equalizeTextButtons,setUpNavButtons,setUpDropdowns};