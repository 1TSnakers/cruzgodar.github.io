import{setBannerMaxScroll}from"./banners.min.js";import{currentCard,resizeCard}from"./cards.min.js";import{headerElement}from"./header.min.js";import{$,$$}from"./main.min.js";const pageWidth=1150;let aspectRatio=window.innerWidth/window.innerHeight,navigationAnimationDistanceVertical=Math.min(window.innerHeight/20,25),navigationAnimationDistanceHorizontal=Math.min(window.innerWidth/20,25),appletColumnsAreEqualized=!1;const heightMeasurerElement=document.body.querySelector("#height-measurer");let viewportHeight=heightMeasurerElement?100*heightMeasurerElement.getBoundingClientRect().height:window.innerHeight;const likelyWindowChromeHeight=viewportHeight-window.innerHeight;function onResize(){viewportHeight=heightMeasurerElement?100*heightMeasurerElement.getBoundingClientRect().height-likelyWindowChromeHeight:window.innerHeight,setBannerMaxScroll(Math.min(viewportHeight-40-(headerElement?headerElement.offsetHeight:0),document.body.offsetHeight-window.innerHeight)),navigationAnimationDistanceVertical=Math.min(window.innerHeight/20,25),navigationAnimationDistanceHorizontal=Math.min(window.innerWidth/20,25),1<(aspectRatio=window.innerWidth/window.innerHeight)&&!appletColumnsAreEqualized?equalizeAppletColumns():aspectRatio<=1&&appletColumnsAreEqualized&&destroyAppletColumns(),resizeCard();var e,t,i,n=headerElement?.children[0]?.children[0];n&&(n.style.width=n.getBoundingClientRect().height+"px"),updateImageLinks(),requestAnimationFrame(updateImageLinks),currentCard&&(n=currentCard.querySelector("img.gallery-card-image"))&&(e=currentCard.getBoundingClientRect().height,t=n.getBoundingClientRect().height,i=window.innerWidth<=500?8:16,n.style.maxHeight=`calc(100vh - ${e-t+2*i}px)`)}function initOnResize(){window.addEventListener("resize",onResize)}function updateImageLinks(){var e=$$(".image-links");for(let r=0;r<e.length;r++){var t=e[r],i=t.children[0].getBoundingClientRect(),n=t.children[t.children.length-1].getBoundingClientRect();i.top===n.top?(n=$("main").clientWidth-(n.right-i.left),t.style.marginLeft=n/2+"px",t.style.marginRight=`-${n/2}px`):(t.style.removeProperty("margin-left"),t.style.removeProperty("margin-right"))}}function equalizeAppletColumns(){if(!(aspectRatio<1||window.innerWidth<750)){var a=$("#canvas-landscape-left"),l=$("#canvas-landscape-right");if(a&&l){var o=[],h=a.children.length,d=l.children.length;for(let e=0;e<h;e++)o.push(a.children[e]);for(let n=0;n<d;n++)o.push(l.children[n]);var s=[o[0].clientHeight];for(let r=1;r<o.length;r++)s.push(s[r-1]+o[r].clientHeight);let t=1/0,i=0;if(1<o.length)for(let e=0;e<o.length;e++){var g=Math.abs(s[e]-(s[s.length-1]-s[e]));g<t&&(t=g,i=e+1)}if(i<h){var c=[];for(let e=i;e<h;e++)a.children[e].classList.add("moved-to-right"),c.push(a.children[e]);for(let t=c.length-1;0<=t;t--)l.insertBefore(c[t],l.firstElementChild)}else{var m=[];for(let e=0;e<i-h;e++)l.children[e].classList.add("moved-to-left"),m.push(l.children[e]);for(let t=0;t<m.length;t++)a.appendChild(m[t])}appletColumnsAreEqualized=!0}}}function destroyAppletColumns(){var n=$("#canvas-landscape-left"),r=$("#canvas-landscape-right");if(n&&r){let e=$$(".moved-to-left");for(let t=e.length-1;0<=t;t--)r.insertBefore(e[t],r.firstElementChild),e[t].classList.remove("moved-to-left");e=$$(".moved-to-right");for(let i=0;i<e.length;i++)n.appendChild(e[i]),e[i].classList.remove("moved-to-right");appletColumnsAreEqualized=!1}}export{pageWidth,aspectRatio,navigationAnimationDistanceVertical,navigationAnimationDistanceHorizontal,viewportHeight,likelyWindowChromeHeight,onResize,initOnResize,equalizeAppletColumns};