import{fadeDownIn,fadeIn,fadeLeftIn,fadeRightIn,fadeUpIn,pageAnimationTime}from"./animation.min.mjs";import{bannerElement,bannerOpacity,setUpBanner}from"./banners.min.mjs";import{setUpDropdowns,setUpNavButtons,setUpTextButtons}from"./buttons.min.mjs";import{setUpCards}from"./cards.min.mjs";import{setUpFocusEvents,setUpHoverEvents}from"./hover-events.min.mjs";import{equalizeAppletColumns,onResize}from"./layout.min.mjs";import{$$,pageElement,pageUrl,updatePageElement}from"./main.min.mjs";import{typesetMath}from"./math.min.mjs";import{navigationTransitionType,redirect,setCurrentlyRedirecting}from"./navigation.min.mjs";import{condenseApplet,revertTheme,siteSettings}from"./settings.min.mjs";import{sitemap}from"./sitemap.min.mjs";async function loadPage(){window.dispatchEvent(new Event("scroll")),updatePageElement();var titleElement=document.head.querySelector("title");titleElement&&(titleElement.textContent=sitemap[pageUrl].title),setUpBanner(),loadCustomStyle(),loadCustomScripts(),equalizeAppletColumns(),setLinks(),disableLinks(),setUpHoverEvents(),setUpTextButtons(),setUpNavButtons(),setUpDropdowns(),typesetMath(),setUpCards(),onResize(),revertTheme(),siteSettings.condensedApplets&&"/applets/"===sitemap[pageUrl].parent&&condenseApplet(),setTimeout(setUpFocusEvents,50),setTimeout(equalizeAppletColumns,100)}async function showPage(){await new Promise(resolve=>setTimeout(resolve,10)),await fadeInPage(),setCurrentlyRedirecting(!1)}function loadCustomStyle(){fetch(pageUrl+"style/index."+(window.DEBUG?"css":"min.css")).then(response=>response.text()).then(text=>{var element=document.createElement("style");element.textContent=text,element.classList.add("temporary-style"),document.head.insertBefore(element,document.head.firstChild)})}function loadCustomScripts(){import(pageUrl+"scripts/index."+(window.DEBUG?"mjs":"min.mjs")).then(Module=>Module.load()).catch(()=>window.requestAnimationFrame(showPage))}async function fadeInPage(){fadeIn(document.querySelector("#header")),await((document.querySelector("#header-container").style.opacity=1)===navigationTransitionType?bannerElement?Promise.all([fadeUpIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeUpIn(pageElement)]):fadeUpIn(pageElement):-1===navigationTransitionType?bannerElement?Promise.all([fadeDownIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeDownIn(pageElement)]):fadeDownIn(pageElement):2===navigationTransitionType?bannerElement?Promise.all([fadeLeftIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeLeftIn(pageElement)]):fadeLeftIn(pageElement):-2===navigationTransitionType?bannerElement?Promise.all([fadeRightIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeRightIn(pageElement)]):fadeRightIn(pageElement):bannerElement?Promise.all([fadeIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeIn(pageElement)]):fadeIn(pageElement))}function setLinks(){$$("a").forEach(link=>{const href=link.getAttribute("href");if(null!==href){const inNewTab=!("https"!==href.slice(0,5)&&"data"!==href.slice(0,4)&&1!=link.getAttribute("data-in-new-tab"));link.addEventListener("click",()=>redirect({url:href,inNewTab:inNewTab}))}})}function disableLinks(){$$("a:not(.real-link)").forEach(link=>link.addEventListener("click",e=>e.preventDefault()))}export{loadPage,showPage,disableLinks};