import{fadeDownIn,fadeIn,fadeLeftIn,fadeRightIn,fadeUpIn,pageAnimationTime}from"./animation.min.mjs";import{bannerElement,bannerOpacity,setUpBanner}from"./banners.min.mjs";import{setUpDropdowns,setUpNavButtons,setUpTextButtons}from"./buttons.min.mjs";import{setUpCards}from"./cards.min.mjs";import{setUpFocusEvents,setUpHoverEvents}from"./hover-events.min.mjs";import{equalizeAppletColumns,onResize}from"./layout.min.mjs";import{$$,pageElement,pageUrl,updatePageElement}from"./main.min.mjs";import{typesetMath}from"./math.min.mjs";import{navigationTransitionType,redirect,setCurrentlyRedirecting}from"./navigation.min.mjs";import{condenseApplet,revertTheme,siteSettings}from"./settings.min.mjs";import{sitemap}from"./sitemap.min.mjs";async function loadPage(){window.dispatchEvent(new Event("scroll")),updatePageElement();try{document.head.querySelector("title").textContent=sitemap[pageUrl].title}catch(e){}setUpBanner(),loadCustomStyle(),loadCustomScripts(),equalizeAppletColumns(),setLinks(),disableLinks(),setUpHoverEvents(),setUpTextButtons(),setUpNavButtons(),setUpDropdowns(),typesetMath(),setUpCards(),onResize(),revertTheme(),siteSettings.condensedApplets&&"/applets/"===sitemap[pageUrl].parent&&condenseApplet(),setTimeout(()=>setUpFocusEvents(),50)}async function showPage(){await new Promise((e,t)=>setTimeout(e,10)),await fadeInPage(),setCurrentlyRedirecting(!1)}function loadCustomStyle(){fetch(pageUrl+"style/index."+(window.DEBUG?"css":"min.css")).then(e=>e.text()).then(e=>{var t=document.createElement("style");t.textContent=e,t.classList.add("temporary-style"),document.head.insertBefore(t,document.head.firstChild)}).catch(e=>{})}function loadCustomScripts(){import(pageUrl+"scripts/index."+(window.DEBUG?"mjs":"min.mjs")).then(e=>e.load()).catch(()=>{setTimeout(()=>showPage(),1)})}async function fadeInPage(){fadeIn(document.querySelector("#header")),await((document.querySelector("#header-container").style.opacity=1)===navigationTransitionType?bannerElement?Promise.all([fadeUpIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeUpIn(pageElement)]):fadeUpIn(pageElement):-1===navigationTransitionType?bannerElement?Promise.all([fadeDownIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeDownIn(pageElement)]):fadeDownIn(pageElement):2===navigationTransitionType?bannerElement?Promise.all([fadeLeftIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeLeftIn(pageElement)]):fadeLeftIn(pageElement):-2===navigationTransitionType?bannerElement?Promise.all([fadeRightIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeRightIn(pageElement)]):fadeRightIn(pageElement):bannerElement?Promise.all([fadeIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeIn(pageElement)]):fadeIn(pageElement))}function setLinks(){$$("a").forEach(e=>{const t=e.getAttribute("href");if(null!==t){const n=!("https"!==t.slice(0,5)&&"data"!==t.slice(0,4)&&1!=e.getAttribute("data-in-new-tab"));e.addEventListener("click",()=>redirect({url:t,inNewTab:n}))}})}function disableLinks(){$$("a:not(.real-link)").forEach(e=>e.addEventListener("click",e=>e.preventDefault()))}export{loadPage,showPage,disableLinks};