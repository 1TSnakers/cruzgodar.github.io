import{fadeDownIn,fadeIn,fadeLeftIn,fadeRightIn,fadeUpIn,opacityAnimationTime,pageAnimationTime}from"./animation.min.mjs";import{bannerElement,bannerOpacity,setUpBanner}from"./banners.min.mjs";import{setUpDropdowns,setUpNavButtons,setUpTextButtons}from"./buttons.min.mjs";import{setUpCards}from"./cards.min.mjs";import{setUpCarousels}from"./carousels.min.mjs";import{setUpFocusEvents,setUpHoverEvents}from"./hover-events.min.mjs";import{equalizeAppletColumns,onResize}from"./layout.min.mjs";import{$$,pageElement,pageUrl,updatePageElement}from"./main.min.mjs";import{typesetMath}from"./math.min.mjs";import{navigationTransitionType,redirect,setCurrentlyRedirecting}from"./navigation.min.mjs";import{condenseApplet,revertTheme,siteSettings}from"./settings.min.mjs";import{sitemap}from"./sitemap.min.mjs";async function loadPage(){window.dispatchEvent(new Event("scroll")),updatePageElement();var e=document.head.querySelector("title");e&&(e.textContent=sitemap[pageUrl].title),setUpBanner(),loadCustomStyle(),loadCustomScripts(),equalizeAppletColumns(),setLinks(),disableLinks(),setUpHoverEvents(),setUpTextButtons(),setUpNavButtons(),setUpDropdowns(),setUpCarousels(),typesetMath(),setUpCards(),onResize(),revertTheme(),siteSettings.condensedApplets&&"/applets/"===sitemap[pageUrl].parent&&condenseApplet(),setTimeout(setUpFocusEvents,50),setTimeout(equalizeAppletColumns,100)}async function showPage(){await new Promise(resolve=>setTimeout(resolve,10)),await fadeInPage(),setCurrentlyRedirecting(!1)}function loadCustomStyle(){sitemap[pageUrl].customStyle&&fetch(pageUrl+"style/index."+(window.DEBUG?"css":"min.css")).then(response=>response.text()).then(text=>{var e=document.createElement("style");e.textContent=text,e.classList.add("temporary-style"),document.head.insertBefore(e,document.head.firstChild)})}function loadCustomScripts(){sitemap[pageUrl].customScript?import(pageUrl+"scripts/index."+(window.DEBUG?"mjs":"min.mjs")).then(Module=>Module.load()):window.requestAnimationFrame(showPage)}async function fadeInPage(){fadeIn(document.querySelector("#header")),document.querySelector("#header-container").style.opacity=1,opacityAnimationTime?await(1===navigationTransitionType?bannerElement?Promise.all([fadeUpIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeUpIn(pageElement)]):fadeUpIn(pageElement):-1===navigationTransitionType?bannerElement?Promise.all([fadeDownIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeDownIn(pageElement)]):fadeDownIn(pageElement):2===navigationTransitionType?bannerElement?Promise.all([fadeLeftIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeLeftIn(pageElement)]):fadeLeftIn(pageElement):-2===navigationTransitionType?bannerElement?Promise.all([fadeRightIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeRightIn(pageElement)]):fadeRightIn(pageElement):bannerElement?Promise.all([fadeIn(bannerElement,2*pageAnimationTime,bannerOpacity),fadeIn(pageElement)]):fadeIn(pageElement)):(pageElement.style.opacity=1,bannerElement&&(bannerElement.style.opacity=1))}function setLinks(){$$("a").forEach(link=>{const e=link.getAttribute("href");if(null!==e){const t=!("https"!==e.slice(0,5)&&"data"!==e.slice(0,4)&&1!=link.getAttribute("data-in-new-tab"));link.addEventListener("click",()=>redirect({url:e,inNewTab:t}))}})}function disableLinks(){$$("a:not(.real-link)").forEach(link=>{link.addEventListener("click",e=>e.preventDefault())})}export{loadPage,showPage,disableLinks};