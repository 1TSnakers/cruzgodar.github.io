import{fadeDownIn,fadeIn,fadeLeftIn,fadeRightIn,fadeUpIn,opacityAnimationTime}from"./animation.min.js";import{bannerElement,bannerOpacity,setUpBanner}from"./banners.min.js";import{equalizeTextButtons,setUpNavButtons,setUpTextButtons}from"./buttons.min.js";import{setUpCards}from"./cards.min.js";import{setUpCarousels}from"./carousels.min.js";import{setUpFocusEvents,setUpHoverEvents}from"./hoverEvents.min.js";import{equalizeAppletColumns,onResize}from"./layout.min.js";import{$$,pageElement,pageUrl,updatePageElement}from"./main.min.js";import{typesetMath}from"./math.min.js";import{navigationTransitionType,redirect,setCurrentlyRedirecting}from"./navigation.min.js";import{setUpPageContents}from"./pageContent.min.js";import{condenseApplet,revertTheme,siteSettings}from"./settings.min.js";import{sitemap}from"./sitemap.min.js";async function loadPage(){window.dispatchEvent(new Event("scroll")),updatePageElement();var e=document.head.querySelector("title");e&&(e.textContent=sitemap[pageUrl].title),setUpBanner(),loadCustomStyle(),loadCustomScripts(),equalizeAppletColumns(),setLinks(),disableLinks(),setUpHoverEvents(),setUpTextButtons(),setUpNavButtons(),equalizeTextButtons(),setUpPageContents(),setUpCarousels(),typesetMath(),setUpCards(),onResize(),revertTheme(),siteSettings.condensedApplets&&"/applets/"===sitemap[pageUrl].parent&&condenseApplet(),setTimeout(setUpFocusEvents,50),setTimeout(equalizeAppletColumns,100)}async function showPage(){await new Promise(resolve=>setTimeout(resolve,10)),await fadeInPage(),setCurrentlyRedirecting(!1)}function loadCustomStyle(){sitemap[pageUrl].customStyle&&fetch(pageUrl+"style/index."+(window.DEBUG?"css":"min.css")).then(response=>response.text()).then(text=>{var e=document.createElement("style");e.textContent=text,e.classList.add("temporary-style"),document.head.insertBefore(e,document.head.firstChild)})}function loadCustomScripts(){sitemap[pageUrl].customScript?import(pageUrl+"scripts/index."+(window.DEBUG?"js":"min.js")).then(Module=>Module.load()):window.requestAnimationFrame(showPage)}async function fadeInPage(){fadeIn({element:document.querySelector("#header")}),document.querySelector("#header-container").style.opacity=1,opacityAnimationTime?await(1===navigationTransitionType?bannerElement?Promise.all([fadeUpIn({element:bannerElement,opacity:bannerOpacity}),fadeUpIn({element:pageElement})]):fadeUpIn({element:pageElement}):-1===navigationTransitionType?bannerElement?Promise.all([fadeDownIn({element:bannerElement,opacity:bannerOpacity}),fadeDownIn({element:pageElement})]):fadeDownIn({element:pageElement}):2===navigationTransitionType?bannerElement?Promise.all([fadeLeftIn({element:bannerElement,opacity:bannerOpacity}),fadeLeftIn({element:pageElement})]):fadeLeftIn({element:pageElement}):-2===navigationTransitionType?bannerElement?Promise.all([fadeRightIn({element:bannerElement,opacity:bannerOpacity}),fadeRightIn({element:pageElement})]):fadeRightIn({element:pageElement}):bannerElement?Promise.all([fadeIn({element:bannerElement,opacity:bannerOpacity}),fadeIn({element:pageElement})]):fadeIn({element:pageElement})):(pageElement.style.opacity=1,bannerElement&&(bannerElement.style.opacity=1))}function setLinks(){$$("a").forEach(link=>{const e=link.getAttribute("href");if(e){const t=!("https"!==e.slice(0,5)&&"data"!==e.slice(0,4)&&1!=link.getAttribute("data-in-new-tab"));link.addEventListener("click",()=>redirect({url:e,inNewTab:t}))}})}function disableLinks(){$$("a:not(.real-link)").forEach(link=>{link.addEventListener("click",e=>e.preventDefault())})}export{loadPage,showPage,disableLinks};