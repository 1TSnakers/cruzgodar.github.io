import{addHoverEvent}from"./hover-events.min.mjs";import{$$,addTemporaryListener,pageElement}from"./main.min.mjs";import{metaThemeColorElement,siteSettings}from"./settings.min.mjs";import anime from"/scripts/anime.js";let cardIsOpen=!1;const container=document.querySelector("#card-container");let currentCard;const closeButton=document.querySelector("#card-close-button");closeButton&&(addHoverEvent(closeButton),closeButton.addEventListener("click",hideCard),document.documentElement.addEventListener("keydown",e=>{"Escape"===e.key&&cardIsOpen&&hideCard()}));let scrollBeforeCard=0;const animationTime=500;function setUpCards(){$$("[data-card-id]").forEach(e=>{e.addEventListener("click",()=>showCard(e,e.getAttribute("data-card-id")))})}async function showCard(e,t){console.log(e),scrollBeforeCard=window.scrollY,addTemporaryListener({object:window,event:"scroll",callback:()=>{cardIsOpen&&window.scrollTo(0,scrollBeforeCard)}}),cardIsOpen=!0,container.style.display="flex",container.style.opacity=0,container.style.transform="scale(1)",container.style.display="flex",currentCard=document.querySelector(`#${t}-card`),container.appendChild(currentCard),currentCard.insertBefore(closeButton,currentCard.firstElementChild),container.scroll(0,0);currentCard.getBoundingClientRect().height>window.innerHeight-32?container.style.justifyContent="flex-start":container.style.justifyContent="center",container.style.transform="scale(.95)",pageElement.style.filter="brightness(1)",document.querySelector("#header").style.filter="brightness(1)",document.querySelector("#header-container").style.filter="brightness(1)",pageElement.style.transformOrigin=`50% calc(50vh + ${window.scrollY}px)`,document.documentElement.addEventListener("click",handleClickEvent);e=siteSettings.darkTheme?"rgb(12, 12, 12)":"rgb(127, 127, 127)",t=siteSettings.darkTheme?"#0c0c0c":"#7f7f7f";document.documentElement.style.backgroundColor=siteSettings.darkTheme?"rgb(24, 24, 24)":"rgb(255, 255, 255)",await Promise.all([anime({targets:container,opacity:1,scale:1,duration:animationTime,easing:"easeOutQuint"}).finished,anime({targets:[pageElement,document.querySelector("#header"),document.querySelector("#header-container")],filter:"brightness(.5)",scale:.975,duration:animationTime,easing:"easeOutQuint"}).finished,anime({targets:metaThemeColorElement,content:t,duration:animationTime,easing:"easeOutQuint"}).finished,anime({targets:document.documentElement,backgroundColor:e,duration:animationTime,easing:"easeOutQuint"}).finished])}async function hideCard(){cardIsOpen=!1,window.scrollTo(0,scrollBeforeCard);var e=siteSettings.darkTheme?"rgb(24, 24, 24)":"rgb(255, 255, 255)",t=siteSettings.darkTheme?"#181818":"#ffffff";await Promise.all([anime({targets:[pageElement,document.querySelector("#header"),document.querySelector("#header-container")],filter:"brightness(1)",scale:1,duration:animationTime,easing:"easeOutQuint"}).finished,anime({targets:metaThemeColorElement,content:t,duration:animationTime,easing:"easeOutQuint"}).finished,anime({targets:document.documentElement,backgroundColor:e,duration:animationTime,easing:"easeOutQuint"}).finished,anime({targets:container,opacity:0,scale:.95,duration:animationTime,easing:"easeOutQuint"}).finished]),document.documentElement.style.backgroundColor="var(--background)",container.style.display="none",pageElement.appendChild(currentCard),container.appendChild(closeButton),document.documentElement.removeEventListener("click",handleClickEvent)}function handleClickEvent(e){"card-container"===e.target.id&&hideCard()}function resizeCard(){cardIsOpen&&(currentCard.getBoundingClientRect().height>window.innerHeight-32?container.style.justifyContent="flex-start":container.style.justifyContent="center")}export{cardIsOpen,scrollBeforeCard,setUpCards,showCard,hideCard,resizeCard};