import{addHoverEvent}from"./hover-events.mjs";const container=document.querySelector("#card-container"),closeButton=document.querySelector("#card-close-button");addHoverEvent(closeButton);let currentCard=null,cardIsOpen=(closeButton.addEventListener("click",hideCard),document.documentElement.addEventListener("keydown",e=>{27===e.keyCode&&cardIsOpen&&hideCard()}),!1);const animationTime=500;function setUpCards(){$$("[data-card-id]").forEach(e=>{e.addEventListener("click",()=>showCard(e.getAttribute("data-card-id")))})}async function showCard(e){cardIsOpen=!0,container.style.display="flex",container.style.opacity=0,container.style.transform="scale(1)",container.style.display="flex",currentCard=document.querySelector(`#${e}-card`),container.appendChild(currentCard),currentCard.insertBefore(closeButton,currentCard.firstElementChild),container.scroll(0,0),currentCard.getBoundingClientRect().height>window.innerHeight-32?container.style.justifyContent="flex-start":container.style.justifyContent="center",container.style.transform="scale(.95)",Page.element.style.filter="brightness(1)",document.querySelector("#header").style.filter="brightness(1)",document.querySelector("#header-container").style.filter="brightness(1)",Page.element.style.transformOrigin=`50% calc(50vh + ${window.scrollY}px)`,document.documentElement.addEventListener("click",handleClickEvent);const n=1===Site.Settings.urlVars.theme?"rgb(12, 12, 12)":"rgb(127, 127, 127)",r=1===Site.Settings.urlVars.theme?"#0c0c0c":"#7f7f7f";await Promise.all([new Promise((e,t)=>{anime({targets:container,opacity:1,scale:1,duration:animationTime,easing:"easeOutQuint",complete:e})}),new Promise((e,t)=>{anime({targets:Page.element,duration:animationTime,easing:"easeOutQuint",complete:e})}),new Promise((e,t)=>{anime({targets:[Page.element,document.querySelector("#header"),document.querySelector("#header-container")],filter:"brightness(.5)",scale:.975,duration:animationTime,easing:"easeOutQuint",complete:e})}),new Promise((e,t)=>{anime({targets:Site.Settings.metaThemeColorElement,content:r,duration:animationTime,easing:"easeOutQuint",complete:e})}),new Promise((e,t)=>{anime({targets:document.documentElement,backgroundColor:n,duration:animationTime,easing:"easeOutQuint",complete:e})})])}async function hideCard(){cardIsOpen=!1;const n=1===Site.Settings.urlVars.theme?"rgb(24, 24, 24)":"rgb(255, 255, 255)",r=1===Site.Settings.urlVars.theme?"#181818":"#ffffff";await Promise.all([new Promise((e,t)=>{anime({targets:[Page.element,document.querySelector("#header"),document.querySelector("#header-container")],filter:"brightness(1)",scale:1,duration:animationTime,easing:"easeOutQuint",complete:e})}),new Promise((e,t)=>{anime({targets:Site.Settings.metaThemeColorElement,content:r,duration:animationTime,easing:"easeOutQuint",complete:e})}),new Promise((e,t)=>{anime({targets:document.documentElement,backgroundColor:n,duration:animationTime,easing:"easeOutQuint",complete:e})}),new Promise((e,t)=>{anime({targets:container,opacity:0,scale:.95,duration:animationTime,easing:"easeOutQuint",complete:e})})]),container.style.display="none",Page.element.appendChild(currentCard),container.appendChild(closeButton),document.documentElement.removeEventListener("click",handleClickEvent)}function handleClickEvent(e){"card-container"===e.target.id&&hideCard()}function resizeCard(){cardIsOpen&&(currentCard.getBoundingClientRect().height>window.innerHeight-32?container.style.justifyContent="flex-start":container.style.justifyContent="center")}export{cardIsOpen,setUpCards,showCard,hideCard,resizeCard};