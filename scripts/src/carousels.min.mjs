import anime from"../anime.min.js";import{carouselFillAnimationTime,carouselSwitchAnimationTime}from"./animation.min.mjs";import{$$}from"./main.min.mjs";const dotSize=8,expandedDotWidth=128;class Carousel{element;children;dots;activeChild=-1;currentFillAnimation;constructor(element){this.element=element,this.children=element.firstElementChild.children,this.dots=element.lastElementChild.children,this.advance()}async advance(newActiveNode=(this.activeChild+1)%this.children.length,lastActiveNode=newActiveNode){this.currentFillAnimation&&this.currentFillAnimation.pause(),this.children[(this.activeChild+1)%this.children.length].style.display="block",await new Promise(resolve=>setTimeout(resolve,10));var i=-1!==this.activeChild?this.dots[this.activeChild]:void 0,e=i?[anime({targets:i,width:8,duration:carouselSwitchAnimationTime,easing:"easeInOutQuad"}).finished,anime({targets:i.firstElementChild,opacity:0,duration:carouselSwitchAnimationTime,easing:"easeInOutQuad"}).finished]:[],t=(this.activeChild=(this.activeChild+1)%this.children.length,this.dots[this.activeChild]),n=[anime({targets:t,width:expandedDotWidth,duration:carouselSwitchAnimationTime,easing:"easeInOutQuad"}).finished,anime({targets:t.firstElementChild,opacity:1,duration:carouselSwitchAnimationTime,easing:"easeInOutQuad"}).finished,anime({targets:this.children[this.activeChild],opacity:1,duration:carouselSwitchAnimationTime,easing:"easeInOutQuad"}).finished];await Promise.all(e.concat(n)),i&&(i.firstElementChild.style.width=dotSize+1+"px"),this.currentFillAnimation=anime({targets:t.firstElementChild,width:expandedDotWidth+1,duration:carouselFillAnimationTime,easing:"linear",endDelay:carouselSwitchAnimationTime}),await this.currentFillAnimation.finished,await anime({targets:this.children[this.activeChild],opacity:0,duration:carouselSwitchAnimationTime,easing:"easeInQuad"}).finished,this.children[this.activeChild].style.display="none",this.advance()}}function setUpCarousels(){$$(".carousel").forEach(element=>{new Carousel(element)})}export{setUpCarousels};