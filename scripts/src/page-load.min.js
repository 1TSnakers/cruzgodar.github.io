Page.load=async function(){Page.element=document.body.querySelector(".page");$=a=>Page.element.querySelector(a);$$=a=>Page.element.querySelectorAll(a);Page.Banner.bannerPages.includes(Page.url)?(Page.bannerElement=$("#banner"),Page.contentElement=$("#content"),Site.addStyle(`
			#banner-small
			{
				background: url(${Page.Banner.filePath}small.${Page.Images.fileExtension}) no-repeat center center;
				background-size: cover;
			}
			
			#banner-large
			{
				background: url(${Page.Banner.filePath}large.${Page.Images.fileExtension}) no-repeat center center;
				background-size: cover;
			}
		`),Page.Banner.load(!0).then(()=>{Page.Animate.changeOpacity($("#banner-small"),0,700).then(()=>$("#banner-small").remove())})):Page.bannerElement=null;Page.usingCustomScript=!0;Page.readyToShow=!1;this.Navigation.currentlyChangingPage=!1;this.Load.parseCustomStyle();await this.Load.parseCustomScripts();try{"/home/"===Page.url?document.head.querySelector("title").textContent="Cruz Godar":document.head.querySelector("title").textContent=$("h1").textContent}catch(a){}Page.Layout.Multicols.active=
!1;Page.Layout.onResize();"ultrawide"===this.Layout.layoutString&&this.Layout.Multicols.create();this.Layout.AppletColumns.areEqualized=!1;1<this.Layout.aspectRatio&&this.Layout.AppletColumns.equalize();$$("select").forEach(a=>{const b=a.previousElementSibling;b.innerHTML=`${a.querySelector(`[value=${a.value}]`).textContent}  <span style="font-size: 12px">&#x25BC;</span>`;b.parentNode.parentNode.style.gridTemplateColumns="repeat(auto-fit, 100%)";a.addEventListener("input",()=>{b.innerHTML=`${a.querySelector(`[value=${a.value}]`).textContent}  <span style="font-size: 12px">&#x25BC;</span>`})});
this.Images.addExtensions();this.Load.Links.set();this.Load.Links.disable();this.Load.HoverEvents.setUp();this.Load.TextButtons.setUp();this.Load.showImages();try{this.Load.TextButtons.setUpNavButtons()}catch(a){}setTimeout(()=>{this.Load.FocusEvents.setUpWeirdElements()},50);Page.backgroundColorChanged=!1;Site.Settings.handleThemeRevert();1===Site.Settings.urlVars.condensedApplets&&"/applets/"===Site.sitemap[Page.url].parent&&Site.Settings.condenseApplet();this.Load.Math.typeset();Page.usingCustomScript||
setTimeout(()=>Page.show(),1)};Page.show=function(){return new Promise((a,b)=>{setTimeout(async()=>{await this.Load.fadeIn();a()},10)})};
Page.Load={parseScriptTags:function(){document.querySelectorAll("script").forEach(a=>{const b=document.createElement("script");b.innerHTML=a.textContent;document.body.appendChild(b);a.remove()})},parseCustomStyle:function(){Page.url.split("/");try{fetch(Page.parentFolder+"style/index.css").then(a=>{a=document.createElement("link");a.setAttribute("rel","stylesheet");DEBUG?a.setAttribute("href",Page.parentFolder+"style/index.css"):a.setAttribute("href",Page.parentFolder+"style/index.min.css");a.classList.add("temporary-style");
document.head.insertBefore(a,document.head.firstChild)})}catch(a){}},parseCustomScripts:function(){return new Promise((a,b)=>{Page.url.split("/");fetch(Page.parentFolder+"scripts/index.js").then(c=>{c.ok?(Page.readyToShow=!0,c=document.createElement("script"),DEBUG?c.setAttribute("src",Page.parentFolder+"scripts/index.js"):c.setAttribute("src",Page.parentFolder+"scripts/index.min.js"),c.classList.add("temporary-script"),document.body.appendChild(c)):Page.readyToShow?Page.show():Page.usingCustomScript=
!1;a()})})},addHeader:function(){document.body.firstChild.insertAdjacentHTML("beforebegin",`
			<div id="header-container"></div>
			
			<div id="header">
				<a id="header-logo" href="/home/">
					<img src="/graphics/header-icons/logo.webp"></img>
					<span>Cruz Godar</span>
				</a>
				
				<div id="header-links">
					<a id="header-gallery-link" href="/gallery/">
						<span>Gallery</span>
						<img src="/graphics/header-icons/gallery.webp"></img>
					</a>
					
					<a id="header-applets-link" href="/applets/">
						<span>Applets</span>
						<img src="/graphics/header-icons/applets.webp"></img>
					</a>
					
					<a id="header-teaching-link" href="/teaching/">
						<span>Teaching</span>
						<img src="/graphics/header-icons/teaching.webp"></img>
					</a>
					
					<a id="header-slides-link" href="/slides/">
						<span>Slides</span>
						<img src="/graphics/header-icons/slides.webp"></img>
					</a>
					
					<a id="header-writing-link" href="/writing/">
						<span>Writing</span>
						<img src="/graphics/header-icons/writing.webp"></img>
					</a>
					
					<a id="header-about-link" href="/about/">
						<span>About</span>
						<img src="/graphics/header-icons/about.webp"></img>
					</a>
				</div>
				
				<div id="header-theme-button" class="${1===Site.Settings.urlVars.theme?"active":""}">
					<input type="image" src="/graphics/header-icons/moon.webp">
				</div>
			</div>
		`);setTimeout(()=>{var a=document.body.querySelector("#header-logo img");a.style.width=`${a.getBoundingClientRect().height}px`;document.body.querySelectorAll("#header-logo, #header-links a").forEach(b=>{Page.Load.HoverEvents.add(b);const c=b.getAttribute("href");b.setAttribute("href","/index.html?page="+encodeURIComponent(c));b.addEventListener("click",d=>{d.preventDefault();Page.Navigation.redirect(c)})});a=document.body.querySelector("#header-theme-button");Page.Load.HoverEvents.add(a);a.addEventListener("click",
()=>Site.Settings.toggleTheme());Site.headerElement=document.body.querySelector("#header")})},fadeIn:function(){return new Promise(async(a,b)=>{1===Page.Navigation.transitionType?(b=Page.Animate.fadeUpIn(Page.element,2*Site.pageAnimationTime),null!==Page.bannerElement&&(b=Page.Animate.fadeUpIn(Page.bannerElement,2*Site.pageAnimationTime,Page.Banner.opacity))):-1===Page.Navigation.transitionType?(b=Page.Animate.fadeDownIn(Page.element,2*Site.pageAnimationTime),null!==Page.bannerElement&&(b=Page.Animate.fadeDownIn(Page.bannerElement,
2*Site.pageAnimationTime,Page.Banner.opacity))):2===Page.Navigation.transitionType?(b=Page.Animate.fadeLeftIn(Page.element,2*Site.pageAnimationTime),null!==Page.bannerElement&&(b=Page.Animate.fadeLeftIn(Page.bannerElement,2*Site.pageAnimationTime,Page.Banner.opacity))):-2===Page.Navigation.transitionType?(b=Page.Animate.fadeRightIn(Page.element,2*Site.pageAnimationTime),null!==Page.bannerElement&&(b=Page.Animate.fadeRightIn(Page.bannerElement,2*Site.pageAnimationTime,Page.Banner.opacity))):(b=Page.Animate.fadeIn(Page.element,
2*Site.pageAnimationTime),null!==Page.bannerElement&&(b=Page.Animate.fadeIn(Page.bannerElement,2*Site.pageAnimationTime,Page.Banner.opacity)));await b;a()})},lazyLoadedImages:[],showImages:function(){$$("img[data-src]").forEach(a=>this.lazyLoadedImages.push([a,a.getBoundingClientRect().top,null]));this.lazyLoadedImages.forEach((a,b)=>{a[1]>window.innerHeight+200?a[2]=setTimeout(()=>this.loadLazyElement(this.lazyLoadedImages,b),200*b):this.loadLazyElement(this.lazyLoadedImages,b)})},loadLazyElement:function(a,
b){a[b][0].src=a[b][0].getAttribute("data-src");a[b][0].setAttribute("data-src","");a[b][2]=-1},lastLazyLoadScrollTimestamp:0,lazyLoadScroll:function(a){const b=a-Page.Load.lastLazyLoadScrollTimestamp;Page.Load.lastLazyLoadScrollTimestamp=a;16>b||Page.Load.lazyLoadedImages.forEach((c,d)=>{c[1]<window.innerHeight+Page.scroll+200&&-1!==c[2]&&(clearTimeout(c[2]),Page.Load.loadLazyElement(Page.Load.lazyLoadedImages,d))})},createDesmosGraphs:function(a=1===Site.Settings.urlVars.theme){return new Promise(async(b,
c)=>{Site.scriptsLoaded.desmos||(await Site.loadScript("https://www.desmos.com/api/v1.7/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"),Site.scriptsLoaded.desmos=!0);for(let d in Page.desmosGraphs)try{Page.desmosGraphs[d].destroy()}catch(e){}Page.desmosGraphs={};try{const d=this.getDesmosData();for(let e in d)d[e].expressions.forEach(f=>{f.latex=f.latex.replace(/\(/g,String.raw`\left(`);f.latex=f.latex.replace(/\)/g,String.raw`\right)`);f.latex=f.latex.replace(/\[/g,String.raw`\left[`);f.latex=
f.latex.replace(/\]/g,String.raw`\right]`)});$$(".desmos-container").forEach(e=>{const f={keypad:!1,settingsMenu:!1,zoomButtons:!1,showResetButtonOnGraphpaper:!0,border:!1,expressionsCollapsed:!0,invertedColors:a,xAxisMinorSubdivisions:1,yAxisMinorSubdivisions:1};if(void 0!==d[e.id].options)for(let h in d[e.id].options)f[h]=d[e.id].options[h];Page.desmosGraphs[e.id]=Desmos.GraphingCalculator(e,f);Page.desmosGraphs[e.id].setMathBounds(d[e.id].bounds);Page.desmosGraphs[e.id].setExpressions(d[e.id].expressions);
Page.desmosGraphs[e.id].setDefaultState(Page.desmosGraphs[e.id].getState())})}catch(d){}b()})},exportDesmosScreenshot:function(a,b=!1){Page.desmosGraphs[a].updateSettings({showGrid:b,xAxisNumbers:b,yAxisNumbers:b});let c=Page.desmosGraphs[a].getExpressions();for(let d=0;d<c.length;d++)c[d].lineWidth=b?5:7.5,c[d].pointSize=b?15:27,c[d].dragMode="NONE";Page.desmosGraphs[a].setExpressions(c);Page.desmosGraphs[a].asyncScreenshot({width:500,height:500,targetPixelRatio:8},d=>{const e=document.createElement("img");
e.width=4E3;e.height=4E3;e.style.width="50vmin";e.style.height="50vmin";e.src=d;document.body.appendChild(e)})},HoverEvents:{elementSelectors:"\n\t\t\ta\n\t\t",elementSelectorsWithScale:[["#logo img",1.05],["#scroll-button",1.1],[".text-button:not(.dropdown)",1.075],["select",1.075],[".checkbox-container",1.1],[".radio-button-container",1.1],[".image-link img",1.05],["#enter-fullscreen-button",1.1],["#exit-fullscreen-button",1.1],[".gallery-image-1-1 img",1.075],[".gallery-image-2-2 img",1.0375],
[".gallery-image-3-3 img",1.025]],setUp:function(){$$(this.elementSelectors).forEach(a=>this.add(a));this.elementSelectorsWithScale.forEach(a=>{$$(a[0]).forEach(b=>this.addWithScale(b,a[1]))});$$(".card .tex-holder").forEach(a=>{this.addForTexHolder(a);a.addEventListener("click",()=>Page.Load.Math.showTex(a))})},add:function(a){a.addEventListener("mouseenter",()=>{Site.Interaction.currentlyTouchDevice||(a.classList.add("hover"),"SELECT"===a.tagName?a.previousElementSibling.classList.add("hover"):
a.classList.contains("dropdown-container")&&a.firstElementChild.classList.add("hover"))});a.addEventListener("mouseleave",()=>{Site.Interaction.currentlyTouchDevice||(a.classList.remove("hover"),"SELECT"===a.tagName?a.previousElementSibling.classList.remove("hover"):a.classList.contains("dropdown-container")?a.firstElementChild.classList.remove("hover"):a.blur())})},addWithScale:function(a,b,c=!1){a.addEventListener("mouseenter",()=>{Site.Interaction.currentlyTouchDevice||("SELECT"===a.tagName&&(a=
a.previousElementSibling),a.classList.add("hover"),c?Page.Animate.changeScaleJs(a,b,Site.buttonAnimationTime):Page.Animate.changeScale(a,b,Site.buttonAnimationTime))});a.addEventListener("mouseleave",()=>{Site.Interaction.currentlyTouchDevice||("SELECT"===a.tagName&&(a=a.previousElementSibling),a.classList.remove("hover"),c?Page.Animate.changeScaleJs(a,1,Site.buttonAnimationTime):Page.Animate.changeScale(a,1,Site.buttonAnimationTime))})},addForTexHolder:function(a){a.classList.add("active");a.addEventListener("mouseenter",
()=>{Site.Interaction.currentlyTouchDevice||"1"===a.getAttribute("data-showing-tex")||(a.classList.add("hover"),anime({targets:a,scale:1.05,borderRadius:"8px",backgroundColor:1===Site.Settings.urlVars.theme?"rgba(24, 24, 24, 1)":"rgba(255, 255, 255, 1)",duration:Site.buttonAnimationTime,easing:"easeOutQuad"}))});a.addEventListener("mouseleave",()=>{Site.Interaction.currentlyTouchDevice||(a.classList.remove("hover"),anime({targets:a,scale:1,borderRadius:"0px",backgroundColor:1===Site.Settings.urlVars.theme?
"rgba(24, 24, 24, 0)":"rgba(255, 255, 255, 0)",duration:Site.buttonAnimationTime,easing:"easeInOutQuad"}))})},remove:function(){$$(this.elementSelectors).forEach(a=>a.classList.remove("hover"))}},FocusEvents:{setUpWeirdElements:function(){$$(".focus-on-child").forEach(a=>{a.addEventListener("focus",()=>{a.children[0].focus()})})}},TextButtons:{setUp:function(){const a=this.equalize.bind(this);window.addEventListener("resize",a);Page.temporaryHandlers.resize.push(a);setTimeout(()=>{a()},50);setTimeout(()=>
{a()},500)},equalize:function(){$$(".text-button").forEach(f=>f.parentNode.style.margin="0 auto");let a=[],b=0,c=[],d=0;const e=$$(".linked-text-button");e.forEach((f,h)=>{f.style.height="fit-content";f.style.width="fit-content";a.push(f.offsetHeight);a[h]>b&&(b=a[h]);c.push(f.offsetWidth);c[h]>d&&(d=c[h])});e.forEach((f,h)=>{f.style.height=a[h]<b?b+"px":"fit-content";f.style.width=c[h]<d?d+"px":"fit-content";f.parentNode.parentNode.style.gridTemplateColumns=`repeat(auto-fit, ${d}px)`})},setUpNavButtons:function(){const a=
Site.sitemap[Site.sitemap[Page.url].parent].children,b=a.indexOf(Page.url);-1===b?console.error("Page not found in page list!"):(0<b?$$(".previous-nav-button").forEach(c=>c.setAttribute("onclick",`Page.Navigation.redirect("${a[b-1]}")`)):$$(".previous-nav-button").forEach(c=>c.parentNode.remove()),$$(".home-nav-button").forEach(c=>c.setAttribute("onclick",`Page.Navigation.redirect("${Site.sitemap[Page.url].parent}")`)),b<a.length-1?$$(".next-nav-button").forEach(c=>c.setAttribute("onclick",`Page.Navigation.redirect("${a[b+
1]}")`)):$$(".next-nav-button").forEach(c=>c.parentNode.remove()))}},Links:{set:function(){$$("a").forEach(a=>{let b=a.getAttribute("href");null!==b&&("https"!==b.slice(0,5)&&"data"!==b.slice(0,4)&&1!=a.getAttribute("data-in-new-tab")?a.setAttribute("onclick",`Page.Navigation.redirect("${b}")`):a.setAttribute("onclick",`Page.Navigation.redirect("${b}", true)`))})},disable:function(){$$("a:not(.real-link)").forEach(a=>a.addEventListener("click",b=>b.preventDefault()))}},Math:{lengthCap:250,typeset:async function(){return new Promise(async(a,
b)=>{await MathJax.typesetPromise();DEBUG&&$$(".inline-math").forEach(c=>{c.getBoundingClientRect().width>=this.lengthCap&&(console.log(`Inline math is too long! Source: ${c.getAttribute("data-source-tex")}`),c.classList.add("bad-math"))});a()})},showTex:async function(a){if(Page.Cards.isOpen&&"1"!==a.getAttribute("data-showing-tex")){a.setAttribute("data-showing-tex","1");a.classList.remove("active");a.classList.remove("hover");var b=1===Site.Settings.urlVars.theme?"rgba(24, 24, 24, 0)":"rgba(255, 255, 255, 0)";
await new Promise((k,l)=>{anime({targets:a,scale:1,borderRadius:"0px",backgroundColor:b,duration:0,complete:k})});var c=a.getAttribute("data-source-tex").replaceAll(/\[NEWLINE\]/g,"\n").replaceAll(/\[TAB\]/g,"\t"),d=a.getBoundingClientRect().height,e=a.getBoundingClientRect().width;a.style.minHeight=`${d}px`;var f=a.style.padding,h=document.createElement("div");h.style.display="none";Page.element.appendChild(h);h.appendChild(a.firstElementChild);var g=null;-1!==c.indexOf("\n")?(g=document.createElement("textarea"),
g.textContent=c,g.style.minHeight=`${d-17}px`,g.style.width="100%",g.style.marginLeft="-6px",a.style.width="75%"):(g=document.createElement("input"),g.setAttribute("type","text"),g.setAttribute("value",c),g.style.height=`${d-13}px`,g.style.width=`${e-13}px`);g.style.fontFamily="'Source Code Pro', monospace";a.appendChild(g);a.style.padding=0;g.select();setTimeout(()=>g.select(),50);setTimeout(()=>g.select(),250);g.onblur=()=>{g.remove();a.style.removeProperty("width");a.style.padding=f;a.appendChild(h.firstElementChild);
a.style.minHeight="";h.remove();a.setAttribute("data-showing-tex","0");a.classList.add("active")}}}}};
Page.Cards={container:document.querySelector("#card-container"),currentCard:null,closeButton:document.querySelector("#card-close-button"),closeButtonIsFixed:!1,isOpen:!1,animationTime:500,show:async function(a){this.isOpen=!0;this.container.style.display="flex";this.container.style.opacity=0;this.container.style.transform="scale(1)";this.container.style.display="flex";this.currentCard=document.querySelector(`#${a}-card`);this.container.appendChild(this.currentCard);this.currentCard.insertBefore(this.closeButton,
this.currentCard.firstElementChild);this.container.scroll(0,0);this.currentCard.getBoundingClientRect().height>window.innerHeight-32?this.container.style.justifyContent="flex-start":this.container.style.justifyContent="center";this.container.style.transform="scale(.95)";Page.element.style.filter="brightness(1)";document.querySelector("#header").style.filter="brightness(1)";document.querySelector("#header-container").style.filter="brightness(1)";Page.element.style.transformOrigin=`50% calc(50vh + ${window.scrollY}px)`;
document.documentElement.addEventListener("click",this.handleClickEvent);await new Promise((b,c)=>{anime({targets:this.container,opacity:1,scale:1,duration:this.animationTime,easing:"easeOutQuint"});anime({targets:Page.element,duration:this.animationTime,easing:"easeOutQuint"});anime({targets:[Page.element,document.querySelector("#header"),document.querySelector("#header-container")],filter:"brightness(.5)",scale:.975,duration:this.animationTime,easing:"easeOutQuint"});anime({targets:Site.Settings.metaThemeColorElement,
content:1===Site.Settings.urlVars.theme?"#0c0c0c":"#7f7f7f",duration:this.animationTime,easing:"easeOutQuint"});anime({targets:document.documentElement,backgroundColor:1===Site.Settings.urlVars.theme?"rgb(12, 12, 12)":"rgb(127, 127, 127)",duration:this.animationTime,easing:"easeOutQuint",complete:b})})},hide:async function(){Page.Cards.isOpen=!1;await new Promise((a,b)=>{anime({targets:[Page.element,document.querySelector("#header"),document.querySelector("#header-container")],filter:"brightness(1)",
scale:1,duration:Page.Cards.animationTime,easing:"easeOutQuint"});anime({targets:Site.Settings.metaThemeColorElement,content:1===Site.Settings.urlVars.theme?"#181818":"#ffffff",duration:Page.Cards.animationTime,easing:"easeOutQuint"});anime({targets:document.documentElement,backgroundColor:1===Site.Settings.urlVars.theme?"rgb(24, 24, 24)":"rgb(255, 255, 255)",duration:Page.Cards.animationTime,easing:"easeOutQuint"});anime({targets:Page.Cards.container,opacity:0,scale:.95,duration:Page.Cards.animationTime,
easing:"easeOutQuint",complete:a})});Page.Cards.container.style.display="none";Page.element.appendChild(Page.Cards.currentCard);Page.Cards.container.appendChild(Page.Cards.closeButton);document.documentElement.removeEventListener("click",Page.Cards.handleClickEvent)},handleClickEvent:function(a){"card-container"===a.target.id&&Page.Cards.hide()}};
