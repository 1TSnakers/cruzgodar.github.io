var redirect_refresh_id,new_page_data=null,get_failed=!1;function set_links(){var t;$("a").each(function(e){if("https"!=(t=$(this).attr("href")).slice(0,5)&&"data"!=t.slice(0,4)){var r=concat_url_vars("/settings.html"==t);r=-1==r.indexOf("&")?"":r.substring(r.indexOf("&")),$(this).attr("href","/index.html?page="+encodeURIComponent(t)+r)}})}function redirect(t,e,r,n){if(new_page_data=null,get_failed=!1,$.get(t,function(t){new_page_data=t}).fail(function(){clearInterval(redirect_refresh_id),get_failed=!0,$("html").animate({opacity:1},300,"swing")}),r=void 0!==r&&r,n=void 0!==n&&n,e=void 0!==e&&e)window.open(t,"_blank");else{var a=!1;"/settings.html"==t&&(a=!0),current_url=t,parent_folder=t.slice(0,t.lastIndexOf("/")+1),1==url_vars.content_animation?try_to_load_html(a,n):($("html").animate({opacity:0},300,"swing"),r?setTimeout(function(){$("html, body").addClass("background-transition"),1==url_vars.theme?$("html, body").css("background-color","rgb(24, 24, 24)"):$("html, body").css("background-color","rgb(255, 255, 255)"),setTimeout(function(){$("body").css("background-color",""),$("html, body").removeClass("background-transition"),try_to_load_html(a,n)},450)},300):setTimeout(function(){try_to_load_html(a,n)},300))}}function try_to_load_html(t,e){0==get_failed&&(redirect_refresh_id=setInterval(function(){null!=new_page_data&&(clearInterval(redirect_refresh_id),load_html(new_page_data,t,e))},50))}function load_html(t,e,r){on_page_unload(),0==r&&history.pushState({},document.title,"/index.html"+concat_url_vars(e)),$("body").html(t),on_page_load()}function concat_url_vars(t){for(var e,r="?page="+encodeURIComponent(current_url),n=0;n<Object.keys(url_vars).length;n++)e=Object.keys(url_vars)[n],(1==url_vars[e]||window.matchMedia("(prefers-color-scheme: dark)").matches&&0==url_vars.theme&&"theme"==e)&&(r+="&"+e+"="+url_vars[e]);return t&&(r+="&return="+get_url_var("page")),r}function write_url_vars(){window.location.href.includes("settings")||history.replaceState({},document.title,window.location.href.split("?",1)+concat_url_vars(!1))}$(function(){$(window).on("popstate",function(t){var e=get_url_var("page");redirect(null!=e?decodeURIComponent(e):"/home.html",!1,!1,!0)})});