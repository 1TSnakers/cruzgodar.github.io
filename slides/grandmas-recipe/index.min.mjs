import{QuasiFuchsianGroups}from"/applets/quasi-fuchsian-groups/scripts/class.min.mjs";import Lapsa from"/scripts/lapsa.min.mjs";import{changeOpacity}from"/scripts/src/animation.min.mjs";const applet=new QuasiFuchsianGroups(document.body.querySelector("#output-canvas")),canvasBundle=document.body.querySelector("#canvas-bundle"),resolution=(setTimeout(()=>{document.body.querySelectorAll(".wilson-draggable").forEach(element=>element.classList.add("lapsa-interactable"))},500),1500),maxDepth=250,maxPixelBrightness=50,lapsa=new Lapsa({shelfIconPaths:"/graphics/lapsa-icons/",builds:{title:{reset:async(slide,forward,duration)=>{slide.contains(canvasBundle)||(await changeOpacity(canvasBundle,0,duration/2),slide.appendChild(canvasBundle),applet.changeRecipe(0),applet.bakeCoefficients(1.75,-.3719,1.8638,.2691),await applet.requestHighResFrame(resolution,maxDepth,maxPixelBrightness,4),await changeOpacity(canvasBundle,1,duration/2))}},untamed:{reset:async(slide,forward,duration)=>{slide.contains(canvasBundle)||(await changeOpacity(canvasBundle,0,duration/2),slide.appendChild(canvasBundle),applet.changeRecipe(0),applet.bakeCoefficients(1,-2,3,2),await applet.requestHighResFrame(resolution,maxDepth,maxPixelBrightness,4),await changeOpacity(canvasBundle,1,duration/2))}},"grandmas-recipe":{reset:async(slide,forward,duration)=>{slide.contains(canvasBundle)||(await changeOpacity(canvasBundle,0,duration/2),slide.appendChild(canvasBundle),applet.wilson.draggables.worldCoordinates=[[2,0],[2,0],[2,-2]],applet.wilson.draggables.onResize(),applet.changeRecipe(0),applet.bakeCoefficients(2,0,2,0),await applet.requestHighResFrame(resolution,maxDepth,maxPixelBrightness,4),await changeOpacity(canvasBundle,1,duration/2))}},"rileys-recipe":{reset:async(slide,forward,duration)=>{slide.contains(canvasBundle)||(await changeOpacity(canvasBundle,0,duration/2),slide.appendChild(canvasBundle),applet.wilson.draggables.worldCoordinates=[[2,0],[2,0],[2,-2]],applet.wilson.draggables.onResize(),applet.changeRecipe(1),applet.bakeCoefficients(2,0),await applet.requestHighResFrame(resolution,maxDepth,maxPixelBrightness,4),await changeOpacity(canvasBundle,1,duration/2))}},"special-recipe":{reset:async(slide,forward,duration)=>{slide.contains(canvasBundle)||(await changeOpacity(canvasBundle,0,duration/2),slide.appendChild(canvasBundle),applet.wilson.draggables.worldCoordinates=[[1.737,-.224],[2.337,.987],[2.329,-1.673]],applet.wilson.draggables.onResize(),applet.changeRecipe(2),applet.bakeCoefficients(1.737,-.224,2.337,.987,2.329,-1.673),await applet.requestHighResFrame(resolution,maxDepth,maxPixelBrightness,4),await changeOpacity(canvasBundle,1,duration/2))}},animation:{reset:async(slide,forward,duration)=>{if(!slide.contains(canvasBundle)){await changeOpacity(canvasBundle,0,duration/2),slide.appendChild(canvasBundle),applet.wilson.draggables.worldCoordinates=[[2,0],[2,0],[2,-2]],applet.wilson.draggables.onResize(),applet.changeRecipe(0),applet.resolutionSmall=500,applet.resolutionLarge=1500,applet.changeAspectRatio();let lastTimestamp=0,frame=180,start1X=2,start2X=2,start1Y=0,start2Y=0,end1X=2,end2X=2,end1Y=0,end2Y=0;const animationFrame=timestamp=>{var y1,x2,timeElapsed=timestamp-lastTimestamp;lastTimestamp=timestamp,0!=timeElapsed&&(180<=frame&&(start1X=end1X,start2X=end2X,start1Y=end1Y,start2Y=end2Y,end1X=.15*Math.random()+1.95,end2X=.15*Math.random()+1.95,end1Y=2*Math.random()-1,end2Y=2*Math.random()-1,frame=-10),0<=frame&&(timeElapsed=(1-(timestamp=(Math.sin(frame/180*Math.PI-Math.PI/2)+1)/2))*start1X+timestamp*end1X,y1=(1-timestamp)*start1Y+timestamp*end1Y,x2=(1-timestamp)*start2X+timestamp*end2X,timestamp=(1-timestamp)*start2Y+timestamp*end2Y,applet.wilson.draggables.worldCoordinates=[[timeElapsed,y1],[x2,timestamp],[2,-2]]),frame++,17===lapsa.currentSlide)&&(applet.onDragDraggable(),window.requestAnimationFrame(animationFrame))};window.requestAnimationFrame(animationFrame),await changeOpacity(canvasBundle,1,duration/2)}}}}});