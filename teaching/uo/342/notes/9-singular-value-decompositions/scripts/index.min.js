import{VSingularValues,VU,VW}from"./data.min.js";import{showPage}from"/scripts/src/loadPage.min.js";import{$}from"/scripts/src/main.min.js";import{Slider}from"/scripts/src/sliders.min.js";import{Wilson}from"/scripts/wilson.min.js";async function load(){{const r=new Wilson($("#v-canvas"),{renderer:"cpu",canvasWidth:400,canvasHeight:300}),c=new Array(r.canvasHeight);for(let a=0;a<r.canvasHeight;a++)c[a]=new Array(r.canvasWidth);const e=new Slider({element:$("#depth-slider"),name:"Depth",value:100,min:1,max:200,integer:!0,logarithmic:!0,onInput:function(){t(e.value)}});function t(depth=200){for(let i=0;i<r.canvasHeight;i++)for(let t=0;t<r.canvasWidth;t++)for(let a=c[i][t]=0;a<depth;a++)c[i][t]+=VSingularValues[a]*VU[i][a]*VW[t][a];var t=c,e=new Uint8ClampedArray(r.canvasWidth*r.canvasHeight*4);for(let s=0;s<r.canvasHeight;s++)for(let a=0;a<r.canvasWidth;a++){var n=4*(r.canvasWidth*s+a);e[n]=t[s][a],e[1+n]=t[s][a],e[2+n]=t[s][a],e[3+n]=255}r.ctx.putImageData(new ImageData(e,r.canvasWidth,r.canvasHeight),0,0)}t()}{const o=new Wilson($("#composite-canvas"),{renderer:"cpu",canvasWidth:400,canvasHeight:300}),h=new Array(o.canvasHeight);for(let t=0;t<o.canvasHeight;t++){h[t]=new Array(o.canvasWidth);for(let a=0;a<o.canvasWidth;a++)h[t][a]=[0,0,0]}const n=new Slider({element:$("#depth-slider"),name:"Depth",value:100,min:1,max:200,integer:!0,logarithmic:!0,onInput:function(){a(n.value)}});function a(hDepth=0,sDepth,vDepth=200){for(let s=0;s<o.canvasHeight;s++)for(let t=0;t<o.canvasWidth;t++){h[s][t]=[0,0,0];for(let a=0;a<vDepth;a++)h[s][t][2]+=VSingularValues[a]*VU[s][a]*VW[t][a]}var t=h,e=new Uint8ClampedArray(o.canvasWidth*o.canvasHeight*4);for(let r=0;r<o.canvasHeight;r++)for(let a=0;a<o.canvasWidth;a++){var n=4*(o.canvasWidth*r+a),i=o.utils.hsvToRgb(t[r][a][0]/255,t[r][a][1]/255,t[r][a][2]/255);e[n]=i[0],e[1+n]=i[1],e[2+n]=i[2],e[3+n]=255}o.ctx.putImageData(new ImageData(e,o.canvasWidth,o.canvasHeight),0,0)}a()}showPage()}export{load};