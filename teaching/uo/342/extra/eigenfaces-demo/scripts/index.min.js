import{A,eigendata,uVectors}from"./data.min.js";import{DownloadButton}from"/scripts/src/buttons.min.js";import{Checkbox}from"/scripts/src/checkboxes.min.js";import{$}from"/scripts/src/main.min.js";import{Slider}from"/scripts/src/sliders.min.js";import{Wilson}from"/scripts/wilson.min.js";export default function(){var e={canvasWidth:162,canvasHeight:200,verbose:window.DEBUG};const i=new Wilson($("#output-canvas"),e),h=i.canvasHeight*i.canvasWidth*4,u=new Array(21),f=(new DownloadButton({element:$("#download-button"),wilson:i,filename:()=>"eigenface.png"}),new Checkbox({element:$("#eigenface-checkbox"),name:"Show eigenface",onInput:t})),d=new Slider({element:$("#index-slider"),name:"Face",value:0,min:0,max:20,onInput:t}),v=new Slider({element:$("#depth-slider"),name:"Depth",value:1,min:1,max:21,onInput:t});function t(){if(f.checked){var t=uVectors[Math.floor(d.value)],a=uVectors[Math.ceil(d.value)],n=d.value-Math.floor(d.value),o=new Array(h);for(let e=0;e<h;e++)o[e]=(1-n)*t[e]+n*a[e];p(o)}else{var r,[i,s=21]=[d.value,v.value],l=new Array(h),c=new Array(21);for(let e=0;e<21;e++){var m=Math.floor(i);c[e]=(1-(i-m))*Math.sqrt(eigendata[e][0])*eigendata[e][1][m]/21,i<20&&(c[e]+=(i-m)*Math.sqrt(eigendata[e][0])*eigendata[e][1][m+1]/21)}for(let t=0;t<h;t++){for(let e=l[t]=0;e<Math.floor(s);e++)l[t]+=c[e]*uVectors[e][t]/u[e];s<20&&(r=Math.floor(s),l[t]+=(s-r)*c[r]*uVectors[r][t]/u[r])}p(l)}}function p(vec){var e=[...vec];let t=0,a=0;for(let o=0;o<e.length;o+=4)t=Math.max(t,e[o]),t=Math.max(t,e[o+1]),t=Math.max(t,e[o+2]),a=Math.min(a,e[o]),a=Math.min(a,e[o+1]),a=Math.min(a,e[o+2]);for(let r=0;r<e.length;r+=4)e[r]=(e[r]-a)/(t-a)*255,e[r+1]=(e[r+1]-a)/(t-a)*255,e[r+2]=(e[r+2]-a)/(t-a)*255,e[r+3]=255;var n=new ImageData(new Uint8ClampedArray(e),i.canvasWidth,i.canvasHeight);i.ctx.putImageData(n,0,0)}setTimeout(()=>t(),100);for(let a=0;a<21;a++){let e=0;for(let t=0;t<h;t++)e+=uVectors[a][t]*uVectors[a][t];u[a]=Math.sqrt(e)}}