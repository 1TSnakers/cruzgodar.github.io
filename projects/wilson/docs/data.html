<header><div id="logo"><a href="/home/" tabindex="-1"><img src="/graphics/general-icons/logo.png" alt="Logo" tabindex="1"></img></a></div><div style="height: 20px"></div><h1 class="heading-text">Wilson Documentation</h1></header><main><section><p class="body-text">An explanation of Wilson&#x2019;s properties and methods. At the time of writing, private variables are barely implemented in JavaScript, so although all variables are public, only the ones listed here are intended to be.</p></section><h2 class="section-text"> Constructor</h2><section><p class="body-text"><code>new Wilson(canvas, options)</code>: <code>canvas</code> is an existing canvas element and <code>options</code> is an object specifying settings for Wilson to use. The full list of recognized options is as follows:</p><p class="body-text"><code>render</code>: determines the type of canvas and the method used to render it. Valid values are <code>"cpu"</code>, <code>"hybrid"</code> (default), or <code>"gpu"</code>. <code>"cpu"</code> uses a standard canvas and draws frames by modifying its image data. <code>"hybrid"</code> uses a WebGL canvas and draws frames by rendering them as textures. This mode can increase the maximum canvas size in some browsers and should generally be used over <code>"cpu"</code>. Finally, <code>"gpu"</code> uses a WebGL canvas and renders a fragment shader that&#x2019;s also passed in the options.</p><p class="body-text"><code>shader</code>: a fragment shader for a WebGL canvas. Ignored unless <code>render</code> is <code>"gpu"</code>.</p><p class="body-text"><code>canvasWidth, canvasHeight</code>: the width and height of the canvas in pixels. Can be left undefined, but if so, the canvas element needs to have its width and height properties defined.</p><p class="body-text"><code>worldWidth, worldHeight</code>: the width and height of the space (i.e. &#x201C;world&#x201D;) the canvas is representing. For use with interpolation functions and callbacks. Default to <code>2</code> to match WebGL.</p><p class="body-text"><code>worldCenterX, worldCenterY</code>: the coordinates that the center pixel of the canvas represents, similarly to <code>worldWidth</code> and <code>worldHeight</code>. Default to <code>0</code>.</p><p class="body-text"><code>autoArrangeCanvases</code>: a boolean indicating whether to the canvas into the container structure necessary to use draggables and fullscreen. Defaults to <code>true</code>, and strongly recommended to stay that way unless you know what you&#x2019;re doing.</p><p class="body-text"><code>useDraggables</code>: a boolean indicating whether to add the necessary elements to use draggables. Defaults to <code>false</code>.</p><p class="body-text"><code>draggables_*Callback</code>: a function <code>f</code> to be called when an event of type <code>*</code> is fired on a draggable that is currently being held. The callback syntax is <code>f(index, x, y, event)</code>, where <code>index</code> is the index of the targeted draggable, <code>x</code> and <code>y</code> are its world coordinates, and <code>event</code> is the fired event. Valid values for <code>*</code> are <code>mousedown</code>, <code>mousemove</code>, <code>mouseup</code>, <code>touchstart</code>, <code>touchmove</code>, and <code>touchend</code>.</p><p class="body-text"><code>useFullscreen</code>: a boolean indicating whether to add the necessary elements to use fullscreen. Defaults to <code>false</code>.</p><p class="body-text"><code>trueFullscreen</code>: a boolean indicating whether to stretch the canvas in fullscreen to fit the window. Defaults to <code>false</code>.</p><p class="body-text"><code>canvasesToResize</code>: an array of canvases or other elements that need to be resized when entering or exiting fullscreen. The canvas passed in the constructor is automatically, as is the draggables container.</p><p class="body-text"><code>useFullscreenButton</code>: a boolean indicating whether to add a button in the top-right corner of the canvas to enter and exit fullscreen. Defaults to <code>false</code>.</p><p class="body-text"><code>enterFullscreenButtonIconPath</code>: a string giving the path to the image to be used for the button to enter fullscreen. Required if <code>useFullscreenButton</code> is <code>true</code> and ignored otherwise.</p><p class="body-text"><code>exitFullscreenButtonIconPath</code>: a string giving the path to the image to be used for the button to exit fullscreen. Required if <code>useFullscreenButton</code> is <code>true</code> and ignored otherwise.</p><p class="body-text"><code>switchFullscreenCallback</code>: a function to be called when fullscreen is entered or exited. Typically used to change the canvas and/or world size. Not passed any parameters.</p><p class="body-text"><code>mousedownCallback</code>: a function <code>f</code> to be called when a <code>mousedown</code> event is fired on the canvas. The callback syntax is <code>f(x, y, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location and <code>event</code> is the fired event itself.</p><p class="body-text"><code>mousemoveCallback</code>: a function <code>f</code> to be called when a <code>mousemove</code> event is fired on the canvas and the mouse is <em>not</em> being held. The callback syntax is <code>f(x, y, xDelta, yDelta, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location, <code>xDelta</code> and <code>yDelta</code> are the differences in world coordinates from the last event, and <code>event</code> is the fired event itself.</p><p class="body-text"><code>mousedragCallback</code>: a function <code>f</code> to be called when a <code>mousemove</code> event is fired on the canvas and the mouse <em>is</em> being held. The callback syntax is <code>f(x, y, xDelta, yDelta, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location, <code>xDelta</code> and <code>yDelta</code> are the differences in world coordinates from the last event, and <code>event</code> is the fired event itself.</p><p class="body-text"><code>mouseupCallback</code>: a function <code>f</code> to be called when a <code>mouseup</code> event is fired on the canvas. The callback syntax is <code>f(x, y, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location and <code>event</code> is the fired event itself.</p><p class="body-text"><code>touchstartCallback</code>: a function <code>f</code> to be called when a <code>touchstart</code> event is fired on the canvas. The callback syntax is <code>f(x, y, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location and <code>event</code> is the fired event itself.</p><p class="body-text"><code>touchmoveCallback</code>: a function <code>f</code> to be called when a <code>touchmove</code> event is fired on the canvas. The callback syntax is <code>f(x, y, xDelta, yDelta, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location, <code>xDelta</code> and <code>yDelta</code> are the differences in world coordinates from the last event, and <code>event</code> is the fired event itself.</p><p class="body-text"><code>touchendCallback</code>: a function <code>f</code> to be called when a <code>touchend</code> event is fired on the canvas. The callback syntax is <code>f(x, y, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location and <code>event</code> is the fired event itself.</p><p class="body-text"><code>wheelCallback</code>: a function <code>f</code> to be called when a <code>wheel</code> event is fired on the canvas. The callback syntax is <code>f(x, y, scrollAmount, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location, <code>scrollAmount</code> is the reported scroll delta amount (which can vary wildly between browers), and <code>event</code> is the fired event itself.</p><p class="body-text"><code>pinchCallback</code>: a function <code>f</code> to be called when a two-finger pinch gesture occurs on the canvas. The callback syntax is <code>f(x, y, touchDistanceDelta, event)</code>, where <code>x</code> and <code>y</code> are the world coordinates of the event location, <code>touchDistanceDelta</code> is the world distance between the two touch points on this event minus that distance on the last event, and <code>event</code> is the fired event itself.</p></section><h2 class="section-text"> General</h2><section><p class="body-text"><code>wilson.canvas</code>: the canvas element passed in the constructor.</p><p class="body-text"><code>wilson.ctx</code>: the 2d canvas context. Only usable if <code>options.render</code> is <code>"cpu"</code>.</p><p class="body-text"><code>wilson.gl</code>: the WebGL context. Only usable if <code>options.render</code> is <code>"hybrid"</code> or <code>"gpu"</code>.</p><p class="body-text"><code>wilson.uniforms</code>: a dictionary with all WebGL uniform locations. Only usable if <code>options.render</code> is <code>"gpu"</code> and after calling <code>wilson.render.initUniforms()</code>.</p><p class="body-text"><code>wilson.worldWidth</code>, <code>wilson.worldHeight</code>: the width and height of the space (i.e. &#x201C;world&#x201D;) the canvas is representing. For use with interpolation functions and callbacks.</p><p class="body-text"><code>wilson.worldCenterX</code>, <code>wilson.worldCenterY</code>: the coordinates that the center pixel of the canvas represents, similarly to <code>worldWidth</code> and <code>worldHeight</code>.</p><p class="body-text"><code>wilson.changeCanvasSize(width, height)</code>: changes the canvas size and adjusts the gl viewport if needed. If changing the border or padding of a canvas, this should be called to recalculate the size of the draggable container and other internal values.</p><p class="body-text"><code>wilson.downloadFrame(filename)</code>: downloads the current state of the canvas as a png with the specified filename.</p></section><h2 class="section-text"> Utility Functions</h2><section><p class="body-text"><code>wilson.utils.interpolate.canvasToWorld(x, y)</code>: returns a 2-element array <code>[row, col]</code> of canvas coordinates corresponding to the world coordinates given.</p><p class="body-text"><code>wilson.utils.interpolate.worldToCanvas(x, y)</code>: returns a 2-element array <code>[x, y]</code> of world coordinates corresponding to the canvas coordinates given.</p><p class="body-text"><code>wilson.utils.hsvToRgb(h, s, v)</code>: converts an HSV representation of a color to the equivalent RGB representation. Accepts <code>h</code>, <code>s</code>, <code>v</code> between 0 and 1 and returns a 3-element array <code>[r, g, b]</code> between 0 and 255, unrounded.</p></section><h2 class="section-text"> Rendering</h2><section><p class="body-text"><code>wilson.render.drawFrame(imageData)</code>: draws a frame to the canvas. <code>imageData</code> is a <code>Uint8ClampedArray</code> of length <code>canvasWidth * canvasHeight * 4</code>, where each sequence of 4 elements gives an RGBA representation of a pixel. If <code>options.render</code> is <code>"gpu"</code>, <code>imageData</code> is ignored.</p><p class="body-text"><code>wilson.render.initUniforms(uniformNames)</code>: stores the uniform locations for a shader in <code>wilson.uniformLocations</code>. <code>uniformNames</code> is an array of strings giving the names of the uniforms in the shader. Only to be used if <code>options.render</code> is <code>"gpu"</code>.</p><p class="body-text"><code>wilson.render.getPixelData</code>: returns a <code>Uint8Array</code> of length <code>canvasWidth * canvasHeight * 4</code>, where each sequence of 4 elements gives an RGBA representation of a pixel. Only to be used if <code>options.render</code> is <code>"gpu"</code>.</p></section><h2 class="section-text"> Draggables</h2><section><p class="body-text"><code>wilson.draggables.worldCoordinates</code>: a list of the world coordinates of each draggable.</p><p class="body-text"><code>wilson.draggables.numDraggables</code>: the number of draggables that have been added to the canvas.</p><p class="body-text"><code>wilson.draggables.draggableRadius</code>: the radius, including border and padding, of the draggable. Needs to be updated if the style is changed.</p><p class="body-text"><code>wilson.draggables.add(x, y)</code>: adds a new draggable at the specified world coordinates.</p><p class="body-text"><code>wilson.draggables.recalculateLocations()</code>: recalculates all of the draggables&#x2019; page coordinates based on their world coordinates.</p></section><h2 class="section-text"> Fullscreen</h2><section><p class="body-text"><code>wilson.fullscreen.currentlyFullscreen</code>: a boolean indicating whether the canvas is currently fullscreen.</p><p class="body-text"><code>wilson.fullscreen.switchFullscreen()</code>: toggles fullscreen and windowed mode. To be used when not using the built-in fullscreen button.</p></section><h2 class="section-text"> Interactivity</h2><section><p class="body-text"><code>wilson.input.getZoomedWorldCenter(fixedPointX, fixedPointY, newWorldWidth, newWorldHeight)</code>: gets the world center that will make the given point a fixed point of a zoom. To be called <em>before</em> changing the world width and height, and passed the values they will be changed to.</p><div class='text-buttons'><div class="focus-on-child" tabindex="1"><button class="text-button" type="button" id="homepage-button" tabindex="-1">l</button></div></div></section></main>