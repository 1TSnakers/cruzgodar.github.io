import{showPage}from"/scripts/src/load-page.min.mjs";import{$,$$}from"/scripts/src/main.min.mjs";import{Wilson}from"/scripts/wilson.min.mjs";!function(){"use strict";var elements=$$("pre code");for(let i=0;i<elements.length;i++)elements[i].classList.add("highlightable");hljs.highlightAll();var options={renderer:"hybrid",canvasWidth:1e3,canvasHeight:1e3,worldWidth:4,worldHeight:4,worldCenterX:0,worldCenterY:0,useDraggables:!0,draggablesMousedownCallback:onGrab,draggablesMousemoveCallback:onDrag,draggablesMouseupCallback:onRelease,draggablesTouchstartCallback:onGrab,draggablesTouchmoveCallback:onDrag,draggablesTouchendCallback:onRelease};let wilson=new Wilson($("#output-canvas"),options);wilson.draggables.add(0,1);let largeResolution=1e3,smallResolution=200,a=0,b=1,resolution=200,lastResolution=0,lastTimestamp=-1,resolutionInputElement=$("#resolution-input");function onGrab(activeDraggable,x,y,event){wilson.changeCanvasSize(smallResolution,smallResolution),a=x,b=y,resolution=smallResolution,window.requestAnimationFrame(drawJuliaSet)}function onDrag(activeDraggable,x,y,event){a=x,b=y,resolution=smallResolution,window.requestAnimationFrame(drawJuliaSet)}function onRelease(activeDraggable,x,y,event){wilson.changeCanvasSize(largeResolution,largeResolution),a=x,b=y,resolution=largeResolution,window.requestAnimationFrame(drawJuliaSet)}function drawJuliaSet(timestamp){var timeElapsed=timestamp-lastTimestamp;lastTimestamp=timestamp,0==timeElapsed&&lastResolution===resolution||(lastResolution=resolution,wilson.render.drawFrame(function(a,b,resolution){var brightnesses=new Array(resolution*resolution);let maxBrightness=0;for(let i=0;i<resolution;i++)for(let j=0;j<resolution;j++){var worldCoordinates=wilson.utils.interpolate.canvasToWorld(i,j);let x=worldCoordinates[0],y=worldCoordinates[1],brightness=Math.exp(-Math.sqrt(x*x+y*y)),k=0;for(k=0;k<100;k++){var temp=x*x-y*y+a;if(y=2*x*y+b,x=temp,brightness+=Math.exp(-Math.sqrt(x*x+y*y)),4<x*x+y*y)break}100===k?brightnesses[resolution*i+j]=0:(brightnesses[resolution*i+j]=brightness)>maxBrightness&&(maxBrightness=brightness)}var imageData=new Uint8ClampedArray(resolution*resolution*4);for(let i=0;i<resolution*resolution;i++)imageData[4*i]=0,imageData[4*i+1]=1.5*brightnesses[i]/maxBrightness*255,imageData[4*i+2]=1.5*brightnesses[i]/maxBrightness*255,imageData[4*i+3]=255;return imageData}(a,b,resolution)))}resolutionInputElement.addEventListener("input",()=>{largeResolution=parseInt(resolutionInputElement.value||1e3),smallResolution=Math.floor(largeResolution/5)}),$("#download-button").addEventListener("click",()=>{wilson.downloadFrame("a-julia-set.png")}),wilson.changeCanvasSize(smallResolution,smallResolution),window.requestAnimationFrame(drawJuliaSet),showPage()}();