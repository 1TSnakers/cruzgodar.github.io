!async function(){function c(){const b=q.checked?d.value:Applet.parseNaturalGLSL(d.value),h=parseInt(e.value||500),k=Math.max(parseInt(f.value||1E4),100),l=parseFloat(g.value||1)/150,r=Math.min(parseInt(m.value||100),255);a.run(b,h,k,l,r,0,0,.5)}function n(){const b=parseInt(e.value||500),h=Math.max(parseInt(f.value||1E4),100),k=parseFloat(g.value||1)/150,l=Math.min(parseInt(m.value||100),255);a.generateNewField(b,h,k,l)}await Applet.load("vector-fields");const a=new VectorField($("#output-canvas"));
a.loadPromise.then(()=>c());const t={none:"","sources-and-sinks":"((0.6x - 1)(0.6x + 1), (0.6y + 1)(0.6y - 1))","saddle-points":"(0.49y^2, 1 - 0.49x^2)",clockwork:"(sin(1.5y), -sin(1.5x))",df:"(1, sin(y) / (x^2 + 1))",cross:"(sin(y / 2.5), tan(x / 2.5))",draggables:"(draggableArg.x * x - y, x + draggableArg.y * y)"},p=$("#example-selector-dropdown");p.addEventListener("input",()=>{"none"!==p.value&&(d.value=t[p.value],c())});const d=$("#code-textarea");d.addEventListener("keydown",b=>{13===b.keyCode&&
(b.preventDefault(),c())});const q=$("#raw-glsl-checkbox");$("#generate-button").addEventListener("click",c);const e=$("#resolution-input"),f=$("#max-particles-input"),g=$("#speed-input"),m=$("#lifetime-input");a.setInputCaps([e,f],[1E3,5E4]);e.addEventListener("input",n);f.addEventListener("input",n);g.addEventListener("input",()=>{const b=parseFloat(g.value||1)/150;a.wilsonUpdate.gl.useProgram(a.wilsonUpdate.render.shaderPrograms[0]);a.wilsonUpdate.gl.uniform1f(a.wilsonUpdate.uniforms.dt[0],b);
a.wilsonUpdate.gl.useProgram(a.wilsonUpdate.render.shaderPrograms[1]);a.wilsonUpdate.gl.uniform1f(a.wilsonUpdate.uniforms.dt[1],b);a.wilsonUpdate.gl.useProgram(a.wilsonUpdate.render.shaderPrograms[2]);a.wilsonUpdate.gl.uniform1f(a.wilsonUpdate.uniforms.dt[2],b);a.wilsonUpdate.gl.useProgram(a.wilsonUpdate.render.shaderPrograms[3]);a.wilsonUpdate.gl.uniform1f(a.wilsonUpdate.uniforms.dt[3],b)});m.addEventListener("input",n);$("#download-button").addEventListener("click",()=>a.wilson.downloadFrame("a-vector-field.png"));
Page.show()}();
