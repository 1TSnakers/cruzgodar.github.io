import{VectorField}from"./class.min.mjs";import{Applet}from"/scripts/src/applets.min.mjs";import{showPage}from"/scripts/src/load-page.min.mjs";import{$}from"/scripts/src/main.min.mjs";function load(){const applet=new VectorField($("#output-canvas")),codeTextareaElement=(applet.loadPromise.then(()=>run()),$("#code-textarea")),examples=(codeTextareaElement.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),run())}),{none:"","sources-and-sinks":"((0.6x - 1)(0.6x + 1), (0.6y + 1)(0.6y - 1))","saddle-points":"(0.49y^2, 1 - 0.49x^2)",clockwork:"(sin(1.5y), -sin(1.5x))",df:"(1, sin(y) / (x^2 + 1))",cross:"(sin(y / 2.5), tan(x / 2.5))",draggables:"(draggableArg.x * x - y, x + draggableArg.y * y)"}),exampleSelectorDropdownElement=$("#example-selector-dropdown"),rawGLSLCheckboxElement=(exampleSelectorDropdownElement.addEventListener("input",()=>{"none"!==exampleSelectorDropdownElement.value&&(codeTextareaElement.value=examples[exampleSelectorDropdownElement.value],run())}),$("#raw-glsl-checkbox"));$("#generate-button").addEventListener("click",run);const resolutionInputElement=$("#resolution-input"),maxParticlesInputElement=$("#max-particles-input"),speedInputElement=$("#speed-input"),lifetimeInputElement=$("#lifetime-input");function run(){var generatingCode=rawGLSLCheckboxElement.checked?codeTextareaElement.value:Applet.parseNaturalGLSL(codeTextareaElement.value),resolution=parseInt(resolutionInputElement.value||500),maxParticles=Math.max(parseInt(maxParticlesInputElement.value||1e4),100),dt=parseFloat(speedInputElement.value||1)/150,lifetime=Math.min(parseInt(lifetimeInputElement.value||100),255);applet.run({generatingCode:generatingCode,resolution:resolution,maxParticles:maxParticles,dt:dt,lifetime:lifetime,worldCenterX:0,worldCenterY:0,zoomLevel:.5})}function generateNewField(){var resolution=parseInt(resolutionInputElement.value||500),maxParticles=Math.max(parseInt(maxParticlesInputElement.value||1e4),100),dt=parseFloat(speedInputElement.value||1)/150,lifetime=Math.min(parseInt(lifetimeInputElement.value||100),255);applet.generateNewField(resolution,maxParticles,dt,lifetime)}applet.setInputCaps([resolutionInputElement,maxParticlesInputElement],[1e3,5e4]),resolutionInputElement.addEventListener("input",generateNewField),maxParticlesInputElement.addEventListener("input",generateNewField),speedInputElement.addEventListener("input",()=>{var dt=parseFloat(speedInputElement.value||1)/150;applet.wilsonUpdate.gl.useProgram(applet.wilsonUpdate.render.shaderPrograms[0]),applet.wilsonUpdate.gl.uniform1f(applet.wilsonUpdate.uniforms.dt[0],dt),applet.wilsonUpdate.gl.useProgram(applet.wilsonUpdate.render.shaderPrograms[1]),applet.wilsonUpdate.gl.uniform1f(applet.wilsonUpdate.uniforms.dt[1],dt),applet.wilsonUpdate.gl.useProgram(applet.wilsonUpdate.render.shaderPrograms[2]),applet.wilsonUpdate.gl.uniform1f(applet.wilsonUpdate.uniforms.dt[2],dt),applet.wilsonUpdate.gl.useProgram(applet.wilsonUpdate.render.shaderPrograms[3]),applet.wilsonUpdate.gl.uniform1f(applet.wilsonUpdate.uniforms.dt[3],dt)}),lifetimeInputElement.addEventListener("input",generateNewField),$("#download-button").addEventListener("click",()=>applet.wilson.downloadFrame("a-vector-field.png")),showPage()}export{load};