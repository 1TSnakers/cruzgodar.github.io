import{showPage}from"/scripts/src/load-page.mjs";import{VectorField}from"./class.mjs";import{Applet}from"../../../scripts/src/applets.mjs";function load(){const s=new VectorField($("#output-canvas"));function a(){var e=l.checked?o.value:Applet.parseNaturalGLSL(o.value),a=parseInt(d.value||500),n=Math.max(parseInt(i.value||1e4),100),t=parseFloat(p.value||1)/150,r=Math.min(parseInt(u.value||100),255);s.run(e,a,n,t,r,0,0,.5)}function e(){var e=parseInt(d.value||500),a=Math.max(parseInt(i.value||1e4),100),n=parseFloat(p.value||1)/150,t=Math.min(parseInt(u.value||100),255);s.generateNewField(e,a,n,t)}s.loadPromise.then(()=>a());const n={none:"","sources-and-sinks":"((0.6x - 1)(0.6x + 1), (0.6y + 1)(0.6y - 1))","saddle-points":"(0.49y^2, 1 - 0.49x^2)",clockwork:"(sin(1.5y), -sin(1.5x))",df:"(1, sin(y) / (x^2 + 1))",cross:"(sin(y / 2.5), tan(x / 2.5))",draggables:"(draggableArg.x * x - y, x + draggableArg.y * y)"},t=$("#example-selector-dropdown"),o=(t.addEventListener("input",()=>{"none"!==t.value&&(o.value=n[t.value],a())}),$("#code-textarea")),l=(o.addEventListener("keydown",e=>{13===e.keyCode&&(e.preventDefault(),a())}),$("#raw-glsl-checkbox"));$("#generate-button").addEventListener("click",a);const d=$("#resolution-input"),i=$("#max-particles-input"),p=$("#speed-input"),u=$("#lifetime-input");s.setInputCaps([d,i],[1e3,5e4]),d.addEventListener("input",e),i.addEventListener("input",e),p.addEventListener("input",()=>{var e=parseFloat(p.value||1)/150;s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[0]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[0],e),s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[1]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[1],e),s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[2]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[2],e),s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[3]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[3],e)}),u.addEventListener("input",e),$("#download-button").addEventListener("click",()=>s.wilson.downloadFrame("a-vector-field.png")),showPage()}export{load};