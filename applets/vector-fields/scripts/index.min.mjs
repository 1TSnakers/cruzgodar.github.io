import{VectorField}from"./class.min.mjs";import{Applet}from"/scripts/src/applets.min.mjs";import{showPage}from"/scripts/src/load-page.min.mjs";import{$}from"/scripts/src/main.min.mjs";function load(){const s=new VectorField({canvas:$("#output-canvas")}),o=(s.loadPromise.then(()=>n()),$("#code-textarea")),a=(o.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),n())}),{none:"","sources-and-sinks":"((0.6x - 1)(0.6x + 1), (0.6y + 1)(0.6y - 1))","saddle-points":"(0.49y^2, 1 - 0.49x^2)",clockwork:"(sin(1.5y), -sin(1.5x))",df:"(1, sin(y) / (x^2 + 1))",cross:"(sin(y / 2.5), tan(x / 2.5))",draggables:"(draggableArg.x * x - y, x + draggableArg.y * y)"}),t=$("#example-selector-dropdown"),i=(t.addEventListener("input",()=>{"none"!==t.value&&(o.value=a[t.value],n())}),$("#raw-glsl-checkbox"));$("#generate-button").addEventListener("click",n);const l=$("#resolution-input"),d=$("#max-particles-input"),p=$("#speed-input"),u=$("#lifetime-input");function n(){var e=i.checked?o.value:Applet.parseNaturalGLSL(o.value),a=parseInt(l.value||500),t=Math.max(parseInt(d.value||1e4),100),n=parseFloat(p.value||1)/300,r=Math.min(parseInt(u.value||150),255);s.run({generatingCode:e,resolution:a,maxParticles:t,dt:n,lifetime:r,worldCenterX:0,worldCenterY:0,zoomLevel:.5})}function r(){var e=parseInt(l.value||500),a=Math.max(parseInt(d.value||1e4),100),t=parseFloat(p.value||1)/300,n=Math.min(parseInt(u.value||150),255);s.generateNewField({resolution:e,maxParticles:a,dt:t,lifetime:n})}s.setInputCaps([l,d],[1e3,5e4]),l.addEventListener("input",r),d.addEventListener("input",r),p.addEventListener("input",()=>{var e=parseFloat(p.value||1)/300;s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[0]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[0],e),s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[1]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[1],e),s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[2]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[2],e),s.wilsonUpdate.gl.useProgram(s.wilsonUpdate.render.shaderPrograms[3]),s.wilsonUpdate.gl.uniform1f(s.wilsonUpdate.uniforms.dt[3],e)}),u.addEventListener("input",r),$("#download-button").addEventListener("click",()=>s.wilson.downloadFrame("a-vector-field.png")),showPage()}export{load};