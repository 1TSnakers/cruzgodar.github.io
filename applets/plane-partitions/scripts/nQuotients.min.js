import{hsvToRgb}from"/scripts/applets/applet.min.js";import{changeOpacity}from"/scripts/src/animation.min.js";import{convertColor}from"/scripts/src/browser.min.js";import{animate}from"/scripts/src/utils.min.js";async function drawBoundary(index,n){this.in2dView||await this.show2dView(),"0"!==this.wilsonNumbers.canvas.style.opacity&&await changeOpacity({element:this.wilsonNumbers.canvas,opacity:0,duration:this.animationTime/3}),this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);var t,s=this.arrays[index],i=s.numbers,r=[];let o=0,a=0;for(let h=s.footprint-1;0<=h;h--){for(;a<s.footprint&&i[h][a]===1/0;)h!==s.footprint-1&&i[h+1][a]===1/0||(t=o%n/n,t=hsvToRgb(t,1,1),r.push([h,a,!0,t]),o++),a++;var e=o%n/n,e=hsvToRgb(e,1,1);r.push([h,a,!1,e]),o++}for(var c;a<s.footprint;)-1!=s.footprint-1&&i[0][a]===1/0||(c=o%n/n,c=hsvToRgb(c,1,1),r.push([-1,a,!0,c]),o++),a++;for(const l of r)this.drawBoundaryRect(s,l[0],l[1],l[2],l[3]);return await changeOpacity({element:this.wilsonNumbers.canvas,opacity:1,duration:this.animationTime/3}),this.wilsonNumbers.ctx.fillStyle=convertColor(255,255,255),r}async function drawNQuotient(index,n,m,rects){const o=this.arrays[index];await animate(t=>{this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);for(var[s,i]of rects.entries()){s=s%n===m?1:1-t;this.drawBoundaryRect(o,i[0],i[1],i[2],[...i[3],s])}},this.animationTime),this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);for(const[index,rect]of rects.entries()){var s=index%n===m?1:0;this.drawBoundaryRect(o,rect[0],rect[1],rect[2],[...rect[3],s])}var i=(rects=rects.filter((rect,index)=>index%n===m)).filter(rect=>!rect[2]).length;const a=new Array(rects.length);let r=i-1,e=0;for(const[index,rect]of rects.entries())a[index]=[r,e],rect[2]?e++:r--;await animate(t=>{this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);for(var[s,i]of rects.entries())this.drawBoundaryRect(o,(1-t)*i[0]+t*a[s][0],(1-t)*i[1]+t*a[s][1],i[2],i[3])},this.animationTime,"easeInOutQuad"),this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);for(const[index,rect]of rects.entries())this.drawBoundaryRect(o,a[index][0],a[index][1],rect[2],rect[3]);var c=[];for(const[index,rect]of a.entries())if(!rects[index][2])for(let s=rect[1];s<o.footprint;s++)if(o.numbers[rect[0]][s]===1/0)for(let t=0;t<this.infiniteHeight;t++)c.push([rect[0],s,t]);this.deleteCubes(o,c,!0);const h=[];for(let l=o.footprint-1;l>a[0][0];l--)h.push([l,0,!1]);for(let u=a[a.length-1][1];u<o.footprint;u++)h.push([-1,u,!0]);await animate(t=>{this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);for(var[s,i]of rects.entries())this.drawBoundaryRect(o,a[s][0],a[s][1],i[2],i[3]);for(const r of h)this.drawBoundaryRect(o,r[0],r[1],r[2],[...rects[0][3],t])},this.animationTime/2,"easeInQuad"),this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);for(const[index,rect]of rects.entries())this.drawBoundaryRect(o,a[index][0],a[index][1],rect[2],rect[3]);for(const rect of h)this.drawBoundaryRect(o,rect[0],rect[1],rect[2],rect[3]);this.wilsonNumbers.ctx.fillStyle=convertColor(255,255,255)}function drawBoundaryRect(array,i,j,horizontal,rgba){var t=(this.totalArrayFootprint-array.footprint-1)/2,s=array.partialFootprintSum-array.footprint;this.wilsonNumbers.ctx.fillStyle=convertColor(...rgba),horizontal?this.wilsonNumbers.ctx.fillRect(this.wilsonNumbers.canvasWidth*(j+s+1)/(this.totalArrayFootprint+1),this.wilsonNumbers.canvasHeight*(i+t+1+.9375)/(this.totalArrayFootprint+1)+1,this.wilsonNumbers.canvasWidth/(this.totalArrayFootprint+1),this.wilsonNumbers.canvasHeight*(1/16)/(this.totalArrayFootprint+1)):this.wilsonNumbers.ctx.fillRect(this.wilsonNumbers.canvasWidth*(j+s+.9375)/(this.totalArrayFootprint+1),this.wilsonNumbers.canvasHeight*(i+t+1)/(this.totalArrayFootprint+1)+1,this.wilsonNumbers.canvasWidth*(1/16)/(this.totalArrayFootprint+1),this.wilsonNumbers.canvasHeight/(this.totalArrayFootprint+1))}export{drawBoundary,drawNQuotient,drawBoundaryRect};