const absoluteMinAEntry=-5;function isValidABConfig({lambda,mu,nu,A,B}){for(;lambda.length<nu[0];)lambda.push(0);for(;mu.length<nu.length;)mu.push(0);var e=[];let n=0,a=0;for(;A[n][0]===1/0;)n++;for(;A[0][a]===1/0;)a++;if(A[n-1][a-1]!==1/0)throw new Error("Infinite part of A is not rectangular!");for(let s=0;s<A.length;s++)for(let t=0;t<A[s].length;t++){const b=s-n,c=t-a;if(!(b<0&&c<0)){const v=0<=b&&b<nu.length&&0<=c&&c<nu[b];var[r,l]=b<0?[lambda[c],0]:c<0?[mu[b],0]:v?[Math.min(lambda[c],mu[b]),Math.max(lambda[c],mu[b])]:[0,Math.min(lambda[c],mu[b])];for(let n=v?absoluteMinAEntry:0;n<Math.max(r,l);n++){var[i,u]=(()=>{if(b<0)return[1,1];if(c<0)return[1,2];if(n<0)return[1,3];if(v&&n<Math.min(lambda[c],mu[b]))return[3,0];if(!v)return[2,3];if(n>=lambda[c])return[2,1];if(n>=mu[b])return[2,2];throw new Error("Region/label code is broken")})(),o=A[s][t]<=n&&n<r,m=0<=b&&0<=c&&B[b][c]<=n&&n<l,h=0<=b&&0<=c&&n<l&&0<=n;(1===i&&o||2===i&&!m&&h||3===i&&(o&&!m||!o&&m))&&e.push([b,c,n,u])}}}var f=[];const g=structuredClone(e),d=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]];for(;0!==g.length;){let n=[],t=[g[0]];for(g.splice(0,1);0!==t.length;){const x=[];t.forEach(activeBox=>{d.forEach(direction=>{var n=boxIsInArray([activeBox[0]+direction[0],activeBox[1]+direction[1],activeBox[2]+direction[2]],g);-1!==n&&(x.push(g[n]),g.splice(n,1))})}),n=n.concat(t),t=x}f.push(n)}for(let M=0;M<f.length;M++){var t=new Set(f[M].map(box=>box[3]));if(t.delete(0),1<t.size)return!1}return!0}function boxIsInArray(box,array){for(let t=0;t<array.length;t++){var n=array[t];if(n[0]===box[0]&&n[1]===box[1]&&n[2]===box[2])return t}return-1}function getMinimalABConfig({lambda,mu,nu,negativeWidth=2}){for(;lambda.length<nu[0];)lambda.push(0);for(;mu.length<nu.length;)mu.push(0);var t=new Array(negativeWidth+mu.length),e=new Array(mu.length);for(let l=0;l<t.length;l++){t[l]=new Array(negativeWidth+lambda.length),l>=negativeWidth&&(e[l-negativeWidth]=new Array(lambda.length));for(let n=0;n<t[l].length;n++){const i=l-negativeWidth,u=n-negativeWidth;if(i<0&&u<0)t[l][n]=1/0;else{const o=0<=i&&i<nu.length&&0<=u&&u<nu[i];var[a,r]=i<0?[lambda[u],0]:u<0?[mu[i],0]:o?[Math.min(lambda[u],mu[i]),Math.max(lambda[u],mu[i])]:[-1/0,Math.min(lambda[u],mu[i])];t[l][n]=a,0<=i&&0<=u&&(e[i][u]=r)}}}return[t,e]}function iterateThroughEntries({lambda,mu,nu,A,B,i,j}){for(;lambda.length<nu[0];)lambda.push(0);for(;mu.length<nu.length;)mu.push(0);let n=0,t=0;for(;A[n][0]===1/0;)n++;for(;A[0][t]===1/0;)t++;var a=i-n,r=j-t;if(!(a<0&&r<0)){var l=0<=a&&a<nu.length&&0<=r&&r<nu[a],u=A[i][j],o=Math.max(Math.max(i===A.length-1?-1/0:A[i+1][j],j===A[0].length-1?-1/0:A[i][j+1]),l?absoluteMinAEntry:0),m=0<=a&&0<=r?B[a][r]:1/0,h=0<=a&&0<=r?Math.max(a==B.length-1?0:B[1+a][r],r==B[0].length-1?0:B[r][1+r]):1/0,f=structuredClone(A),g=structuredClone(B);let e="";if(u===-1/0)for(let n=m;n>=h;n--)g[a][r]=n,isValidABConfig({lambda:lambda,mu:mu,nu:nu,A:f,B:g})?e+="* ":e+="  ";else if(m===1/0)for(let n=u;n>=o;n--)f[i][j]=n,isValidABConfig({lambda:lambda,mu:mu,nu:nu,A:f,B:g})?e+=n===absoluteMinAEntry?"v\n":"*\n":e+="\n";else for(let t=u;t>=o;t--){for(let n=m;n>=h;n--)f[i][j]=t,g[a][r]=n,isValidABConfig({lambda:lambda,mu:mu,nu:nu,A:f,B:g})?e+=t===absoluteMinAEntry?"v ":"* ":e+="  ";e+="\n"}console.log(e)}}function printABConfig({A,B}){let t="",e=0,n=0;for(;A[e][0]===1/0;)e++;for(;A[0][n]===1/0;)n++;for(let l=0;l<A.length;l++){var a=l-e;for(let n=0;n<A[l].length;n++){var r=A[l][n]===1/0?"^":A[l][n]===-1/0?"v":A[l][n];t+=r+" "}if(0<=a){t+="  ";for(let n=0;n<B[a].length;n++)t+=B[a][n]+" "}t+="\n"}console.log(t)}function testAllEntriesOfABConfig({lambda,mu,nu,A,B}){let t=0,e=0;for(;A[t][0]===1/0;)t++;for(;A[0][e]===1/0;)e++;for(let u=0;u<A.length;u++)for(let n=0;n<A.length;n++){var a,r,l,i;u<t&&n<e||(console.log(u,n),this.iterateThroughEntries({A:A,B:B,lambda:lambda,mu:mu,nu:nu,i:u,j:n}),a=u-t,r=n-e,0<=a&&0<=r&&a<nu.length&&r==nu[a]-1&&(nu[a]--,l=structuredClone(A),i=structuredClone(B),l[u][n]=-1/0,i[a][r]=Math.min(lambda[r],mu[a]),this.iterateThroughEntries({A:l,B:i,lambda:lambda,mu:mu,nu:nu,i:u,j:n}),nu[a]++))}}export{isValidABConfig,getMinimalABConfig,iterateThroughEntries,printABConfig,testAllEntriesOfABConfig};