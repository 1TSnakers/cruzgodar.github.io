async function pak(index){const s=this.arrays[index],a=s.numbers;this.in2dView||await this.show2dView();let t=0,i=0;for(;t<s.footprint&&0!==s.numbers[t][s.footprint-1];)t++;for(;i<s.footprint&&0!==s.numbers[s.footprint-1][i];)i++;t=0;let h=i=0;for(let o=s.footprint-1-i;0<=o;o--)for(let e=s.footprint-1-t;0<=e;e--)a[o][e]!==1/0&&h++;let l=0;for(let c=0;c<s.footprint-i;c++)for(let r=0;r<s.footprint-t;r++)if(a[c][r]!==1/0){var d=[];let t=0;for(;c+t<s.footprint&&r+t<s.footprint;)d.push([c+t,r+t,a[c+t][r+t]-1]),t++;t=d[0][0];let i=d[0][1],e=[];for(let o=a[t][i]-2;0<=o;o--)e.push([t,i,o]);this.colorCubes(s,e,l/h*6/7),e=[],d.forEach(coordinate=>{0<=coordinate[2]&&e.push(coordinate)}),await this.colorCubes(s,e,l/h*6/7);const p=new Array(d.length);d.forEach((coordinate,index)=>{var e=coordinate[0],t=coordinate[1];let i=0,o=0;e<s.footprint-1&&(i=a[e+1][t]),t<s.footprint-1&&(o=a[e][t+1]),p[index]=Math.max(i,o),0<index?(i=a[e-1][t],o=a[e][t-1],p[index]+=Math.min(i,o)-a[e][t]):p[index]=a[e][t]-p[index]});for(let n=0;n<d.length;n++){if(t=d[n][0],i=d[n][1],p[n]>a[t][i]){var f=[];for(let e=a[t][i];e<p[n];e++)s.cubes[t][i][e]=this.addCube(s,i,e,t),f.push([t,i,e]);this.in2dView?this.revealCubes(s,f):await this.revealCubes(s,f)}else if(p[n]<a[t][i]){var u=[];for(let e=a[t][i]-1;e>=p[n];e--)u.push([t,i,e]);this.in2dView?this.deleteCubes(s,u):await this.deleteCubes(s,u)}a[t][i]=p[n],this.in2dView&&this.drawSingleCell2dViewText(s,t,i)}const w=[];e.forEach((coordinate,index)=>{0!==index&&coordinate[2]<a[coordinate[0]][coordinate[1]]&&w.push(coordinate)}),this.in2dView?this.uncolorCubes(s,w):await this.uncolorCubes(s,w),l++,this.recalculateHeights(s),0!==e.length&&await sleep(this.animationTime)}this.updateCameraHeight(!0)}async function pakInverse(index,rightLegSize=0,bottomLegSize=0){const r=this.arrays[index],s=r.numbers;this.in2dView||await this.show2dView();let a=0;for(let t=r.footprint-1-bottomLegSize;0<=t;t--)for(let e=r.footprint-1-rightLegSize;0<=e;e--)s[t][e]!==1/0&&a++;let h=0;for(let c=r.footprint-1-bottomLegSize;0<=c;c--)for(let e=r.footprint-1-rightLegSize;0<=e;e--)if(s[c][e]!==1/0){var l=[];let t=0;for(;c+t<r.footprint&&e+t<r.footprint;)l.push([c+t,e+t,s[c+t][e+t]-1]),t++;t=l[0][0];let i=l[0][1];const p=new Array(l.length);let n=!1;if(l.forEach((coordinate,index)=>{var e=coordinate[0],t=coordinate[1];let i=0,o=0;e<r.footprint-1&&(i=s[e+1][t]),t<r.footprint-1&&(o=s[e][t+1]),p[index]=Math.max(i,o),0<index?(i=s[e-1][t],o=s[e][t-1],p[index]+=Math.min(i,o)-s[e][t]):p[index]+=s[e][t],n||p[index]===s[e][t]||(n=!0)}),0!==s[t][i]){var d=[];for(let e=s[t][i]-1;0<=e;e--)d.push([t,i,e]);this.colorCubes(r,d,h/a*6/7)}else if(0!==p[0])r.cubes[t][i][0]=this.addCube(r,i,0,t,h/a*6/7,1,this.cubeLightness),s[t][i]=1,this.revealCubes(r,[[t,i,0]]);else if(!n){h++;continue}await sleep(this.animationTime);for(let o=0;o<l.length;o++){if(t=l[o][0],i=l[o][1],p[o]>s[t][i]){var f=[];for(let e=s[t][i];e<p[o];e++)r.cubes[t][i][e]=this.addCube(r,i,e,t,h/a*6/7,1,this.cubeLightness),f.push([t,i,e]);this.in2dView?this.revealCubes(r,f):await this.revealCubes(r,f)}else if(p[o]<s[t][i]){var u=[];for(let e=s[t][i]-1;e>=p[o];e--)u.push([t,i,e]);this.in2dView?this.deleteCubes(r,u):await this.deleteCubes(r,u)}s[t][i]=p[o],this.in2dView&&this.drawSingleCell2dViewText(r,t,i)}h++,this.recalculateHeights(r),await sleep(this.animationTime)}this.updateCameraHeight(!0)}export{pak,pakInverse};