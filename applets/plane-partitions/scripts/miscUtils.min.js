import anime from"/scripts/anime.min.js";import{convertColor}from"/scripts/src/browser.min.js";async function showFloor(opacity=1){const t=[];return this.arrays.forEach(array=>{array.floor.forEach(row=>{row.forEach(floor=>{floor.material.forEach(material=>t.push(material))})})}),anime({targets:t,opacity:opacity,duration:this.animationTime/2,easing:"easeOutQuad"}).finished}function hideFloor(){return this.showFloor(0)}async function showWalls(opacity=1){this.wilsonHidden3.ctx._alpha=1,this.wilsonHidden3.ctx.clearRect(0,0,64,64),this.wilsonHidden3.ctx.fillStyle=convertColor(32,32,32,this.addWalls?this.wilsonHidden3.ctx._alpha:0),this.wilsonHidden3.ctx.fillRect(0,0,64,64),this.wilsonHidden3.ctx.fillStyle=convertColor(64,64,64,this.addWalls?this.wilsonHidden3.ctx._alpha:0),this.wilsonHidden3.ctx.fillRect(4,4,56,56),this.floorTexture.needsUpdate=!0,this.wilsonHidden4.ctx._alpha=1,this.wilsonHidden4.ctx.clearRect(0,0,64,64),this.wilsonHidden4.ctx.fillStyle=convertColor(32,32,32,this.addWalls?this.wilsonHidden4.ctx._alpha:0),this.wilsonHidden4.ctx.fillRect(0,0,64,64),this.wilsonHidden4.ctx.fillStyle=convertColor(64,64,64,this.addWalls?this.wilsonHidden4.ctx._alpha:0),this.wilsonHidden4.ctx.fillRect(4,4,56,56),this.floorTexture2.needsUpdate=!0,this.needNewFrame=!0;const t=[];return this.arrays.forEach(array=>{array.leftWall.concat(array.rightWall).forEach(row=>{row.forEach(floor=>{floor.material.forEach(material=>t.push(material))})})}),anime({targets:t,opacity:opacity,duration:this.animationTime/2,easing:"easeOutQuad"}).finished}function hideWalls(){return this.hideFloor(0)}function removeOutsideFloor(array){const r=[];var a=[];for(let i=0;i<array.footprint;i++)for(let t=array.footprint-1;0<=t&&0===array.numbers[i][t];t--)array.floor[i][t].material.forEach(material=>r.push(material)),a.push([i,t]);a.forEach(coordinates=>{array.floor[coordinates[0]][coordinates[1]].material.forEach(material=>material.dispose()),array.cubeGroup.remove(array.floor[coordinates[0]][coordinates[1]]),array.floor[coordinates[0]][coordinates[1]]=void 0}),this.in2dView&&this.drawAll2dViewText()}function recalculateHeights(array){array.height=0,array.numbers.forEach(row=>{row.forEach(entry=>{entry!==1/0&&(array.height=Math.max(entry,array.height))})}),array.size=Math.max(array.footprint,array.height),this.totalArrayHeight=0,this.arrays.forEach(array=>this.totalArrayHeight=Math.max(array.height,this.totalArrayHeight)),this.totalArraySize=Math.max(this.totalArrayFootprint,this.totalArrayHeight),this.totalArrayHeight!==this.oldTotalArrayHeight&&this.updateCameraHeight()}function drawAll2dViewText(){this.fontSize=this.wilsonNumbers.canvasWidth/(this.totalArrayFootprint+1);var t=Math.max((""+this.totalArrayHeight).length,2);this.wilsonNumbers.ctx.font=this.fontSize/t+"px monospace",this.wilsonNumbers.ctx.fillStyle=convertColor(255,255,255),this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight),this.arrays.forEach(array=>{for(let r=0;r<array.footprint;r++)for(let t=0;t<array.footprint;t++)array.floor[r][t]&&this.drawSingleCell2dViewText(array,r,t)})}function drawSingleCell2dViewText(array,row,col){var t,r=(this.totalArrayFootprint-array.footprint-1)/2,a=array.partialFootprintSum-array.footprint;this.wilsonNumbers.ctx.clearRect(this.fontSize*(col+a+1),this.fontSize*(row+r+1),this.fontSize,this.fontSize),array.numbers[row][col]===1/0||0===array.numbers[row][col]&&0===this.floorLightness||(t=this.wilsonNumbers.ctx.measureText(array.numbers[row][col]),this.wilsonNumbers.ctx.fillText(array.numbers[row][col],this.fontSize*(col+a+1)+(this.fontSize-t.width)/2,this.fontSize*(row+r+1)+(this.fontSize+t.actualBoundingBoxAscent-t.actualBoundingBoxDescent)/2))}export{showFloor,hideFloor,showWalls,hideWalls,removeOutsideFloor,recalculateHeights,drawAll2dViewText,drawSingleCell2dViewText};