import anime from"/scripts/anime.min.js";import{convertColor}from"/scripts/src/browser.min.js";async function showFloor(opacity=1){var t=[];for(const o of this.arrays)for(const i of o.floor)for(const r of i)for(const a of r.material)t.push(a);return anime({targets:t,opacity:opacity,duration:this.animationTime/2,easing:"easeOutQuad"}).finished}function hideFloor(){return this.showFloor(0)}async function showWalls(opacity=1){this.wilsonHidden3.ctx._alpha=1,this.wilsonHidden3.ctx.clearRect(0,0,64,64),this.wilsonHidden3.ctx.fillStyle=convertColor(32,32,32,this.addWalls?this.wilsonHidden3.ctx._alpha:0),this.wilsonHidden3.ctx.fillRect(0,0,64,64),this.wilsonHidden3.ctx.fillStyle=convertColor(64,64,64,this.addWalls?this.wilsonHidden3.ctx._alpha:0),this.wilsonHidden3.ctx.fillRect(4,4,56,56),this.floorTexture.needsUpdate=!0,this.wilsonHidden4.ctx._alpha=1,this.wilsonHidden4.ctx.clearRect(0,0,64,64),this.wilsonHidden4.ctx.fillStyle=convertColor(32,32,32,this.addWalls?this.wilsonHidden4.ctx._alpha:0),this.wilsonHidden4.ctx.fillRect(0,0,64,64),this.wilsonHidden4.ctx.fillStyle=convertColor(64,64,64,this.addWalls?this.wilsonHidden4.ctx._alpha:0),this.wilsonHidden4.ctx.fillRect(4,4,56,56),this.floorTexture2.needsUpdate=!0,this.needNewFrame=!0;var t=[];for(const o of this.arrays)for(const i of o.leftWall.concat(o.rightWall))for(const r of i)for(const a of r.material)t.push(a);return anime({targets:t,opacity:opacity,duration:this.animationTime/2,easing:"easeOutQuad"}).finished}function hideWalls(){return this.hideFloor(0)}function removeOutsideFloor(array){var o=[],i=[];for(let r=0;r<array.footprint;r++)for(let t=array.footprint-1;0<=t&&0===array.numbers[r][t];t--){for(const a of array.floor[r][t].material)o.push(a);i.push([r,t])}for(const t of i){for(const s of array.floor[t[0]][t[1]].material)s.dispose();array.cubeGroup.remove(array.floor[t[0]][t[1]]),array.floor[t[0]][t[1]]=void 0}this.in2dView&&this.drawAll2dViewText()}function recalculateHeights(array){array.height=0;for(const t of array.numbers)for(const o of t)o!==1/0&&(array.height=Math.max(o,array.height));array.size=Math.max(array.footprint,array.height),this.totalArrayHeight=0;for(const array of this.arrays)this.totalArrayHeight=Math.max(array.height,this.totalArrayHeight);this.totalArraySize=Math.max(this.totalArrayFootprint,this.totalArrayHeight),this.totalArrayHeight!==this.oldTotalArrayHeight&&this.updateCameraHeight()}function drawAll2dViewText(){this.fontSize=this.wilsonNumbers.canvasWidth/(this.totalArrayFootprint+1);var t=Math.max((""+this.totalArrayHeight).length,2);this.wilsonNumbers.ctx.font=this.fontSize/t+"px monospace",this.wilsonNumbers.ctx.fillStyle=convertColor(255,255,255),this.wilsonNumbers.ctx.clearRect(0,0,this.wilsonNumbers.canvasWidth,this.wilsonNumbers.canvasHeight);for(const i of this.arrays)for(let o=0;o<i.footprint;o++)for(let t=0;t<i.footprint;t++)i.floor[o][t]&&this.drawSingleCell2dViewText(i,o,t)}function drawSingleCell2dViewText(array,row,col){var t,o=(this.totalArrayFootprint-array.footprint-1)/2,i=array.partialFootprintSum-array.footprint;this.wilsonNumbers.ctx.clearRect(this.fontSize*(col+i+1),this.fontSize*(row+o+1),this.fontSize,this.fontSize),array.numbers[row][col]===1/0||0===array.numbers[row][col]&&0===this.floorLightness||(t=this.wilsonNumbers.ctx.measureText(array.numbers[row][col]),this.wilsonNumbers.ctx.fillText(array.numbers[row][col],this.fontSize*(col+i+1)+(this.fontSize-t.width)/2,this.fontSize*(row+o+1)+(this.fontSize+t.actualBoundingBoxAscent-t.actualBoundingBoxDescent)/2))}export{showFloor,hideFloor,showWalls,hideWalls,removeOutsideFloor,recalculateHeights,drawAll2dViewText,drawSingleCell2dViewText};