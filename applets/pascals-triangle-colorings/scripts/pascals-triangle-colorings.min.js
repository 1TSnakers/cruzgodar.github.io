!function(){"use strict";let e=20,t=0,n=10,r=0,o=2e3,l=3,c=0,i=[],a=[],u=[],s=[],f=-1,d=[],h=new Wilson(document.querySelector("#output-canvas"),{renderer:"cpu",canvas_width:2e3,canvas_height:2e3,use_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png"});document.querySelector("#generate-button").addEventListener("click",p);let g=document.querySelector("#resolution-input");g.addEventListener("keydown",e=>{13===e.keyCode&&p()});let y=document.querySelector("#triangle-size-input");y.addEventListener("keydown",e=>{13===e.keyCode&&p()});let _=document.querySelector("#num-colors-input");function p(){o=parseInt(g.value||2e3),h.change_canvas_size(o,o),n=Math.ceil(o/200),e=parseInt(y.value||20),t=Math.round(o/(e+2)),r=2*t,l=parseInt(_.value||3),c=(1-Math.sqrt(3)/2*(e+1)/(e+2))/2*o,d=[[0,0,0,0]],i=new Array(e),u=new Array(e),s=new Array(e);for(let t=0;t<e;t++){i[t]=new Array(e),u[t]=new Array(e),s[t]=new Array(e);for(let n=0;n<e;n++)s[t][n]=!1}i[0][0]=1,u[0][0]=h.utils.hsv_to_rgb(1/l,1,1),a=new Array(e);for(let t=0;t<e;t++)a[t]=new Array(e);for(let t=1;t<e;t++){i[t][0]=1,i[t][t]=1,u[t][0]=[...u[0][0]],u[t][t]=[...u[0][0]];for(let e=1;e<t;e++)i[t][e]=(i[t-1][e-1]+i[t-1][e])%l,u[t][e]=h.utils.hsv_to_rgb(i[t][e]/l,1,1)}for(let t=0;t<e;t++)for(let e=0;e<=t;e++)a[t][e]=v(t,e);h.ctx.fillStyle="rgb(0, 0, 0)",h.ctx.fillRect(0,0,o,o),h.ctx.lineWidth=10*Math.sqrt(t/150),window.requestAnimationFrame(w)}function w(o){let l=o-f;if(f=o,0!==l){for(let o=0;o<n;o++)for(let n=0;n<d.length;n++){if(0!==d[n][3]){d[n][3]--;continue}let o=d[n][2]/t,l=(d[n][2]+2)/t;if(h.ctx.strokeStyle=`rgb(${u[d[n][0]][d[n][1]][0]*(1-o)+u[d[n][0]+1][d[n][1]][0]*o}, ${u[d[n][0]][d[n][1]][1]*(1-o)+u[d[n][0]+1][d[n][1]][1]*o}, ${u[d[n][0]][d[n][1]][2]*(1-o)+u[d[n][0]+1][d[n][1]][2]*o})`,h.ctx.beginPath(),h.ctx.moveTo(a[d[n][0]][d[n][1]][0]*(1-o)+a[d[n][0]+1][d[n][1]][0]*o,a[d[n][0]][d[n][1]][1]*(1-o)+a[d[n][0]+1][d[n][1]][1]*o),h.ctx.lineTo(a[d[n][0]][d[n][1]][0]*(1-l)+a[d[n][0]+1][d[n][1]][0]*l,a[d[n][0]][d[n][1]][1]*(1-l)+a[d[n][0]+1][d[n][1]][1]*l),h.ctx.stroke(),h.ctx.strokeStyle=`rgb(${u[d[n][0]][d[n][1]][0]*(1-o)+u[d[n][0]+1][d[n][1]+1][0]*o}, ${u[d[n][0]][d[n][1]][1]*(1-o)+u[d[n][0]+1][d[n][1]+1][1]*o}, ${u[d[n][0]][d[n][1]][2]*(1-o)+u[d[n][0]+1][d[n][1]+1][2]*o})`,h.ctx.beginPath(),h.ctx.moveTo(a[d[n][0]][d[n][1]][0]*(1-o)+a[d[n][0]+1][d[n][1]+1][0]*o,a[d[n][0]][d[n][1]][1]*(1-o)+a[d[n][0]+1][d[n][1]+1][1]*o),h.ctx.lineTo(a[d[n][0]][d[n][1]][0]*(1-l)+a[d[n][0]+1][d[n][1]+1][0]*l,a[d[n][0]][d[n][1]][1]*(1-l)+a[d[n][0]+1][d[n][1]+1][1]*l),h.ctx.stroke(),d[n][2]++,d[n][2]===t-1){if(d[n][0]!==e-2){if(!s[d[n][0]+1][d[n][1]]){let e=!1;for(let t=0;t<d.length;t++)if(d[t][0]===d[n][0]+1&&d[t][1]===d[n][1]){e=!0,d[t][3]+=r;break}e||d.push([d[n][0]+1,d[n][1],0,0])}if(!s[d[n][0]+1][d[n][1]+1]){let e=!1;for(let t=0;t<d.length;t++)if(d[t][0]===d[n][0]+1&&d[t][1]===d[n][1]+1){e=!0,d[t][3]+=r;break}e||d.push([d[n][0]+1,d[n][1]+1,0,0])}}s[d[n][0]][d[n][1]]=!0,d.splice(n,1)}}0!==d.length&&window.requestAnimationFrame(w)}}function v(t,n){let r=(n-Math.floor(t/2))*o/(e+2)+o/2;return t%2==1&&(r-=.5*o/(e+2)),[r,(t+1)*Math.sqrt(3)/2*o/(e+2)+c]}_.addEventListener("keydown",e=>{13===e.keyCode&&p()}),document.querySelector("#download-button").addEventListener("click",()=>{h.download_frame("a-pascals-triangle-coloring.png")})}();