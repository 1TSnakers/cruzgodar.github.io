!function(){"use strict";let e=20,t=0,n=10,r=0,l=2e3,o=3,i=0,c=[],a=[],s=[],u=[],d=-1,f=[],p=null,g=new Wilson(document.querySelector("#output-canvas"),{renderer:"cpu",canvas_width:2e3,canvas_height:2e3,use_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png"});document.querySelector("#generate-button").addEventListener("click",w);let h=document.querySelector("#resolution-input");h.addEventListener("keydown",e=>{13===e.keyCode&&w()});let _=document.querySelector("#triangle-size-input");_.addEventListener("keydown",e=>{13===e.keyCode&&w()});let y=document.querySelector("#num-colors-input");function w(){p=Site.applet_process_id,l=parseInt(h.value||2e3),g.change_canvas_size(l,l),n=Math.ceil(l/200),e=parseInt(_.value||20),t=Math.round(l/(e+2)),r=2*t,o=parseInt(y.value||3),i=(1-Math.sqrt(3)/2*(e+1)/(e+2))/2*l,f=[[0,0,0,0]],c=new Array(e),s=new Array(e),u=new Array(e);for(let t=0;t<e;t++){c[t]=new Array(e),s[t]=new Array(e),u[t]=new Array(e);for(let n=0;n<e;n++)u[t][n]=!1}c[0][0]=1,s[0][0]=g.utils.hsv_to_rgb(1/o,1,1),a=new Array(e);for(let t=0;t<e;t++)a[t]=new Array(e);for(let t=1;t<e;t++){c[t][0]=1,c[t][t]=1,s[t][0]=[...s[0][0]],s[t][t]=[...s[0][0]];for(let e=1;e<t;e++)c[t][e]=(c[t-1][e-1]+c[t-1][e])%o,s[t][e]=g.utils.hsv_to_rgb(c[t][e]/o,1,1)}for(let t=0;t<e;t++)for(let e=0;e<=t;e++)a[t][e]=m(t,e);g.ctx.fillStyle="rgb(0, 0, 0)",g.ctx.fillRect(0,0,l,l),g.ctx.lineWidth=10*Math.sqrt(t/150),window.requestAnimationFrame(v)}function v(l){let o=l-d;if(d=l,0!==o){for(let l=0;l<n;l++)for(let n=0;n<f.length;n++){if(0!==f[n][3]){f[n][3]--;continue}let l=f[n][2]/t,o=(f[n][2]+2)/t;if(g.ctx.strokeStyle=`rgb(${s[f[n][0]][f[n][1]][0]*(1-l)+s[f[n][0]+1][f[n][1]][0]*l}, ${s[f[n][0]][f[n][1]][1]*(1-l)+s[f[n][0]+1][f[n][1]][1]*l}, ${s[f[n][0]][f[n][1]][2]*(1-l)+s[f[n][0]+1][f[n][1]][2]*l})`,g.ctx.beginPath(),g.ctx.moveTo(a[f[n][0]][f[n][1]][0]*(1-l)+a[f[n][0]+1][f[n][1]][0]*l,a[f[n][0]][f[n][1]][1]*(1-l)+a[f[n][0]+1][f[n][1]][1]*l),g.ctx.lineTo(a[f[n][0]][f[n][1]][0]*(1-o)+a[f[n][0]+1][f[n][1]][0]*o,a[f[n][0]][f[n][1]][1]*(1-o)+a[f[n][0]+1][f[n][1]][1]*o),g.ctx.stroke(),g.ctx.strokeStyle=`rgb(${s[f[n][0]][f[n][1]][0]*(1-l)+s[f[n][0]+1][f[n][1]+1][0]*l}, ${s[f[n][0]][f[n][1]][1]*(1-l)+s[f[n][0]+1][f[n][1]+1][1]*l}, ${s[f[n][0]][f[n][1]][2]*(1-l)+s[f[n][0]+1][f[n][1]+1][2]*l})`,g.ctx.beginPath(),g.ctx.moveTo(a[f[n][0]][f[n][1]][0]*(1-l)+a[f[n][0]+1][f[n][1]+1][0]*l,a[f[n][0]][f[n][1]][1]*(1-l)+a[f[n][0]+1][f[n][1]+1][1]*l),g.ctx.lineTo(a[f[n][0]][f[n][1]][0]*(1-o)+a[f[n][0]+1][f[n][1]+1][0]*o,a[f[n][0]][f[n][1]][1]*(1-o)+a[f[n][0]+1][f[n][1]+1][1]*o),g.ctx.stroke(),f[n][2]++,f[n][2]===t-1){if(f[n][0]!==e-2){if(!u[f[n][0]+1][f[n][1]]){let e=!1;for(let t=0;t<f.length;t++)if(f[t][0]===f[n][0]+1&&f[t][1]===f[n][1]){e=!0,f[t][3]+=r;break}e||f.push([f[n][0]+1,f[n][1],0,0])}if(!u[f[n][0]+1][f[n][1]+1]){let e=!1;for(let t=0;t<f.length;t++)if(f[t][0]===f[n][0]+1&&f[t][1]===f[n][1]+1){e=!0,f[t][3]+=r;break}e||f.push([f[n][0]+1,f[n][1]+1,0,0])}}u[f[n][0]][f[n][1]]=!0,f.splice(n,1)}}p===Site.applet_process_id?0!==f.length&&window.requestAnimationFrame(v):console.log("Terminated applet process")}}function m(t,n){let r=(n-Math.floor(t/2))*l/(e+2)+l/2;t%2==1&&(r-=.5*l/(e+2));let o=(t+1)*Math.sqrt(3)/2*l/(e+2)+i;return[.8*r+.1*l,.8*o+.1*l]}y.addEventListener("keydown",e=>{13===e.keyCode&&w()}),document.querySelector("#download-button").addEventListener("click",()=>{g.download_frame("a-pascals-triangle-coloring.png")})}();