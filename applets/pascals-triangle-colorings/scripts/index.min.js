!function(){"use strict";let e=20,t=0,_=10,n=0,l=2e3,o=3,r=0,i=[],c=[],s=[],a=[],u=-1,f=[],g=null,d=new Wilson($("#output-canvas"),{renderer:"cpu",canvasWidth:2e3,canvasHeight:2e3,useFullscreen:!0,useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"});$("#generate-button").addEventListener("click",k);let x=$("#resolution-input");x.addEventListener("keydown",e=>{13===e.keyCode&&k()});let h=$("#triangle-size-input");h.addEventListener("keydown",e=>{13===e.keyCode&&k()});let p=$("#num-colors-input");p.addEventListener("keydown",e=>{13===e.keyCode&&k()});function k(){g=Site.appletProcessId,l=parseInt(x.value||2e3),d.changeCanvasSize(l,l),_=Math.ceil(l/200),n=2*(t=Math.round(l/((e=parseInt(h.value||20))+2))),o=parseInt(p.value||3),r=(1-Math.sqrt(3)/2*(e+1)/(e+2))/2*l,f=[[0,0,0,0]],i=Array(e),s=Array(e),a=Array(e);for(let u=0;u<e;u++){i[u]=Array(e),s[u]=Array(e),a[u]=Array(e);for(let k=0;k<e;k++)a[u][k]=!1}i[0][0]=1,s[0][0]=d.utils.hsvToRgb(1/o,1,1),c=Array(e);for(let m=0;m<e;m++)c[m]=Array(e);for(let y=1;y<e;y++){i[y][0]=1,i[y][y]=1,s[y][0]=[...s[0][0]],s[y][y]=[...s[0][0]];for(let T=1;T<y;T++)i[y][T]=(i[y-1][T-1]+i[y-1][T])%o,s[y][T]=d.utils.hsvToRgb(i[y][T]/o,1,1)}for(let P=0;P<e;P++)for(let w=0;w<=P;w++)c[P][w]=b(P,w);d.ctx.fillStyle="rgb(0, 0, 0)",d.ctx.fillRect(0,0,l,l),d.ctx.lineWidth=10*Math.sqrt(t/150),window.requestAnimationFrame(v)}function v(l){let o=l-u;if(u=l,0!==o){for(let r=0;r<_;r++)for(let i=0;i<f.length;i++){if(0!==f[i][3]){f[i][3]--;continue}if(m(i),f[i][2]++,f[i][2]===t-1){if(f[i][0]!==e-2){if(!a[f[i][0]+1][f[i][1]]){let c=!1;for(let s=0;s<f.length;s++)if(f[s][0]===f[i][0]+1&&f[s][1]===f[i][1]){c=!0,f[s][3]+=n;break}c||f.push([f[i][0]+1,f[i][1],0,0])}if(!a[f[i][0]+1][f[i][1]+1]){let d=!1;for(let x=0;x<f.length;x++)if(f[x][0]===f[i][0]+1&&f[x][1]===f[i][1]+1){d=!0,f[x][3]+=n;break}!d&&f[i][1]+1<=(f[i][0]+1)/2&&f.push([f[i][0]+1,f[i][1]+1,0,0])}}a[f[i][0]][f[i][1]]=!0,f.splice(i,1)}}if(g!==Site.appletProcessId){console.log("Terminated applet process");return}0!==f.length&&window.requestAnimationFrame(v)}}function b(t,_){let n=(_-Math.floor(t/2))*l/(e+2)+l/2;t%2==1&&(n-=.5*l/(e+2));let o=(t+1)*Math.sqrt(3)/2*l/(e+2)+r;return[.8*n+.1*l,.8*o+.1*l]}function m(e){let _=f[e][2]/t,n=(f[e][2]+2)/t,l=f[e][0],o=f[e][1],r=l+1,i=o;d.ctx.strokeStyle=`rgb(${s[l][o][0]*(1-_)+s[r][i][0]*_}, ${s[l][o][1]*(1-_)+s[r][i][1]*_}, ${s[l][o][2]*(1-_)+s[r][i][2]*_})`,d.ctx.beginPath(),d.ctx.moveTo(c[l][o][0]*(1-_)+c[r][i][0]*_,c[l][o][1]*(1-_)+c[r][i][1]*_),d.ctx.lineTo(c[l][o][0]*(1-n)+c[r][i][0]*n,c[l][o][1]*(1-n)+c[r][i][1]*n),d.ctx.stroke(),i++,d.ctx.strokeStyle=`rgb(${s[l][o][0]*(1-_)+s[r][i][0]*_}, ${s[l][o][1]*(1-_)+s[r][i][1]*_}, ${s[l][o][2]*(1-_)+s[r][i][2]*_})`,d.ctx.beginPath(),d.ctx.moveTo(c[l][o][0]*(1-_)+c[r][i][0]*_,c[l][o][1]*(1-_)+c[r][i][1]*_),d.ctx.lineTo(c[l][o][0]*(1-n)+c[r][i][0]*n,c[l][o][1]*(1-n)+c[r][i][1]*n),d.ctx.stroke(),o=l-o,i=r-i,d.ctx.strokeStyle=`rgb(${s[l][o][0]*(1-_)+s[r][i][0]*_}, ${s[l][o][1]*(1-_)+s[r][i][1]*_}, ${s[l][o][2]*(1-_)+s[r][i][2]*_})`,d.ctx.beginPath(),d.ctx.moveTo(c[l][o][0]*(1-_)+c[r][i][0]*_,c[l][o][1]*(1-_)+c[r][i][1]*_),d.ctx.lineTo(c[l][o][0]*(1-n)+c[r][i][0]*n,c[l][o][1]*(1-n)+c[r][i][1]*n),d.ctx.stroke(),i++,d.ctx.strokeStyle=`rgb(${s[l][o][0]*(1-_)+s[r][i][0]*_}, ${s[l][o][1]*(1-_)+s[r][i][1]*_}, ${s[l][o][2]*(1-_)+s[r][i][2]*_})`,d.ctx.beginPath(),d.ctx.moveTo(c[l][o][0]*(1-_)+c[r][i][0]*_,c[l][o][1]*(1-_)+c[r][i][1]*_),d.ctx.lineTo(c[l][o][0]*(1-n)+c[r][i][0]*n,c[l][o][1]*(1-n)+c[r][i][1]*n),d.ctx.stroke()}$("#download-button").addEventListener("click",()=>{d.downloadFrame("a-pascals-triangle-coloring.png")}),Page.show()}();