!function(){"use strict";let e=20,t=0,_=10,$=0,n=2e3,l=3,r=0,o=[],c=[],i=[],s=[],u=-1,a=[],f=null,g=new Wilson($("#output-canvas"),{renderer:"cpu",canvasWidth:2e3,canvasHeight:2e3,useFullscreen:!0,useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"});$("#generate-button").addEventListener("click",p);let d=$("#resolution-input");d.addEventListener("keydown",e=>{13===e.keyCode&&p()});let x=$("#triangle-size-input");x.addEventListener("keydown",e=>{13===e.keyCode&&p()});let h=$("#num-colors-input");h.addEventListener("keydown",e=>{13===e.keyCode&&p()});function p(){f=Site.appletProcessId,n=parseInt(d.value||2e3),g.changeCanvasSize(n,n),_=Math.ceil(n/200),$=2*(t=Math.round(n/((e=parseInt(x.value||20))+2))),l=parseInt(h.value||3),r=(1-Math.sqrt(3)/2*(e+1)/(e+2))/2*n,a=[[0,0,0,0]],o=Array(e),i=Array(e),s=Array(e);for(let u=0;u<e;u++){o[u]=Array(e),i[u]=Array(e),s[u]=Array(e);for(let p=0;p<e;p++)s[u][p]=!1}o[0][0]=1,i[0][0]=g.utils.hsvToRgb(1/l,1,1),c=Array(e);for(let m=0;m<e;m++)c[m]=Array(e);for(let y=1;y<e;y++){o[y][0]=1,o[y][y]=1,i[y][0]=[...i[0][0]],i[y][y]=[...i[0][0]];for(let b=1;b<y;b++)o[y][b]=(o[y-1][b-1]+o[y-1][b])%l,i[y][b]=g.utils.hsvToRgb(o[y][b]/l,1,1)}for(let S=0;S<e;S++)for(let q=0;q<=S;q++)c[S][q]=v(S,q);g.ctx.fillStyle="rgb(0, 0, 0)",g.ctx.fillRect(0,0,n,n),g.ctx.lineWidth=10*Math.sqrt(t/150),window.requestAnimationFrame(k)}function k(n){let l=n-u;if(u=n,0!==l){for(let r=0;r<_;r++)for(let o=0;o<a.length;o++){if(0!==a[o][3]){a[o][3]--;continue}if(m(o),a[o][2]++,a[o][2]===t-1){if(a[o][0]!==e-2){if(!s[a[o][0]+1][a[o][1]]){let c=!1;for(let i=0;i<a.length;i++)if(a[i][0]===a[o][0]+1&&a[i][1]===a[o][1]){c=!0,a[i][3]+=$;break}c||a.push([a[o][0]+1,a[o][1],0,0])}if(!s[a[o][0]+1][a[o][1]+1]){let g=!1;for(let d=0;d<a.length;d++)if(a[d][0]===a[o][0]+1&&a[d][1]===a[o][1]+1){g=!0,a[d][3]+=$;break}!g&&a[o][1]+1<=(a[o][0]+1)/2&&a.push([a[o][0]+1,a[o][1]+1,0,0])}}s[a[o][0]][a[o][1]]=!0,a.splice(o,1)}}if(f!==Site.appletProcessId){console.log("Terminated applet process");return}0!==a.length&&window.requestAnimationFrame(k)}}function v(t,_){let $=(_-Math.floor(t/2))*n/(e+2)+n/2;t%2==1&&($-=.5*n/(e+2));let l=(t+1)*Math.sqrt(3)/2*n/(e+2)+r;return[.8*$+.1*n,.8*l+.1*n]}function m(e){let _=a[e][2]/t,$=(a[e][2]+2)/t,n=a[e][0],l=a[e][1],r=n+1,o=l;g.ctx.strokeStyle=`rgb(${i[n][l][0]*(1-_)+i[r][o][0]*_}, ${i[n][l][1]*(1-_)+i[r][o][1]*_}, ${i[n][l][2]*(1-_)+i[r][o][2]*_})`,g.ctx.beginPath(),g.ctx.moveTo(c[n][l][0]*(1-_)+c[r][o][0]*_,c[n][l][1]*(1-_)+c[r][o][1]*_),g.ctx.lineTo(c[n][l][0]*(1-$)+c[r][o][0]*$,c[n][l][1]*(1-$)+c[r][o][1]*$),g.ctx.stroke(),o++,g.ctx.strokeStyle=`rgb(${i[n][l][0]*(1-_)+i[r][o][0]*_}, ${i[n][l][1]*(1-_)+i[r][o][1]*_}, ${i[n][l][2]*(1-_)+i[r][o][2]*_})`,g.ctx.beginPath(),g.ctx.moveTo(c[n][l][0]*(1-_)+c[r][o][0]*_,c[n][l][1]*(1-_)+c[r][o][1]*_),g.ctx.lineTo(c[n][l][0]*(1-$)+c[r][o][0]*$,c[n][l][1]*(1-$)+c[r][o][1]*$),g.ctx.stroke(),l=n-l,o=r-o,g.ctx.strokeStyle=`rgb(${i[n][l][0]*(1-_)+i[r][o][0]*_}, ${i[n][l][1]*(1-_)+i[r][o][1]*_}, ${i[n][l][2]*(1-_)+i[r][o][2]*_})`,g.ctx.beginPath(),g.ctx.moveTo(c[n][l][0]*(1-_)+c[r][o][0]*_,c[n][l][1]*(1-_)+c[r][o][1]*_),g.ctx.lineTo(c[n][l][0]*(1-$)+c[r][o][0]*$,c[n][l][1]*(1-$)+c[r][o][1]*$),g.ctx.stroke(),o++,g.ctx.strokeStyle=`rgb(${i[n][l][0]*(1-_)+i[r][o][0]*_}, ${i[n][l][1]*(1-_)+i[r][o][1]*_}, ${i[n][l][2]*(1-_)+i[r][o][2]*_})`,g.ctx.beginPath(),g.ctx.moveTo(c[n][l][0]*(1-_)+c[r][o][0]*_,c[n][l][1]*(1-_)+c[r][o][1]*_),g.ctx.lineTo(c[n][l][0]*(1-$)+c[r][o][0]*$,c[n][l][1]*(1-$)+c[r][o][1]*$),g.ctx.stroke()}$("#download-button").addEventListener("click",()=>{g.downloadFrame("a-pascals-triangle-coloring.png")}),Page.show()}();