"use strict";let numVertices=null,gridSize=null,image=[],vertices=[],centerRow=null,centerCol=null,currentRow=null,currentCol=null,numPixelsAtMax=0;function drawChaosGame(){image=new Uint8ClampedArray(gridSize*gridSize*4);for(let r=0;r<gridSize;r++)for(let e=0;e<gridSize;e++)image[4*(gridSize*r+e)]=0,image[4*(gridSize*r+e)+1]=0,image[4*(gridSize*r+e)+2]=0,image[4*(gridSize*r+e)+3]=255;var e=2*Math.floor(numVertices/2)*Math.PI/numVertices,r=gridSize/2-gridSize/2.5,e=gridSize/2-gridSize/2.5*Math.cos(e),r=r+(gridSize-e);centerRow=Math.floor(r/2+gridSize/2.5),centerCol=Math.floor(gridSize/2),currentRow=centerRow,currentCol=centerCol,vertices=[];for(let e=0;e<numVertices;e++){var i=e/numVertices*2*Math.PI,t=Math.floor(-Math.cos(i)*gridSize/2.5+centerRow),i=Math.floor(Math.sin(i)*gridSize/2.5+centerCol);vertices.push([t,i])}let a=0;for(;;){a%(100*gridSize)==0&&postMessage([image]);var o=Math.floor(Math.random()*numVertices),o=(currentRow=Math.floor((currentRow+vertices[o][0])/2),currentCol=Math.floor((currentCol+vertices[o][1])/2),(Math.atan2(currentCol-gridSize/2,currentRow-gridSize/2)+Math.PI)/(2*Math.PI)),n=HSVtoRGB(o,((currentRow-gridSize/2)*(currentRow-gridSize/2)+(currentCol-gridSize/2)*(currentCol-gridSize/2))/(gridSize*gridSize/13),1);n[0]/=255,n[1]/=255,n[2]/=255;for(let e=0;e<3;e++)if(image[4*(gridSize*currentRow+currentCol)+e]+=8*n[e],255<=image[4*(gridSize*currentRow+currentCol)+e]&&(numPixelsAtMax++,image[4*(gridSize*currentRow+currentCol)+e]=255,.004<numPixelsAtMax/(gridSize*gridSize)))return void postMessage([image]);a++}}function HSVtoRGB(e,r,i){let t,a,o;var n=Math.floor(6*e),e=6*e-n,c=i*(1-r),g=i*(1-e*r),l=i*(1-(1-e)*r);switch(n%6){case 0:t=i,a=l,o=c;break;case 1:t=g,a=i,o=c;break;case 2:t=c,a=i,o=l;break;case 3:t=c,a=g,o=i;break;case 4:t=l,a=c,o=i;break;case 5:t=i,a=c,o=g}return[Math.round(255*t),Math.round(255*a),Math.round(255*o)]}onmessage=e=>{numVertices=e.data[0],gridSize=e.data[1],drawChaosGame()};