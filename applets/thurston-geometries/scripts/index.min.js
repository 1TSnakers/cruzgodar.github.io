import{ThurstonGeometry}from"./class.min.js";import{E3Axes,E3Rooms,E3Spheres}from"./geometries/e3.min.js";import{H2xEAxes,H2xERooms}from"./geometries/h2xe.min.js";import{H3Axes,H3Rooms,H3Spheres}from"./geometries/h3.min.js";import{NilAxes,NilRooms,NilSpheres}from"./geometries/nil.min.js";import{E3S2Demo,S2xES2Demo}from"./geometries/s2.min.js";import{S2xEAxes,S2xERooms,S2xESpheres}from"./geometries/s2xe.min.js";import{S3Axes,S3HopfFibration,S3Rooms,S3Spheres}from"./geometries/s3.min.js";import{SL2RAxes,SL2RRooms}from"./geometries/sl2r.min.js";import{SolAxes,SolRooms,SolSpheres}from"./geometries/sol.min.js";import{currentlyTouchDevice}from"/scripts/src/interaction.min.js";import{showPage}from"/scripts/src/load-page.min.js";import{$,$$}from"/scripts/src/main.min.js";function load(){const t=new ThurstonGeometry({canvas:$("#output-canvas")}),r=$("#demo-canvas"),a=$("#demo-canvas-container");let n;const m={"s2-dots":E3S2Demo,"e3-axes":E3Axes,"e3-rooms":E3Rooms,"e3-spheres":E3Spheres,"s3-axes":S3Axes,"s3-rooms":S3Rooms,"s3-spheres":S3Spheres,"s3-hopf-fibration":S3HopfFibration,"h3-axes":H3Axes,"h3-rooms":H3Rooms,"h3-spheres":H3Spheres,"s2xe-axes":S2xEAxes,"s2xe-rooms":S2xERooms,"s2xe-spheres":S2xESpheres,"h2xe-axes":H2xEAxes,"h2xe-rooms":H2xERooms,"sl2r-axes":SL2RAxes,"sl2r-rooms":SL2RRooms,"nil-axes":NilAxes,"nil-rooms":NilRooms,"nil-spheres":NilSpheres,"sol-axes":SolAxes,"sol-rooms":SolRooms,"sol-spheres":SolSpheres},i=$("#scene-selector-dropdown");window.DEBUG||$$("[data-option-name$=axes]").forEach(element=>element.style.display="none"),$(currentlyTouchDevice?"#controls-text-wasd":"#controls-text-touch").remove();const e={wallThickness:[$("#wall-thickness-slider"),$("#wall-thickness-slider-value")],fiberThickness:[$("#fiber-thickness-slider"),$("#fiber-thickness-slider-value")]},s=$("#resolution-input");t.setInputCaps([s],[1e3]),s.addEventListener("input",()=>{t.needNewFrame=!0;var e=parseInt(s.value||500);t.changeResolution(e)});for(const p in e)e[p][0].addEventListener("input",()=>{t.geometryData.sliderValues[p]=parseFloat(e[p][1].textContent),t.needNewFrame=!0});var o=$("#fov-slider");const l=$("#fov-slider-value");o.addEventListener("input",()=>{t.fov=Math.tan(parseFloat(l.textContent)/2*Math.PI/180),t.needNewFrame=!0}),$$(".slider-container").forEach(element=>element.style.display="none"),i.addEventListener("input",function(){var e,s,o="none"===i.value?E3Rooms:m[i.value];o===E3S2Demo?(t,$(".sliders").style.display="none",e=new E3S2Demo,void 0===n?(n=new ThurstonGeometry({canvas:r}),$$(".wilson-enter-fullscreen-button")[1].remove()):(n.animationPaused=!1,n.drawFrame()),e.handleMovingCallback=(movingAmount,timeElapsed)=>{n.handleMoving(movingAmount,timeElapsed),n.needNewFrame=!0},t.run(e),t.restrictCamera=!1,t.wilson.worldCenterY=Math.PI/4.5,t.wilson.worldCenterX=3*Math.PI/4,(e=new S2xES2Demo).drawFrameCallback=()=>{t.geometryData.cameraDotPos=[...n.geometryData.cameraPos];for(let s=0;s<t.geometryData.numRays;s++){var e=(s-Math.floor(t.geometryData.numRays/2))/t.geometryData.numRays*1.87;[t.geometryData.rayDirs[s],t.geometryData.testVecs[s]]=ThurstonGeometry.rotateVectors(n.geometryData.forwardVec,n.geometryData.rightVec,e),[t.geometryData.rayLengths,t.geometryData.rayColors]=n.geometryData.getRayData(t.geometryData.rayDirs)}t.needNewFrame=!0},n.run(e),n.wilson.worldCenterX=Math.PI/4,a.style.display="",a.querySelector(".wilson-applet-canvas-container").style.setProperty("margin-top","4px","important")):(t.restrictCamera=!0,e=new o,o=Array.from(e.uiElementsUsed?$$(e.uiElementsUsed):[]).map(element=>element.parentNode),s=Array.from(e.uiElementsUsed?$$(`.slider-container > input:not(#fov-slider, ${e.uiElementsUsed})`):$$(".slider-container > input:not(#fov-slider)")).map(element=>element.parentNode),o.forEach(element=>element.style.display=""),$(".sliders").style.display="",s.forEach(element=>element.style.display="none"),a.style.display="none",n&&(n.animationPaused=!0),t.run(e),e.initUI())}),$("#download-button").addEventListener("click",()=>{t.wilson.downloadFrame("a-thurston-geometry.png")}),showPage()}export{load};