"use strict";onmessage=async function(e){numVertices=e.data[0],numIterations=e.data[1],gridSize=e.data[2],maximumSpeed=e.data[3],await drawFiniteSubdivisions()};let numVertices=null,numIterations=null,currentIteration=null,gridSize=null,maximumSpeed=null,polygons=[];function drawFiniteSubdivisions(){return new Promise(async function(e,o){polygons=[[]],currentIteration=0;var n=2*Math.floor(numVertices/2)*Math.PI/numVertices,t=gridSize/2-gridSize/2.5,n=gridSize/2-gridSize/2.5*Math.cos(n),t=t+(gridSize-n),r=Math.floor(t/2+gridSize/2.5),s=Math.floor(gridSize/2);for(let e=0;e<numVertices;e++){var i=e/numVertices*2*Math.PI,a=Math.floor(-Math.cos(i)*gridSize/2.5+r),i=Math.floor(Math.sin(i)*gridSize/2.5+s);polygons[0].push([a,i])}await drawOuterPolygon();for(let e=0;e<numIterations;e++)await drawLines(calculateLines()),currentIteration++;e()})}function drawOuterPolygon(){return new Promise(async function(e,o){if(!1===maximumSpeed)for(let o=0;o<120;o++){for(let e=0;e<numVertices;e++){var n=HSVtoRGB((2*e+1)/(2*numVertices),1,1),n=`rgb(${n[0]}, ${n[1]}, ${n[2]})`;postMessage([polygons[0][e][0],polygons[0][e][1],polygons[0][e][0]+(o+1)/120*(polygons[0][(e+1)%numVertices][0]-polygons[0][e][0]),polygons[0][e][1]+(o+1)/120*(polygons[0][(e+1)%numVertices][1]-polygons[0][e][1]),n])}await sleep(8)}else for(let e=0;e<numVertices;e++){var t=HSVtoRGB((2*e+1)/(2*numVertices),1,1),t=`rgb(${t[0]}, ${t[1]}, ${t[2]})`;postMessage([polygons[0][e][0],polygons[0][e][1],polygons[0][(e+1)%numVertices][0],polygons[0][(e+1)%numVertices][1],t])}e()})}function calculateLines(){var r=[],s=[];for(let t=0;t<polygons.length;t++){let o=0,n=0;for(let e=0;e<polygons[t].length;e++)o+=polygons[t][e][0],n+=polygons[t][e][1];o/=polygons[t].length,n/=polygons[t].length;for(let e=0;e<polygons[t].length;e++)r.push([polygons[t][e],[o,n]]),s.push([[o,n],polygons[t][e],polygons[t][(e+1)%polygons[t].length]])}return polygons=s,r}function drawLines(r){return new Promise(async function(e,o){if(!1===maximumSpeed)for(let o=0;o<120;o++){for(let e=0;e<r.length;e++){var n=HSVtoRGB(e/(r.length-1),1,1),n=`rgb(${n[0]}, ${n[1]}, ${n[2]})`;postMessage([r[e][0][0],r[e][0][1],r[e][0][0]+(o+1)/120*(r[e][1][0]-r[e][0][0])+1,r[e][0][1]+(o+1)/120*(r[e][1][1]-r[e][0][1]),n])}await sleep(8)}else for(let e=0;e<r.length;e++){var t=HSVtoRGB(e/(r.length-1),1,1),t=`rgb(${t[0]}, ${t[1]}, ${t[2]})`;postMessage([r[e][0][0],r[e][0][1],r[e][1][0],r[e][1][1],t])}e()})}function sleep(n){return new Promise(function(e,o){setTimeout(e,n)})}function HSVtoRGB(e,o,n){let t,r,s,i,a,l,u,g;switch(l=n*(1-o),u=n*(1-(a=6*e-(i=Math.floor(6*e)))*o),g=n*(1-(1-a)*o),i%6){case 0:t=n,r=g,s=l;break;case 1:t=u,r=n,s=l;break;case 2:t=l,r=n,s=g;break;case 3:t=l,r=u,s=n;break;case 4:t=g,r=l,s=n;break;case 5:t=n,r=l,s=u}return[Math.round(255*t),Math.round(255*r),Math.round(255*s)]}