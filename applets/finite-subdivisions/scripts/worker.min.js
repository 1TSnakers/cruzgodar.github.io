"use strict";onmessage=e=>{numVertices=e.data[0],numIterations=e.data[1],gridSize=e.data[2],maximumSpeed=e.data[3],drawFiniteSubdivisions()};let numVertices=null,numIterations=null,gridSize=null,maximumSpeed=null,polygons=[];async function drawFiniteSubdivisions(){polygons=[[]];var e=2*Math.floor(numVertices/2)*Math.PI/numVertices,o=gridSize/2-gridSize/2.5,e=gridSize/2-gridSize/2.5*Math.cos(e),o=o+(gridSize-e),t=Math.floor(o/2+gridSize/2.5),n=Math.floor(gridSize/2);for(let e=0;e<numVertices;e++){var s=e/numVertices*2*Math.PI,r=Math.floor(-Math.cos(s)*gridSize/2.5+t),s=Math.floor(Math.sin(s)*gridSize/2.5+n);polygons[0].push([r,s])}await drawOuterPolygon();for(let e=0;e<numIterations;e++)await drawLines(calculateLines())}async function drawOuterPolygon(){if(maximumSpeed)for(let e=0;e<numVertices;e++){var o=HSVtoRGB((2*e+1)/(2*numVertices),1,1),o=`rgb(${o[0]}, ${o[1]}, ${o[2]})`;postMessage([polygons[0][e][0],polygons[0][e][1],polygons[0][(e+1)%numVertices][0],polygons[0][(e+1)%numVertices][1],o])}else for(let o=0;o<120;o++){for(let e=0;e<numVertices;e++){var t=HSVtoRGB((2*e+1)/(2*numVertices),1,1),t=`rgb(${t[0]}, ${t[1]}, ${t[2]})`;postMessage([polygons[0][e][0],polygons[0][e][1],polygons[0][e][0]+(o+1)/120*(polygons[0][(e+1)%numVertices][0]-polygons[0][e][0]),polygons[0][e][1]+(o+1)/120*(polygons[0][(e+1)%numVertices][1]-polygons[0][e][1]),t])}await new Promise(e=>setTimeout(e,8))}}function calculateLines(){var s=[],r=[];for(let n=0;n<polygons.length;n++){let o=0,t=0;for(let e=0;e<polygons[n].length;e++)o+=polygons[n][e][0],t+=polygons[n][e][1];o/=polygons[n].length,t/=polygons[n].length;for(let e=0;e<polygons[n].length;e++)s.push([polygons[n][e],[o,t]]),r.push([[o,t],polygons[n][e],polygons[n][(e+1)%polygons[n].length]])}return polygons=r,s}async function drawLines(t){if(!1===maximumSpeed)for(let o=0;o<120;o++){for(let e=0;e<t.length;e++){var n=HSVtoRGB(e/(t.length-1),1,1),n=`rgb(${n[0]}, ${n[1]}, ${n[2]})`;postMessage([t[e][0][0],t[e][0][1],t[e][0][0]+(o+1)/120*(t[e][1][0]-t[e][0][0])+1,t[e][0][1]+(o+1)/120*(t[e][1][1]-t[e][0][1]),n])}await new Promise(e=>setTimeout(e,8))}else for(let e=0;e<t.length;e++){var o=HSVtoRGB(e/(t.length-1),1,1),o=`rgb(${o[0]}, ${o[1]}, ${o[2]})`;postMessage([t[e][0][0],t[e][0][1],t[e][1][0],t[e][1][1],o])}}function HSVtoRGB(e,o,t){let n,s,r;var i=Math.floor(6*e),e=6*e-i,a=t*(1-o),l=t*(1-e*o),g=t*(1-(1-e)*o);switch(i%6){case 0:n=t,s=g,r=a;break;case 1:n=l,s=t,r=a;break;case 2:n=a,s=t,r=g;break;case 3:n=a,s=l,r=t;break;case 4:n=g,s=a,r=t;break;case 5:n=t,s=a,r=l}return[Math.round(255*n),Math.round(255*s),Math.round(255*r)]}