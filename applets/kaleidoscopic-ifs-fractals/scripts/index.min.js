import{KaleidoscopicIFSFractals}from"./class.min.js";import{getRotationMatrix}from"/scripts/applets/raymarchApplet.min.js";import{DownloadHighResButton}from"/scripts/components/buttons.min.js";import{Checkbox}from"/scripts/components/checkboxes.min.js";import{Dropdown}from"/scripts/components/dropdowns.min.js";import{Slider}from"/scripts/components/sliders.min.js";import{TextBox}from"/scripts/components/textBoxes.min.js";import{$}from"/scripts/src/main.min.js";import{typesetMath}from"/scripts/src/math.min.js";import{siteSettings}from"/scripts/src/settings.min.js";const minScale=1.125,minScaleEpsilon=3e-5,maxScaleEpsilon=3e-7;export default function(){const e=new TextBox({element:$("#resolution-input"),name:"Resolution",value:500,minValue:100,maxValue:1e3,onInput:function(){l.wilson.resizeCanvas({width:e.value*siteSettings.resolutionMultiplier})}}),n=new Slider({element:$("#rotation-angle-x-slider"),name:"$\\theta_x$",value:0,min:0,max:2*Math.PI,onInput:c}),t=new Slider({element:$("#rotation-angle-y-slider"),name:"$\\theta_y$",value:0,min:0,max:2*Math.PI,onInput:c}),a=new Slider({element:$("#rotation-angle-z-slider"),name:"$\\theta_z$",value:0,min:0,max:2*Math.PI,onInput:c}),o=new Dropdown({element:$("#polyhedra-dropdown"),name:"Polyhedra",options:{tetrahedron:"Tetrahedron",cube:"Cube",octahedron:"Octahedron",dodecahedron:"Dodecahedron",icosahedron:"Icosahedron"},onInput:function(){l.changePolyhedron(o.value)}}),s=new Slider({element:$("#scale-slider"),name:"Scale",value:2,min:minScale,max:8/3,snapPoints:[2],onInput:c}),i=new Checkbox({element:$("#lock-on-origin-checkbox"),name:"Lock on origin",checked:!0,onInput:m}),r=new Checkbox({element:$("#shadows-checkbox"),name:"Shadows",onInput:m}),l=new KaleidoscopicIFSFractals({canvas:$("#output-canvas"),shape:o.value||"octahedron"});function c(){var e=(s.value-minScale)/(2-minScale)*Math.log10(minScaleEpsilon/maxScaleEpsilon),o=Math.floor(44-12*(s.value-8/3)/(8/3-2));l.setUniforms({scale:s.value,minEpsilon:minScaleEpsilon/Math.pow(10,e),numIterations:o,rotationMatrix:getRotationMatrix(n.value,t.value,a.value)})}function m(){l.setLockedOnOrigin(i.checked),l.useShadows!==r.checked&&(l.useShadows=r.checked,l.reloadShader())}new DownloadHighResButton({element:$("#download-dropdown"),applet:l,filename:()=>"a-kaleidoscopic-ifs-fractal.png"}),typesetMath()}