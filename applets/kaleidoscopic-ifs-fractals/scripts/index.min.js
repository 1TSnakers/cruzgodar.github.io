import{showPage}from"../../../scripts/src/loadPage.min.js";import{KaleidoscopicIFSFractal}from"./class.min.js";import{DownloadButton}from"/scripts/src/buttons.min.js";import{showCard}from"/scripts/src/cards.min.js";import{Checkbox}from"/scripts/src/checkboxes.min.js";import{Dropdown}from"/scripts/src/dropdowns.min.js";import{$}from"/scripts/src/main.min.js";import{typesetMath}from"/scripts/src/math.min.js";import{siteSettings}from"/scripts/src/settings.min.js";import{Slider}from"/scripts/src/sliders.min.js";import{TextBox}from"/scripts/src/textBoxes.min.js";const minScale=1.15,minScaleEpsilon=6e-5,maxScaleEpsilon=3e-7;export default function(){const e=new TextBox({element:$("#resolution-input"),name:"Resolution",value:500,minValue:100,maxValue:1e3,onInput:function(){l.changeResolution(e.value*siteSettings.resolutionMultiplier)}}),o=new Slider({element:$("#rotation-angle-x-slider"),name:"$\\theta_x$",value:0,min:0,max:2*Math.PI,onInput:c}),n=new Slider({element:$("#rotation-angle-y-slider"),name:"$\\theta_y$",value:0,min:0,max:2*Math.PI,onInput:c}),t=new Slider({element:$("#rotation-angle-z-slider"),name:"$\\theta_z$",value:0,min:0,max:2*Math.PI,onInput:c}),a=new Dropdown({element:$("#polyhedra-dropdown"),name:"Polyhedra",options:{octahedron:"Octahedron",tetrahedron:"Tetrahedron",cube:"Cube"},onInput:function(){l.changePolyhedron(a.value)}}),s=new Slider({element:$("#scale-slider"),name:"Scale",value:2,min:minScale,max:2,onInput:c}),i=new Checkbox({element:$("#lock-on-origin-checkbox"),name:"Lock on origin",checked:!0,onInput:m}),r=new Checkbox({element:$("#shadows-checkbox"),name:"Shadows",onInput:m}),l=new KaleidoscopicIFSFractal({canvas:$("#output-canvas"),shape:a.value||"octahedron"});function c(){l.setUniform("scale",s.value);var e=(s.value-minScale)/(2-minScale)*Math.log10(minScaleEpsilon/maxScaleEpsilon);l.setMinEpsilon(minScaleEpsilon/Math.pow(10,e)),l.rotationAngleX=o.value,l.rotationAngleY=n.value,l.rotationAngleZ=t.value,l.updateMatrices()}function m(){l.setLockedOnOrigin(i.checked),l.useShadows!==r.checked&&(l.useShadows=r.checked,l.reloadShader())}l.addHelpButton(()=>showCard("raymarch-controls")),new DownloadButton({element:$("#download-button"),wilson:l.wilson,filename:"a-kaleidoscopic-ifs-fractal.png"}),typesetMath(),showPage()}