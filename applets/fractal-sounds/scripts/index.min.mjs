import { showPage } from "/scripts/src/load-page.mjs"
import{FractalSounds}from"./class.min.mjs";function load(){const s=new FractalSounds($("#output-canvas"),$("#line-drawer-canvas"));function t(){var t=c[u.value][0],a=c[u.value][1],e=parseInt(r.value||500),n=parseFloat(z.value||1),o=parseInt(i.value||200);s.run(t,a,e,n,o)}s.loadPromise.then(()=>t());const c={mandelbrot:["cmul(z, z) + c",(t,a,e,n)=>[t*t-a*a+e,2*t*a+n]],sfx:["cmul(z, dot(z, z)) - cmul(z, c*c)",(t,a,e,n)=>[t*t*t+t*a*a-t*e*e+a*n*n,t*t*a-t*n*n+a*a*a-a*e*e]],"burning-ship":["-vec2(z.x * z.x - z.y * z.y, 2.0 * abs(z.x * z.y)) + c",(t,a,e,n)=>[-(t*t-a*a)+e,-2*Math.abs(t*a)+n]],feather:["cdiv(cmul(cmul(z, z), z), ONE + z*z) + c",(t,a,e,n)=>[e+(t*t*t*t*t+t*t*t*(1-3*a*a)+3*t*t*a*a*a-3*t*a*a-a*a*a*a*a)/(t*t*t*t+2*t*t+a*a*a*a+1),n+a*(3*t*t*t*t-t*t*t*a-t*t*(a*a-3)+3*t*a*a*a-a*a)/(t*t*t*t+2*t*t+a*a*a*a+1)]],duffing:["vec2(z.y, -c.y * z.x + c.x * z.y - z.y * z.y * z.y)",(t,a,e,n)=>[a,-n*t+e*a-a*a*a]],ikeda:["vec2(1.0 + c.x * (z.x * cos(.4 - 6.0 / (1.0 + dot(z, z))) - z.y * sin(.4 - 6.0 / (1.0 + dot(z, z)))), c.y * (z.x * sin(.4 - 6.0 / (1.0 + dot(z, z))) + z.y * cos(.4 - 6.0 / (1.0 + dot(z, z)))))",(t,a,e,n)=>[1+e*(t*Math.cos(.4-6/(1+t*t+a*a))-a*Math.sin(.4-6/(1+t*t+a*a))),n*(t*Math.sin(.4-6/(1+t*t+a*a))+a*Math.cos(.4-6/(1+t*t+a*a)))]]},u=$("#fractal-selector-dropdown"),r=(u.addEventListener("input",t),$("#resolution-input")),z=$("#exposure-input"),i=$("#num-iterations-input");s.setInputCaps([r,i],[2e3,500]),r.addEventListener("input",()=>{s.resolution=parseInt(r.value||500),s.changeAspectRatio(!0)}),z.addEventListener("input",()=>{s.exposure=parseFloat(z.value||1)}),i.addEventListener("input",()=>{s.numIterations=parseInt(i.value||200)}),$("#download-button").addEventListener("click",()=>{s.wilson.downloadFrame("a-sound-fractal.png")}),showPage()}export{load};