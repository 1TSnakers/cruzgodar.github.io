!function(){"use strict";let t=null,e=null,n=1,r=1,o=[],a=500,i=100,l=0,_=0,d=0,c=0,w=0,h=0,s=0,u=0;const m=.96,f=.005,g=5e-4,p=.93,v=.01,x=.001;let M=-1,y=document.querySelector("#generating-string-input");document.querySelector("#generate-button").addEventListener("click",q);let b=document.querySelector("#resolution-input");b.addEventListener("input",()=>{a=parseInt(b.value||500),t.change_canvas_size(a,a),window.requestAnimationFrame(C)}),document.querySelector("#download-button").addEventListener("click",()=>{t.download_frame("a-lyapunov-fractal.png")});let z=document.querySelector("#canvas-location");function q(){let n=(y.value||"AB").toUpperCase(),a=[];for(let t=0;t<n.length;t++)"B"===n[t]?a.push(1):a.push(0);let i=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float brightness_scale;\n\t\t\t\n\t\t\tuniform int seq[12];\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat x = .5;\n\t\t\t\t\n\t\t\t\tfloat lambda = 0.0;\n\t\t\t\t\n\t\t\t\tvec3 color = vec3(0.0, 0.0, 0.0);\n\t\t\t\t\n\t\t\t\tfor (int iteration = 0; iteration < ${Math.floor(250/n.length)}; iteration++)\n\t\t\t\t{\n\t\t\t\t\tfor (int index = 0; index < ${n.length}; index++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (seq[index] == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tx = z.x * x * (1.0 - x);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcolor.x += abs(z.x) / 40.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tx = z.y * x * (1.0 - x);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcolor.y += abs(z.y) / 40.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tlambda += log(abs(1.0 - 2.0*x));\n\t\t\t\t\t\t\n\t\t\t\t\t\tcolor.z = -lambda / 100.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlambda /= 10000.0;\n\t\t\t\t\n\t\t\t\tif (lambda <= 0.0)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(-lambda / brightness_scale * color, 1.0);\n\t\t\t\t\t\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t`,l={renderer:"gpu",shader:i,canvas_width:500,canvas_height:500,world_width:4,world_height:4,world_center_x:2,world_center_y:2,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:W,mousedown_callback:k,touchstart_callback:k,mousedrag_callback:A,touchmove_callback:A,mouseup_callback:F,touchend_callback:F,wheel_callback:S,pinch_callback:L},_={renderer:"gpu",shader:i,canvas_width:100,canvas_height:100};try{t.output_canvas_container.parentNode.remove(),e.output_canvas_container.parentNode.remove(),z.insertAdjacentHTML("beforebegin",'\n\t\t\t\t<div>\n\t\t\t\t\t<canvas id="output-canvas" class="output-canvas"></canvas>\n\t\t\t\t\t<canvas id="hidden-canvas" class="hidden-canvas"></canvas>\n\t\t\t\t</div>\n\t\t\t')}catch(t){}(t=new Wilson(document.querySelector("#output-canvas"),l)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","brightness_scale","seq"]),(e=new Wilson(document.querySelector("#hidden-canvas"),_)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","brightness_scale","seq"]),o=[],r=.415,d=0,c=0,w=0,h=0,s=0,u=0,t.gl.uniform1f(t.uniforms.aspect_ratio,1),e.gl.uniform1f(e.uniforms.aspect_ratio,1),t.gl.uniform1iv(t.uniforms.seq,a),e.gl.uniform1iv(e.uniforms.seq,a),window.requestAnimationFrame(C)}function k(t,e,n){h=0,s=0,u=0,d=0,c=0,w=0}function A(e,n,r,o,a){t.world_center_x-=r,t.world_center_y-=o,t.world_center_x=Math.min(Math.max(t.world_center_x,t.world_width/2),4-t.world_width/2),t.world_center_y=Math.min(Math.max(t.world_center_y,t.world_height/2),4-t.world_height/2),d=-r,c=-o,window.requestAnimationFrame(C)}function F(e,n,r){Math.sqrt(d*d+c*c)>=f*Math.min(t.world_width,t.world_height)&&(h=d,s=c),Math.abs(w)>=v&&(u=w),window.requestAnimationFrame(C)}function S(t,e,n,o){l=t,_=e,Math.abs(n/100)<.3?r+=n/100:u+=.05*Math.sign(n),r=Math.min(r,.415),E()}function L(e,o,a,i){n>=1?(r-=a/t.world_width*10,w=-a/t.world_width*10):(r-=a/t.world_height*10,w=-a/t.world_height*10),r=Math.min(r,.415),l=e,_=o,E()}function E(){if(n<1){let e=t.input.get_zoomed_world_center(l,_,3*Math.pow(2,r)*n,3*Math.pow(2,r));t.world_width=3*Math.pow(2,r)*n,t.world_height=3*Math.pow(2,r),t.world_center_x=e[0],t.world_center_y=e[1]}else{let e=t.input.get_zoomed_world_center(l,_,3*Math.pow(2,r),3*Math.pow(2,r)/n);t.world_width=3*Math.pow(2,r),t.world_height=3*Math.pow(2,r)/n,t.world_center_x=e[0],t.world_center_y=e[1]}t.world_center_x=Math.min(Math.max(t.world_center_x,t.world_width/2),4-t.world_width/2),t.world_center_y=Math.min(Math.max(t.world_center_y,t.world_height/2),4-t.world_height/2),window.requestAnimationFrame(C)}function C(a){let l=a-M;if(M=a,0===l)return;e.gl.uniform1f(e.uniforms.aspect_ratio,n),e.gl.uniform1f(e.uniforms.world_center_x,t.world_center_x),e.gl.uniform1f(e.uniforms.world_center_y,t.world_center_y),e.gl.uniform1f(e.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),e.gl.uniform1f(e.uniforms.brightness_scale,20),e.render.draw_frame();let _=e.render.get_pixel_data(),d=new Array(i*i);for(let t=0;t<i*i;t++)d[t]=_[4*t]+_[4*t+1]+_[4*t+2];d.sort((t,e)=>t-e);let c=(d[Math.floor(i*i*.96)]+d[Math.floor(i*i*.98)])/255*6;o.push(c);let w=o.length;w>10&&o.shift(),c=Math.max(o.reduce((t,e)=>t+e)/w,.5),t.gl.uniform1f(t.uniforms.aspect_ratio,n),t.gl.uniform1f(t.uniforms.world_center_x,t.world_center_x),t.gl.uniform1f(t.uniforms.world_center_y,t.world_center_y),t.gl.uniform1f(t.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),t.gl.uniform1f(t.uniforms.brightness_scale,c),t.render.draw_frame(),0===h&&0===s&&0===u||(t.world_center_x+=h,t.world_center_y+=s,h*=m,s*=m,Math.sqrt(h*h+s*s)<g*Math.min(t.world_width,t.world_height)&&(h=0,s=0),r+=u,r=Math.min(r,.415),E(),u*=p,Math.abs(u)<x&&(u=0),t.world_center_x=Math.min(Math.max(t.world_center_x,t.world_width/2),4-t.world_width/2),t.world_center_y=Math.min(Math.max(t.world_center_y,t.world_height/2),4-t.world_height/2),window.requestAnimationFrame(C))}function W(){t.fullscreen.currently_fullscreen?(n=window.innerWidth/window.innerHeight)>=1?(t.change_canvas_size(a,Math.floor(a/n)),t.world_width=3*Math.pow(2,r),t.world_height=3*Math.pow(2,r)/n):(t.change_canvas_size(Math.floor(a*n),a),t.world_width=3*Math.pow(2,r)*n,t.world_height=3*Math.pow(2,r)):(n=1,t.change_canvas_size(a,a),t.world_width=3*Math.pow(2,r),t.world_height=3*Math.pow(2,r)),t.world_center_x=Math.min(Math.max(t.world_center_x,t.world_width/2),4-t.world_width/2),t.world_center_y=Math.min(Math.max(t.world_center_y,t.world_height/2),4-t.world_height/2),window.requestAnimationFrame(C)}q(),window.addEventListener("resize",W),Page.temporary_handlers.resize.push(W)}();