"use strict";onmessage=async function(e){await draw_julia_set(...e.data)};let image=[];function draw_julia_set(e,t,a,r){return new Promise(function(s,o){image=[];for(let e=0;e<a;e++)image[e]=[];let i=Math.floor(a/20);for(let s=0;s<a/2;s++)julia_row(s,e,t,a,r),s%i==0&&postMessage(["progress",s/i*10]);postMessage(["progress",100]);let n=image.flat().sort(function(e,t){return e-t}),g=n[Math.round(.9999*n.length)-1];for(let e=0;e<a;e++)image[e]=image[e].map(e=>e/g*255);postMessage([image]),s()})}function julia_row(e,t,a,r,s){for(let o=0;o<r+1;o++){let i=(o-r/2)/r*4,n=-(e-r/2)/r*4,g=Math.exp(-Math.sqrt(i*i+n*n)),l=0;for(l=0;l<s;l++){let e=2*i*n+a;if(i=i*i-n*n+t,n=e,g+=Math.exp(-Math.sqrt(i*i+n*n)),i*i+n*n>4)break}l===s&&(g=0),image[e][o]=g,image[r-e-1][r-o]=g}}