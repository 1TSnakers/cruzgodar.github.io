!function(){let small_canvas_size=0,large_canvas_size=0,small_julia_size=75,large_julia_size=500,small_julia_iterations=25,large_julia_iterations=50,full_res_julia_iterations=100,image=[],mandelbrot_position={left:0,top:0},persist_image=!1,ctx=null;function draw_julia_set(e,t,l,a,o){image=[];for(let e=0;e<l;e++)image[e]=[];let r=null,n=0;0==o?(document.querySelector("#julia-set").setAttribute("width",l),document.querySelector("#julia-set").setAttribute("height",l),r=document.querySelector("#julia-set").getContext("2d"),n=small_canvas_size):(document.querySelector("#high-res-julia-set").setAttribute("width",l),document.querySelector("#high-res-julia-set").setAttribute("height",l),r=document.querySelector("#high-res-julia-set").getContext("2d"),n=large_canvas_size);for(let o=0;o<l/2;o++)julia_row(o,e,t,l,a);let i=image.flat().sort(function(e,t){return e-t}),u=0;u=l==small_julia_size?i[Math.round(.9965*i.length)-1]:i[Math.round(.9999*i.length)-1];for(let e=0;e<l;e++)for(let t=0;t<l;t++)image[e][t]=image[e][t]/u*255,r.fillStyle="rgb(0,"+image[e][t]+","+image[e][t]+")",r.fillRect(t,e,1,1);r.scale(n/l,n/l),o&&prepare_download(e,t)}function julia_row(e,t,l,a,o){for(let r=0;r<a;r++){let n=(r-a/2)/a*4,i=-(e-a/2)/a*4,u=Math.exp(-Math.sqrt(n*n+i*i)),s=0;for(s=0;s<o;s++){let e=2*n*i+l;if(n=n*n-i*i+t,i=e,u+=Math.exp(-Math.sqrt(n*n+i*i)),Math.sqrt(n*n+i*i)>2)break}s==o&&(u=0),image[e][r]=u,image[a-e-1][a-r]=u}}function prepare_download(e,t){try{document.querySelector("#download-button").style.opacity=0}catch(e){}setTimeout(function(){try{document.querySelector("#download-button").remove()}catch(e){}let l=document.querySelector("#high-res-julia-set").toDataURL(),a="";0!=e?(a=document.querySelector("#a-input").value,t>0?a+=" + "+document.querySelector("#b-input").value+"i":t<0&&(a+=" - "+document.querySelector("#b-input").value.substr(1)+"i")):a=0!=t?document.querySelector("#b-input").value+"i":"0",document.querySelector("#download-location").insertAdjacentHTML("afterend",`\n\t\t\t<div id="download-button" class="animated-opacity" style="display: flex; justify-content: center; opacity: 0; width: 70vw; margin: 0 auto">\n\t\t\t\t<a href="${l}" download="${a}.png" class="real-link">\n\t\t\t\t\t<button class="text-button" type="button" onclick="">Download Image</button>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t`),document.querySelector("#download-button").style.opacity=1},300)}function draw_high_res_julia(){draw_julia_set(parseFloat(document.querySelector("#a-input").value)||0,parseFloat(document.querySelector("#b-input").value)||0,parseFloat(document.querySelector("#dim-input").value)||1e3,full_res_julia_iterations,!0)}function adjust_for_settings(){1==url_vars.contrast&&(1==url_vars.theme?(document.querySelector("#mandelbrot-set").style.borderColor="rgb(192, 192, 192)",document.querySelector("#julia-set").style.borderColor="rgb(192, 192, 192)",document.querySelector("#high-res-julia-set").style.borderColor="rgb(192, 192, 192)"):(document.querySelector("#mandelbrot-set").style.borderColor="rgb(64, 64, 64)",document.querySelector("#julia-set").style.borderColor="rgb(64, 64, 64)",document.querySelector("#high-res-julia-set").style.borderColor="rgb(64, 64, 64)"))}function init_listeners_no_touch(){document.querySelector("#mandelbrot-set").addEventListener("mousemove",function(e){if(0==persist_image){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,l=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;draw_julia_set(3*(t/small_canvas_size-.5)-.75,3*((small_canvas_size-l)/small_canvas_size-.5),small_julia_size,small_julia_iterations,!1)}}),document.querySelector("#mandelbrot-set").addEventListener("click",function(e){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,l=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top,a=3*(t/small_canvas_size-.5)-.75,o=3*((small_canvas_size-l)/small_canvas_size-.5);draw_julia_set(a,o,large_julia_size,large_julia_iterations,!1),document.querySelector("#a-input").value=Math.round(1e6*a)/1e6,document.querySelector("#b-input").value=Math.round(1e6*o)/1e6,document.querySelector("#dim-input").value=1e3,persist_image=!0}),document.querySelector("#mandelbrot-set").addEventListener("mouseleave",function(e){persist_image=!1})}function init_listeners_touch(){let e=0,t=0;document.querySelector("#instructions").innerHTML='Drag along the Mandelbrot set to preview the corresponding Julia set, and release to generate a higher-resolution image. For more information on Mandelbrot and Julia sets, have a look at <a href="/blog/4/a-taste-of-chaos.html" onclick="redirect(\'/blog/4/a-taste-of-chaos.html\')">this blog post</a>.',document.querySelector("#instructions a").addEventListener("click",function(e){e.preventDefault()}),document.querySelector("#mandelbrot-set").addEventListener("touchmove",function(l){l.preventDefault();let a=l.touches[0].clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,o=l.touches[0].clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;e=a,t=o,draw_julia_set(3*(a/small_canvas_size-.5)-.75,3*((small_canvas_size-o)/small_canvas_size-.5),small_julia_size,small_julia_iterations,!1)},!1),document.querySelector("#mandelbrot-set").addEventListener("touchend",function(l){l.preventDefault();let a=3*(e/small_canvas_size-.5)-.75,o=3*((small_canvas_size-t)/small_canvas_size-.5);draw_julia_set(a,o,large_julia_size,large_julia_iterations,!1),document.querySelector("#a-input").value=Math.round(1e6*a)/1e6,document.querySelector("#b-input").value=Math.round(1e6*o)/1e6,document.querySelector("#dim-input").value=1e3},!1)}function julia_resize(){small_canvas_size=document.querySelector("#julia-set").offsetWidth,large_canvas_size=document.querySelector("#high-res-julia-set").offsetWidth}adjust_for_settings(),document.querySelector("#generate-button").addEventListener("click",draw_high_res_julia),small_canvas_size=document.querySelector("#julia-set").offsetWidth,large_canvas_size=document.querySelector("#high-res-julia-set").offsetWidth,window.addEventListener("resize",julia_resize),temporary_handlers.resize.push(julia_resize),setTimeout(julia_resize,1e3),hasTouch()?init_listeners_touch():init_listeners_no_touch();}()