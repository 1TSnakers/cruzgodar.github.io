!function(){"use strict";let t=0,e=0,n=1e3,o=100,r=10,u=0,i=0,a=1e3,l=!1,c=!1,s=!0,d=document.querySelector("#julia-set").getContext("webgl");document.querySelector("#julia-set").setAttribute("width",a),document.querySelector("#julia-set").setAttribute("height",a),function(){1===url_vars.contrast&&(1===url_vars.theme?(document.querySelector("#mandelbrot-set").style.borderColor="rgb(192, 192, 192)",document.querySelector("#julia-set").style.borderColor="rgb(192, 192, 192)"):(document.querySelector("#mandelbrot-set").style.borderColor="rgb(64, 64, 64)",document.querySelector("#julia-set").style.borderColor="rgb(64, 64, 64)"));currently_touch_device&&(document.querySelector("#instructions").innerHTML="Just drag along the Mandelbrot set to see the corresponding Julia set.")}(),document.querySelector("#generate-button").addEventListener("click",y);let m=document.querySelectorAll("#a-input, #b-input, #dim-input");for(let t=0;t<m.length;t++)m[t].addEventListener("keydown",(function(t){13===t.keyCode&&y()}));document.querySelector("#download-button").addEventListener("click",(function(){let n=document.createElement("a");n.download=e<0?t+" - "+-e+"i.png":t+" + "+e+"i.png";n.href=document.querySelector("#output-canvas").toDataURL(),n.click(),n.remove()})),u=document.querySelector("#julia-set").offsetWidth,i=document.querySelector("#output-canvas").offsetWidth,window.addEventListener("resize",v),temporary_handlers.resize.push(v),setTimeout(v,1e3);let f=null;function g(){let t=h(d,d.VERTEX_SHADER,"\n\t\tattribute vec3 position;\n\t\tvarying vec2 uv;\n\n\t\tvoid main(void)\n\t\t{\n\t\t\tgl_Position = vec4(position, 1.0);\n\n\t\t\t//Interpolate quad coordinates in the fragment shader.\n\t\t\tuv = position.xy;\n\t\t}\n\t"),e=h(d,d.FRAGMENT_SHADER,"\n\t\tprecision highp float;\n\t\t\n\t\tvarying vec2 uv;\n\t\t\n\t\tconst float box_size_halved = 2.0;\n\t\tuniform float a;\n\t\tuniform float b;\n\t\tuniform float brightness_scale;\n\t\tuniform int num_iterations;\n\t\t\n\t\t\n\t\t\n\t\tvoid main(void)\n\t\t{\n\t\t\tvec2 z = vec2(uv.x * box_size_halved, uv.y * box_size_halved);\n\t\t\tfloat brightness = exp(-length(z));\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfor (int iteration = 0; iteration < 201; iteration++)\n\t\t\t{\n\t\t\t\tif (iteration == num_iterations)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (length(z) >= 2.0)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tz = vec2(z.x * z.x - z.y * z.y + a, 2.0 * z.x * z.y + b);\n\t\t\t\t\n\t\t\t\tbrightness += exp(-length(z));\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tgl_FragColor = vec4(0.0, brightness / brightness_scale, brightness / brightness_scale, 1.0);\n\t\t}\n\t");f=d.createProgram(),d.attachShader(f,t),d.attachShader(f,e),d.linkProgram(f),d.getProgramParameter(f,d.LINK_STATUS)||(console.log("Couldn't link shader program: "+d.getShaderInfoLog(shader)),d.deleteProgram(f)),d.useProgram(f);let o=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,o),d.bufferData(d.ARRAY_BUFFER,new Float32Array([-1,-1,0,-1,1,0,1,-1,0,1,1,0]),d.STATIC_DRAW),f.position_attribute=d.getAttribLocation(f,"position"),d.enableVertexAttribArray(f.position_attribute),d.vertexAttribPointer(f.position_attribute,3,d.FLOAT,!1,0,0),f.a_uniform=d.getUniformLocation(f,"a"),f.b_uniform=d.getUniformLocation(f,"b"),f.num_iterations_uniform=d.getUniformLocation(f,"num_iterations"),f.brightness_scale_uniform=d.getUniformLocation(f,"brightness_scale"),d.viewport(0,0,n,n)}function h(t,e,n){let o=t.createShader(e);return t.shaderSource(o,n),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)||(console.log("Couldn't load shader: "+t.getProgramInfoLog(shaderProgram)),t.deleteShader(o)),o}function b(){d.uniform1f(f.a_uniform,t),d.uniform1f(f.b_uniform,e),d.uniform1i(f.num_iterations_uniform,o),d.uniform1f(f.brightness_scale_uniform,r),d.drawArrays(d.TRIANGLE_STRIP,0,4);let u=new Uint8Array(n*n*4);d.readPixels(0,0,n,n,d.RGBA,d.UNSIGNED_BYTE,u);let i=0;for(let t=0;t<n*n;t++){255===u[4*t+1]&&i++}i<.1*n?r-=.5:i>.2*n&&(r+=.5),c?(c=!1,window.requestAnimationFrame(b)):s=!0}function y(){t=parseFloat(document.querySelector("#a-input").value||0),e=parseFloat(document.querySelector("#b-input").value||1),n=parseFloat(document.querySelector("#dim-input").value)||1e3,document.querySelector("#julia-set").setAttribute("width",n),document.querySelector("#julia-set").setAttribute("height",n),d.viewport(0,0,n,n),o=200,document.querySelector("#output-canvas").setAttribute("width",n),document.querySelector("#output-canvas").setAttribute("height",n),b(),document.querySelector("#output-canvas").getContext("2d").drawImage(document.querySelector("#julia-set"),0,0)}function v(){u=document.querySelector("#julia-set").offsetWidth,i=document.querySelector("#output-canvas").offsetWidth}load_script("/scripts/gl-matrix.min.js").then((function(){setTimeout(g,500)})),document.querySelector("#mandelbrot-set").addEventListener("mouseenter",(function(t){l=!1,document.querySelector("#julia-set").setAttribute("width",a),document.querySelector("#julia-set").setAttribute("height",a),d.viewport(0,0,a,a),n=a,o=100})),document.querySelector("#mandelbrot-set").addEventListener("mousemove",(function(n){if(!1===l){let o=n.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,r=n.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;t=3*(o/u-.5)-.75,e=3*((u-r)/u-.5),c=!0,s&&(s=!1,window.requestAnimationFrame(b))}})),document.querySelector("#mandelbrot-set").addEventListener("click",(function(n){l=!0,document.querySelector("#a-input").value=Math.round(1e6*t)/1e6,document.querySelector("#b-input").value=Math.round(1e6*e)/1e6})),function(){let r=0,i=0;document.querySelector("#mandelbrot-set").addEventListener("touchstart",(function(t){t.preventDefault(),document.querySelector("#julia-set").setAttribute("width",a),document.querySelector("#julia-set").setAttribute("height",a),d.viewport(0,0,a,a),n=a,o=100}),!1),document.querySelector("#mandelbrot-set").addEventListener("touchmove",(function(n){n.preventDefault();let o=n.touches[0].clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,a=n.touches[0].clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;r=o,i=a,t=3*(o/u-.5)-.75,e=3*((u-a)/u-.5),c=!0,s&&(s=!1,window.requestAnimationFrame(b))}),!1),document.querySelector("#mandelbrot-set").addEventListener("touchend",(function(n){n.preventDefault(),document.querySelector("#a-input").value=Math.round(1e6*t)/1e6,document.querySelector("#b-input").value=Math.round(1e6*e)/1e6}),!1)}()}();