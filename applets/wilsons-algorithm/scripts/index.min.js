!function(){"use strict";let e=new Wilson(Page.element.querySelector("#output-canvas"),{renderer:"cpu",canvasWidth:1e3,canvasHeight:1e3,useFullscreen:!0,useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"}),t=null,n=null,l=null,r=null;Page.element.querySelector("#generate-button").addEventListener("click",()=>{g(!1)});let a=Page.element.querySelector("#grid-size-input");a.addEventListener("keydown",e=>{13===e.keyCode&&g(!1)});Page.element.querySelector("#download-button").addEventListener("click",()=>{e.downloadFrame("wilsons-algorithm.png")});let i=Page.element.querySelector("#toggle-maximum-speed-checkbox"),s=Page.element.querySelector("#no-borders-checkbox"),o=Page.element.querySelector("#progress-bar"),c=Page.element.querySelector("#progress-bar span");function g(u){t=parseInt(a.value||50);let m=i.checked;n=s.checked;let $=null,p=2*t+1;n&&(p=t);if(l=Math.ceil(Math.min(window.innerWidth,window.innerHeight)/p),n?(e.changeCanvasSize(t*l,t*l),e.ctx.fillStyle="rgb(0, 0, 0)",e.ctx.fillRect(0,0,t*l,t*l)):(e.changeCanvasSize((2*t+1)*l,(2*t+1)*l),e.ctx.fillStyle="rgb(0, 0, 0)",e.ctx.fillRect(0,0,(2*t+1)*l,(2*t+1)*l)),!u)try{o.style.opacity=0,setTimeout(()=>{o.style.marginTop=0,o.style.marginBottom=0,o.style.height=0},600)}catch(y){}Page.element.querySelector("#progress-bar span").insertAdjacentHTML("afterend","<span></span>"),Page.element.querySelector("#progress-bar span").remove();try{r.terminate()}catch(d){}r=DEBUG?new Worker("/applets/wilsons-algorithm/scripts/worker.js"):new Worker("/applets/wilsons-algorithm/scripts/worker.min.js"),Page.temporaryWebWorkers.push(r),r.onmessage=function(t){if("log"===t.data[0]){clearTimeout($),console.log(...t.data.slice(1));return}if("progress"===t.data[0]){c.style.width=t.data[1]+"%",100===t.data[1]&&setTimeout(()=>{o.style.opacity=0,setTimeout(()=>{o.style.marginTop=0,o.style.marginBottom=0,o.style.height=0},Site.opacityAnimationTime)},2*Site.opacityAnimationTime);return}e.ctx.fillStyle=t.data[4],e.ctx.fillRect(t.data[0]*l,t.data[1]*l,t.data[2]*l,t.data[3]*l)},r.postMessage([t,m,n,u]),u||($=setTimeout(()=>{console.log("Didn't draw anything within three seconds -- attempting to reverse-generate a skeleton."),r.terminate(),o.style.marginTop="10vh",o.style.marginBottom="-5vh",o.style.height="5vh",setTimeout(()=>{o.style.opacity=1},2*Site.opacityAnimationTime),g(!0)},3e3))}Page.show()}();