"use strict";let gridSize=null,K=null,orbitSeparation=null,image=[],currentRow=null,currentCol=null,currentP=null,currentTheta=null;function drawKickedRotator(){var e=Math.floor(gridSize/2);for(let r=1;r<gridSize/2;r+=orbitSeparation+1){image=new Array(gridSize*gridSize);for(let e=0;e<gridSize;e++)for(let r=0;r<gridSize;r++)image[gridSize*e+r]=0;var t=6/7*r/(gridSize/2),i=Math.floor(Math.random()*(2*orbitSeparation+1))-orbitSeparation,i=calculateOrbit(Math.floor(gridSize/2+r),e+i,t);if(-1!==i){if(i<.45)for(let e=0;e<gridSize;e++)for(let r=0;r<gridSize;r++)0!==image[gridSize*e+r]&&(image[gridSize*(gridSize-e-1)+gridSize-r-1]=image[gridSize*e+r]);postMessage([image,t])}}}function calculateOrbit(r,e){let t=0;if(currentRow=r,currentCol=e,0!==image[gridSize*currentRow+currentCol])return-1;currentP=(1-currentRow/gridSize)*(2*Math.PI),currentTheta=currentCol/gridSize*(2*Math.PI);let i=0;for(;image[gridSize*currentRow+currentCol]++,i++,currentRow<gridSize/2&&t++,300!==image[gridSize*currentRow+currentCol];){for(currentP+=K*Math.sin(currentTheta),currentTheta+=currentP;currentP>=2*Math.PI;)currentP-=2*Math.PI;for(;currentTheta>=2*Math.PI;)currentTheta-=2*Math.PI;for(;currentP<0;)currentP+=2*Math.PI;for(;currentTheta<0;)currentTheta+=2*Math.PI;currentRow=Math.floor((1-currentP/(2*Math.PI))*gridSize),currentCol=Math.floor(currentTheta/(2*Math.PI)*gridSize)}return t/i}onmessage=r=>{gridSize=r.data[0],K=r.data[1],orbitSeparation=r.data[2],drawKickedRotator()};