import{showPage}from"../../../scripts/src/loadPage.min.js";import{MaurerRoses}from"./class.min.js";import{Button,DownloadButton}from"/scripts/src/buttons.min.js";import{$}from"/scripts/src/main.min.js";import{Textarea}from"/scripts/src/textareas.min.js";import{TextBox}from"/scripts/src/textBoxes.min.js";export default function(){const e=new MaurerRoses({canvas:$("#output-canvas")});new TextBox({element:$("#resolution-input"),name:"Resolution",value:2e3,minValue:1e3,maxValue:3e3,onInput:function(){},onEnter:t});const s=new Textarea({element:$("#expression-textarea"),name:"Expression",value:"",onInput:function(){var{selectionStart:e,selectionEnd:t}=s.element;s.value;let l=0;{var a,n;s.value.length<u.length?(a=function(str1,str2){for(let e=0;e<str1.length;e++)if(str1[e]!==str2[e])return e;return str1.length}(u,s.value),"."===u[a]&&0!==a?s.setValue(s.value.slice(0,a-1)+s.value.slice(a+1)):"("===u[a]&&a!==s.value.length-1&&")"===u[a+1]&&s.setValue(s.value.slice(0,a)+s.value.slice(a+1))):0!==e&&"("===s.value[e-1]&&(a=s.value.split("(").length-1,n=s.value.split(")").length-1,a==1+n)&&s.setValue(s.value.slice(0,e)+")"+s.value.slice(e))}s.setValue(s.value.replaceAll(/l/g,"λ")),s.setValue(s.value.replaceAll(/λ+/g,match=>(l-=match.length-1,"λ"))),s.setValue(s.value.replaceAll(/\./g,()=>(l--,""))),s.setValue(s.value.replaceAll(/λ([a-km-zA-KM-Z])/g,(match,$1)=>(l++,`λ${$1}.`))),s.element.setSelectionRange(e+l,t+l),u=s.value},onEnter:t,allowEnter:!0});let u=s.value;function t(){e.run({expression:s.value})}new Button({element:$("#evaluate-button"),name:"Evaluate",onClick:t}),new DownloadButton({element:$("#download-button"),applet:e,filename:"lambda-calculus.png"}),showPage()}