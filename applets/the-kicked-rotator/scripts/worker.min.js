"use strict";onmessage=async function(r){grid_size=r.data[0],K=r.data[1],orbit_separation=r.data[2],await draw_kicked_rotator()};let grid_size=null,K=null,orbit_separation=null,image=[],current_row=null,current_col=null,current_p=null,current_theta=null;const max_repetitions=50;function draw_kicked_rotator(){image=[];for(let r=0;r<grid_size;r++){image.push([]);for(let t=0;t<grid_size;t++)image[r].push(0)}const r=Math.floor(grid_size/2);for(let t=1;t<grid_size/2;t+=orbit_separation+1){image=[];for(let r=0;r<grid_size;r++){image.push([]);for(let t=0;t<grid_size;t++)image[r].push(0)}let e=6/7*t/(grid_size/2),i=Math.floor(Math.random()*(2*orbit_separation+1))-orbit_separation,a=calculate_orbit(Math.floor(grid_size/2+t),r+i,e);if(-1!==a){if(a<.45)for(let r=0;r<grid_size;r++)for(let t=0;t<grid_size;t++)0!==image[r][t]&&(image[grid_size-r-1][grid_size-t-1]=image[r][t]);postMessage([image,e])}}}function calculate_orbit(r,t,e){let i=0;if(current_col=t,0!==image[current_row=r][current_col])return-1;current_p=(1-current_row/grid_size)*(2*Math.PI),current_theta=current_col/grid_size*(2*Math.PI);let a=0;for(;image[current_row][current_col]++,a++,current_row<grid_size/2&&i++,300!==image[current_row][current_col];){for(current_p+=K*Math.sin(current_theta),current_theta+=current_p;current_p>=2*Math.PI;)current_p-=2*Math.PI;for(;current_theta>=2*Math.PI;)current_theta-=2*Math.PI;for(;current_p<0;)current_p+=2*Math.PI;for(;current_theta<0;)current_theta+=2*Math.PI;current_row=Math.floor((1-current_p/(2*Math.PI))*grid_size),current_col=Math.floor(current_theta/(2*Math.PI)*grid_size)}return i/a}