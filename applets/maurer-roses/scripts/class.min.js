import{AnimationFrameApplet}from"/scripts/applets/animationFrameApplet.min.js";import{hsvToRgb}from"/scripts/applets/applet.min.js";import{WilsonCPU}from"/scripts/wilson.min.js";class MaurerRoses extends AnimationFrameApplet{resolution=2e3;thetaFactor=2;pointFactor=1;numGraphPoints=4e3;graphPointsPerFrame=30;linesPerFrame=1;curveThickness=1;lineThickness=1;pointQueue=[];lineQueue=[];pointQueuePosition=0;lineQueuePosition=0;constructor({canvas}){super(canvas);var t={canvasWidth:this.resolution,worldWidth:2.1,worldHeight:2.1,fullscreenOptions:{useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"}};this.wilson=new WilsonCPU(canvas,t)}run({resolution=2e3,thetaFactor=2,pointFactor=1,animate=!1}){this.resolution=resolution,this.thetaFactor=thetaFactor,this.pointFactor=pointFactor,this.animate=animate,this.numGraphPoints=3e4,this.graphPointsPerFrame=this.animate?this.numGraphPoints/(300*this.thetaFactor):this.numGraphPoints,this.linesPerFrame=this.animate?1:360,this.curveThickness=Math.max(this.resolution/500,1),this.lineThickness=Math.max(this.resolution/1e3,1),this.wilson.ctx.lineWidth=this.lineThickness,this.wilson.resizeCanvas({width:this.resolution}),this.pointQueue=[],this.lineQueue=[],this.pointQueuePosition=0;for(let h=this.lineQueuePosition=0;h<this.numGraphPoints;h++){var t=h/this.numGraphPoints*2*Math.PI,i=Math.sin(t*this.thetaFactor),e=i*Math.cos(t),i=i*Math.sin(t);this.pointQueue.push(this.wilson.interpolateWorldToCanvas([e,i]))}for(let r=0;r<360;r++){var s=r/360*2*Math.PI*this.pointFactor,n=Math.sin(s*this.thetaFactor),o=n*Math.cos(s),n=n*Math.sin(s),[s,o]=this.wilson.interpolateWorldToCanvas([o,n]),n=hsvToRgb(r/360,1,1);this.lineQueue.push([s,o,n])}this.wilson.ctx.fillStyle="rgb(0, 0, 0)",this.wilson.ctx.fillRect(0,0,this.resolution,this.resolution),this.resume()}drawFrame(){if(this.needNewFrame=!0,this.pointQueuePosition<this.pointQueue.length){this.wilson.ctx.fillStyle="rgb(255, 255, 255)";for(let t=0;t<this.graphPointsPerFrame&&this.pointQueuePosition<this.pointQueue.length;t++){var[i,e]=this.pointQueue[this.pointQueuePosition];this.wilson.ctx.beginPath(),this.wilson.ctx.arc(i,e,this.curveThickness,0,2*Math.PI),this.wilson.ctx.fill(),this.pointQueuePosition++}}else if(this.lineQueuePosition<this.lineQueue.length)for(let t=0;t<this.linesPerFrame&&this.lineQueuePosition<this.lineQueue.length;t++){var[s,n,o]=this.lineQueue[this.lineQueuePosition],[h,r]=this.lineQueue[(this.lineQueuePosition+1)%this.lineQueue.length];this.wilson.ctx.strokeStyle=`rgb(${o[0]}, ${o[1]}, ${o[2]})`,this.wilson.ctx.beginPath(),this.wilson.ctx.moveTo(s,n),this.wilson.ctx.lineTo(h,r),this.wilson.ctx.stroke(),this.lineQueuePosition++}else this.needNewFrame=!1}}export{MaurerRoses};