import{AnimationFrameApplet}from"/scripts/applets/animationFrameApplet.min.js";import{hsvToRgb}from"/scripts/applets/applet.min.js";import{WilsonCPU}from"/scripts/wilson.min.js";class MaurerRoses extends AnimationFrameApplet{resolution=2e3;thetaFactor=2;pointFactor=1;numGraphPoints=4e3;graphPointsPerFrame=20;pointQueue=[];lineQueue=[];pointQueuePosition=0;lineQueuePosition=0;constructor({canvas}){super(canvas);var t={canvasWidth:this.resolution,worldWidth:2.1,worldHeight:2.1,fullscreenOptions:{useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"}};this.wilson=new WilsonCPU(canvas,t)}run({resolution=2e3,thetaFactor=2,pointFactor=1,animate=!1}){this.resolution=resolution,this.thetaFactor=thetaFactor,this.pointFactor=pointFactor,this.animate=animate,this.wilson.resizeCanvas({width:this.resolution}),this.pointQueue=[],this.lineQueue=[],this.pointQueuePosition=0;for(let h=this.lineQueuePosition=0;h<this.numGraphPoints;h++){var t=h/this.numGraphPoints*2*Math.PI,i=Math.sin(t*this.thetaFactor),e=i*Math.cos(t),i=i*Math.sin(t);this.pointQueue.push(this.wilson.interpolateWorldToCanvas([e,i]))}for(let r=0;r<360;r++){var s=r/360*2*Math.PI,o=Math.sin(s*this.thetaFactor),n=o*Math.cos(s),o=o*Math.sin(s),[s,n]=this.wilson.interpolateCanvasToWorld([n,o]),o=hsvToRgb(r/360,1,1);this.lineQueue.push([s,n,o])}this.wilson.ctx.fillStyle="rgb(0, 0, 0)",this.wilson.ctx.fillRect(0,0,this.resolution,this.resolution),this.resume()}prepareFrame(){}drawFrame(){var i,e,s,o,n,h;if(this.animate)if(this.needNewFrame=!0,this.pointQueuePosition<this.pointQueue.length)for(let t=0;t<this.graphPointsPerFrame&&this.pointQueuePosition<this.pointQueue.length;t++){var[r,a]=this.pointQueue[this.pointQueuePosition];this.wilson.ctx.fillStyle="rgb(255, 255, 255)",this.wilson.ctx.fillRect(r-1,a-1,3,3),this.pointQueuePosition++}else this.lineQueuePosition<this.lineQueue.length?([i,e,s]=this.pointQueue[this.pointQueuePosition],[o,n,h]=this.lineQueue[(this.lineQueuePosition+1)%this.lineQueue.length],this.wilson.ctx.fillStyle=`rgb(${s[0]}, ${s[1]}, ${s[2]})`,this.wilson.ctx.beginPath(),this.wilson.ctx.moveTo(i,e),this.wilson.ctx.lineTo(o,n),this.wilson.ctx.stroke(),this.lineQueuePosition++):this.needNewFrame=!1}}export{MaurerRoses};