!function(){"use strict";let t=null,n=null,e="cadd(cpow(z, 2.0), c)",r=0,o=1,a=200,i=1,c=0,l=[],u=0,s=0,w=500,d=100,f=0,_=0,z=0,m=0,v=0,g=0,h=0,p=0;const x=.96,y=.0025,b=25e-5,M=.93,q=.01,k=.001;let F=-1,R=document.querySelector("#code-textarea");R.value="cadd(cpow(z, 2.0), c)";let j=document.querySelector("#resolution-input");j.addEventListener("input",()=>{w=parseInt(j.value||500),t.change_canvas_size(w,w)});let A=document.querySelector("#exposure-input");A.addEventListener("input",()=>{i=parseFloat(A.value||1)});let S=document.querySelector("#num-iterations-input");S.addEventListener("input",()=>{a=parseInt(S.value||200)}),document.querySelector("#download-button").addEventListener("click",()=>{t.download_frame("a-generalized-julia-set.png")}),document.querySelector("#generate-button").addEventListener("click",E);let C=document.querySelector("#switch-julia-mode-button");C.addEventListener("click",()=>{C.style.opacity=0,setTimeout(()=>{2===r?C.textContent="Return to Mandelbrot Set":0===r&&(C.textContent="Pick Julia Set",C.style.opacity=1)},Site.opacity_animation_time),0===r?(r=2,u=0,s=0,g=0,h=0,p=0,z=0,m=0,v=0,l=[],window.requestAnimationFrame(J)):1===r&&(r=0,t.world_center_x=0,t.world_center_y=0,t.world_width=4,t.world_height=4,c=0,l=[],window.requestAnimationFrame(J))});let L=document.querySelector("#canvas-location");function E(){let o=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform int julia_mode;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float a;\n\t\t\tuniform float b;\n\t\t\tuniform float exposure;\n\t\t\tuniform int num_iterations;\n\t\t\tuniform float brightness_scale;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns |z|.\n\t\t\tfloat cabs(vec2 z)\n\t\t\t{\n\t\t\t\treturn length(z);\n\t\t\t}\n\t\t\t\n\t\t\tfloat cabs(float z)\n\t\t\t{\n\t\t\t\treturn abs(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns |z|.\n\t\t\tfloat carg(vec2 z)\n\t\t\t{\n\t\t\t\tif (z.x == 0.0)\n\t\t\t\t{\n\t\t\t\t\tif (z.y >= 0.0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn 1.57079632;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn -1.57079632;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn atan(z.y, z.x);\n\t\t\t}\n\t\t\t\n\t\t\tfloat carg(float z)\n\t\t\t{\n\t\t\t\tif (z >= 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn 0.0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn 3.14159265;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns the conjugate of z.\n\t\t\tvec2 cconj(vec2 z)\n\t\t\t{\n\t\t\t\treturn vec2(z.x, -z.y);\n\t\t\t}\n\t\t\t\n\t\t\tfloat cconj(float z)\n\t\t\t{\n\t\t\t\treturn z;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns z / |z|.\n\t\t\tvec2 csign(vec2 z)\n\t\t\t{\n\t\t\t\tif (length(z) == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn vec2(0.0, 0.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn z / length(z);\n\t\t\t}\n\t\t\t\n\t\t\tfloat csign(float z)\n\t\t\t{\n\t\t\t\treturn sign(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns z + w.\n\t\t\tvec2 cadd(vec2 z, vec2 w)\n\t\t\t{\n\t\t\t\treturn z + w;\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cadd(vec2 z, float w)\n\t\t\t{\n\t\t\t\treturn vec2(z.x + w, z.y);\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cadd(float z, vec2 w)\n\t\t\t{\n\t\t\t\treturn vec2(z + w.x, w.y);\n\t\t\t}\n\t\t\t\n\t\t\tfloat cadd(float z, float w)\n\t\t\t{\n\t\t\t\treturn z + w;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns z - w.\n\t\t\tvec2 csub(vec2 z, vec2 w)\n\t\t\t{\n\t\t\t\treturn z - w;\n\t\t\t}\n\t\t\t\n\t\t\tvec2 csub(vec2 z, float w)\n\t\t\t{\n\t\t\t\treturn vec2(z.x - w, z.y);\n\t\t\t}\n\t\t\t\n\t\t\tvec2 csub(float z, vec2 w)\n\t\t\t{\n\t\t\t\treturn vec2(z - w.x, -w.y);\n\t\t\t}\n\t\t\t\n\t\t\tfloat csub(float z, float w)\n\t\t\t{\n\t\t\t\treturn z - w;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns z * w.\n\t\t\tvec2 cmul(vec2 z, vec2 w)\n\t\t\t{\n\t\t\t\treturn vec2(z.x * w.x - z.y * w.y, z.x * w.y + z.y * w.x);\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cmul(vec2 z, float w)\n\t\t\t{\n\t\t\t\treturn z * w;\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cmul(float z, vec2 w)\n\t\t\t{\n\t\t\t\treturn z * w;\n\t\t\t}\n\t\t\t\n\t\t\tfloat cmul(float z, float w)\n\t\t\t{\n\t\t\t\treturn z * w;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns z / w.\n\t\t\tvec2 cdiv(vec2 z, vec2 w)\n\t\t\t{\n\t\t\t\tif (length(w) == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn vec2(1.0, 0.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn vec2(z.x * w.x + z.y * w.y, -z.x * w.y + z.y * w.x) / (w.x * w.x + w.y * w.y);\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cdiv(vec2 z, float w)\n\t\t\t{\n\t\t\t\tif (w == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn vec2(1.0, 0.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn z / w;\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cdiv(float z, vec2 w)\n\t\t\t{\n\t\t\t\tif (length(w) == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn vec2(1.0, 0.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn vec2(z * w.x, -z * w.y) / (w.x * w.x + w.y * w.y);\n\t\t\t}\n\t\t\t\n\t\t\tfloat cdiv(float z, float w)\n\t\t\t{\n\t\t\t\tif (w == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn 1.0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn z / w;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns 1/z.\n\t\t\tvec2 cinv(vec2 z)\n\t\t\t{\n\t\t\t\tfloat magnitude = z.x*z.x + z.y*z.y;\n\t\t\t\t\n\t\t\t\treturn vec2(z.x / magnitude, -z.y / magnitude);\n\t\t\t}\n\t\t\t\n\t\t\tfloat cinv(float z)\n\t\t\t{\n\t\t\t\tif (z == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn 1.0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn 1.0 / z;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns z^w.\n\t\t\tvec2 cpow(vec2 z, vec2 w)\n\t\t\t{\n\t\t\t\tfloat arg = carg(z);\n\t\t\t\tfloat magnitude = z.x * z.x + z.y * z.y;\n\t\t\t\t\n\t\t\t\tfloat exparg = exp(-w.y * arg);\n\t\t\t\tfloat magexp = pow(magnitude, w.x / 2.0);\n\t\t\t\tfloat logmag = log(magnitude) * w.y / 2.0;\n\t\t\t\t\n\t\t\t\tfloat p1 = exparg * cos(w.x * arg);\n\t\t\t\tfloat p2 = exparg * sin(w.x * arg);\n\t\t\t\t\n\t\t\t\tfloat q1 = magexp * cos(logmag);\n\t\t\t\tfloat q2 = magexp * sin(logmag);\n\t\t\t\t\n\t\t\t\treturn vec2(p1 * q1 - p2 * q2, q1 * p2 + p1 * q2);\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cpow(vec2 z, float w)\n\t\t\t{\n\t\t\t\tfloat arg = carg(z);\n\t\t\t\tfloat magnitude = z.x * z.x + z.y * z.y;\n\t\t\t\t\n\t\t\t\tfloat magexp = pow(magnitude, w / 2.0);\n\t\t\t\t\n\t\t\t\tfloat p1 = cos(w * arg);\n\t\t\t\tfloat p2 = sin(w * arg);\n\t\t\t\t\n\t\t\t\treturn vec2(p1 * magexp, p2 * magexp);\n\t\t\t}\n\t\t\t\n\t\t\tvec2 cpow(float z, vec2 w)\n\t\t\t{\n\t\t\t\tif (z == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn vec2(0.0, 0.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfloat zlog = log(z);\n\t\t\t\tfloat zexp = exp(w.x * zlog);\n\t\t\t\t\n\t\t\t\treturn vec2(zexp * cos(w.y * zlog), zexp * sin(w.y * zlog));\n\t\t\t}\n\t\t\t\n\t\t\tfloat cpow(float z, float w)\n\t\t\t{\n\t\t\t\treturn pow(z, w);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns z^^w.\n\t\t\tvec2 ctet(vec2 z, float w)\n\t\t\t{\n\t\t\t\tif (w == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn vec2(1.0, 0.0);\n\t\t\t\t}\n\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 prod = z;\n\t\t\t\t\n\t\t\t\tfor (int i = 1; i < 10000; i++)\n\t\t\t\t{\n\t\t\t\t\tif (float(i) >= w)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn prod;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tprod = cpow(z, prod);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn prod;\n\t\t\t}\n\t\t\t\n\t\t\tfloat ctet(float z, float w)\n\t\t\t{\n\t\t\t\tif (w == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn 1.0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat prod = z;\n\t\t\t\t\n\t\t\t\tfor (int i = 1; i < 10000; i++)\n\t\t\t\t{\n\t\t\t\t\tif (float(i) >= w)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn prod;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tprod = pow(z, prod);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn prod;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns sqrt(z).\n\t\t\tvec2 csqrt(vec2 z)\n\t\t\t{\n\t\t\t\treturn cpow(z, .5);\n\t\t\t}\n\t\t\t\n\t\t\tvec2 csqrt(float z)\n\t\t\t{\n\t\t\t\tif (z >= 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn vec2(sqrt(z), 0.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn vec2(0.0, sqrt(-z));\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns e^z.\n\t\t\tvec2 cexp(vec2 z)\n\t\t\t{\n\t\t\t\treturn cpow(2.7182818, z);\n\t\t\t}\n\t\t\t\n\t\t\tfloat cexp(float z)\n\t\t\t{\n\t\t\t\treturn exp(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns log(z).\n\t\t\tvec2 clog(vec2 z)\n\t\t\t{\n\t\t\t\treturn vec2(.5 * log(z.x * z.x + z.y * z.y), carg(z));\n\t\t\t}\n\t\t\t\n\t\t\tfloat clog(float z)\n\t\t\t{\n\t\t\t\tif (z == 0.0)\n\t\t\t\t{\n\t\t\t\t\treturn 0.0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn log(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns sin(z).\n\t\t\tvec2 csin(vec2 z)\n\t\t\t{\n\t\t\t\tvec2 temp = cexp(cmul(z, vec2(0.0, 1.0))) - cexp(cmul(z, vec2(0.0, -1.0)));\n\t\t\t\t\n\t\t\t\treturn cmul(temp, vec2(0.0, -0.5));\n\t\t\t}\n\t\t\t\n\t\t\tfloat csin(float z)\n\t\t\t{\n\t\t\t\treturn sin(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns cos(z).\n\t\t\tvec2 ccos(vec2 z)\n\t\t\t{\n\t\t\t\tvec2 temp = cexp(cmul(z, vec2(0.0, 1.0))) + cexp(cmul(z, vec2(0.0, -1.0)));\n\t\t\t\t\n\t\t\t\treturn cmul(temp, vec2(0.0, -0.5));\n\t\t\t}\n\t\t\t\n\t\t\tfloat ccos(float z)\n\t\t\t{\n\t\t\t\treturn cos(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns tan(z).\n\t\t\tvec2 ctan(vec2 z)\n\t\t\t{\n\t\t\t\tvec2 temp = cexp(cmul(z, vec2(0.0, 2.0)));\n\t\t\t\t\n\t\t\t\treturn cdiv(cmul(vec2(0.0, -1.0), vec2(-1.0, 0.0) + temp), vec2(1.0, 0.0) + temp);\n\t\t\t}\n\t\t\t\n\t\t\tfloat ctan(float z)\n\t\t\t{\n\t\t\t\treturn tan(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec3 color = normalize(vec3(abs(z.x + z.y) / 2.0, abs(z.x) / 2.0, abs(z.y) / 2.0) + .1 / length(z) * vec3(1.0, 1.0, 1.0));\n\t\t\t\tfloat brightness = exp(-length(z));\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif (julia_mode == 0)\n\t\t\t\t{\n\t\t\t\t\tvec2 c = z;\n\t\t\t\t\t\n\t\t\t\t\tfor (int iteration = 0; iteration < 3001; iteration++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (iteration == num_iterations)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (length(z) >= 4.0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tz = ${e=R.value||"cadd(cpow(z, 2.0), c)"};\n\t\t\t\t\t\t\n\t\t\t\t\t\tbrightness += exp(-length(z));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tgl_FragColor = vec4(brightness / brightness_scale * exposure * color, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\telse if (julia_mode == 1)\n\t\t\t\t{\n\t\t\t\t\tvec2 c = vec2(a, b);\n\t\t\t\t\t\n\t\t\t\t\tfor (int iteration = 0; iteration < 3001; iteration++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (iteration == num_iterations)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (length(z) >= 4.0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tz = ${e};\n\t\t\t\t\t\t\n\t\t\t\t\t\tbrightness += exp(-length(z));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tgl_FragColor = vec4(brightness / brightness_scale * exposure * color, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvec2 c = z;\n\t\t\t\t\t\n\t\t\t\t\tbool broken = false;\n\t\t\t\t\t\n\t\t\t\t\tfor (int iteration = 0; iteration < 3001; iteration++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (iteration == num_iterations)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbroken = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (length(z) >= 4.0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tz = ${e};\n\t\t\t\t\t\t\n\t\t\t\t\t\tbrightness += exp(-length(z));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tif (!broken)\n\t\t\t\t\t{\n\t\t\t\t\t\tgl_FragColor = vec4(.5 * brightness / brightness_scale * exposure * color, 1.0);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * 2.0, uv.y * 2.0);\n\t\t\t\t\tcolor = normalize(vec3(abs(z.x + z.y) / 2.0, abs(z.x) / 2.0, abs(z.y) / 2.0) + .1 / length(z) * vec3(1.0, 1.0, 1.0));\n\t\t\t\t\tbrightness = exp(-length(z));\n\t\t\t\t\t\n\t\t\t\t\tbroken = false;\n\t\t\t\t\t\n\t\t\t\t\tc = vec2(a, b);\n\t\t\t\t\t\n\t\t\t\t\tfor (int iteration = 0; iteration < 3001; iteration++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (iteration == num_iterations)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor.xyz /= 4.0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbroken = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (length(z) >= 4.0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tz = ${e};\n\t\t\t\t\t\t\n\t\t\t\t\t\tbrightness += exp(-length(z));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!broken)\n\t\t\t\t\t{\n\t\t\t\t\t\tgl_FragColor += vec4(brightness / brightness_scale * exposure * color, 0.0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t`,a={renderer:"gpu",shader:o,canvas_width:500,canvas_height:500,world_width:4,world_height:4,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:B,mousedown_callback:$,touchstart_callback:$,mousemove_callback:H,mousedrag_callback:W,touchmove_callback:W,mouseup_callback:I,touchend_callback:I,wheel_callback:N,pinch_callback:P},i={renderer:"gpu",shader:o,canvas_width:100,canvas_height:100};try{t.output_canvas_container.parentNode.remove(),n.output_canvas_container.parentNode.remove(),L.insertAdjacentHTML("beforebegin",'\n\t\t\t\t<div>\n\t\t\t\t\t<canvas id="output-canvas" class="output-canvas"></canvas>\n\t\t\t\t\t<canvas id="hidden-canvas" class="hidden-canvas"></canvas>\n\t\t\t\t</div>\n\t\t\t')}catch(t){}(t=new Wilson(document.querySelector("#output-canvas"),a)).render.init_uniforms(["julia_mode","aspect_ratio","world_center_x","world_center_y","world_size","a","b","num_iterations","exposure","brightness_scale"]),(n=new Wilson(document.querySelector("#hidden-canvas"),i)).render.init_uniforms(["julia_mode","aspect_ratio","world_center_x","world_center_y","world_size","a","b","num_iterations","exposure","brightness_scale"]),r=0,c=0,l=[],t.gl.uniform1f(t.uniforms.aspect_ratio,1),n.gl.uniform1f(n.uniforms.aspect_ratio,1),window.requestAnimationFrame(J)}function $(n,e,o){g=0,h=0,p=0,z=0,m=0,v=0,2===r&&"mousedown"===o.type&&(r=1,t.world_center_x=0,t.world_center_y=0,t.world_width=4,t.world_height=4,c=0,l=[],C.style.opacity=1,window.requestAnimationFrame(J))}function W(n,e,o,a,i){2===r&&"touchmove"===i.type?(u=n,s=e):(t.world_center_x-=o,t.world_center_y-=a,z=-o/t.world_width,m=-a/t.world_height,t.world_center_x=Math.min(Math.max(t.world_center_x,-2),2),t.world_center_y=Math.min(Math.max(t.world_center_y,-2),2)),window.requestAnimationFrame(J)}function H(t,n,e,o,a){2===r&&"mousemove"===a.type&&(u=t,s=n,window.requestAnimationFrame(J))}function I(n,e,o){2===r&&"touchend"===o.type?(r=1,t.world_center_x=0,t.world_center_y=0,t.world_width=4,t.world_height=4,c=0,l=[],C.style.opacity=1,window.requestAnimationFrame(J)):(Math.sqrt(z*z+m*m)>=y&&(g=z,h=m),Math.abs(v)>=q&&(p=v)),window.requestAnimationFrame(J)}function N(t,n,e,r){f=t,_=n,Math.abs(e/100)<.3?(c+=e/100,c=Math.min(c,1)):p+=.05*Math.sign(e),T()}function P(n,e,a,i){2!==r&&(o>=1?(c-=a/t.world_width*10,v=-a/t.world_width*10):(c-=a/t.world_height*10,v=-a/t.world_height*10),c=Math.min(c,1),f=n,_=e,T())}function T(){if(o>=1){let n=t.input.get_zoomed_world_center(f,_,4*Math.pow(2,c)*o,4*Math.pow(2,c));t.world_width=4*Math.pow(2,c)*o,t.world_height=4*Math.pow(2,c),t.world_center_x=n[0],t.world_center_y=n[1]}else{let n=t.input.get_zoomed_world_center(f,_,4*Math.pow(2,c),4*Math.pow(2,c)/o);t.world_width=4*Math.pow(2,c),t.world_height=4*Math.pow(2,c)/o,t.world_center_x=n[0],t.world_center_y=n[1]}a=30*-c+200,window.requestAnimationFrame(J)}function J(e){let w=e-F;if(F=e,0===w)return;n.gl.uniform1i(n.uniforms.julia_mode,r),n.gl.uniform1f(n.uniforms.world_center_x,t.world_center_x),n.gl.uniform1f(n.uniforms.world_center_y,t.world_center_y),n.gl.uniform1f(n.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),n.gl.uniform1i(n.uniforms.num_iterations,a),n.gl.uniform1f(n.uniforms.exposure,1),n.gl.uniform1f(n.uniforms.a,u),n.gl.uniform1f(n.uniforms.b,s),n.gl.uniform1f(n.uniforms.brightness_scale,20*(Math.abs(c)+1)),n.render.draw_frame();let f=n.render.get_pixel_data(),_=new Array(d*d);for(let t=0;t<d*d;t++)_[t]=f[4*t]+f[4*t+1]+f[4*t+2];_.sort((t,n)=>t-n);let z=(_[Math.floor(d*d*.96)]+_[Math.floor(d*d*.98)])/255*15*(Math.abs(c/2)+1);l.push(z);let m=l.length;m>10&&l.shift(),z=Math.max(l.reduce((t,n)=>t+n)/m,.5),t.gl.uniform1i(t.uniforms.julia_mode,r),t.gl.uniform1f(t.uniforms.aspect_ratio,o),t.gl.uniform1f(t.uniforms.world_center_x,t.world_center_x),t.gl.uniform1f(t.uniforms.world_center_y,t.world_center_y),t.gl.uniform1f(t.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),t.gl.uniform1i(t.uniforms.num_iterations,a),t.gl.uniform1f(t.uniforms.exposure,i),t.gl.uniform1f(t.uniforms.a,u),t.gl.uniform1f(t.uniforms.b,s),t.gl.uniform1f(t.uniforms.brightness_scale,z),t.render.draw_frame(),0===g&&0===h&&0===p||(t.world_center_x+=g*t.world_width,t.world_center_y+=h*t.world_height,t.world_center_x=Math.min(Math.max(t.world_center_x,-2),2),t.world_center_y=Math.min(Math.max(t.world_center_y,-2),2),g*=x,h*=x,Math.sqrt(g*g+h*h)<b&&(g=0,h=0),c+=p,c=Math.min(c,1),T(),p*=M,Math.abs(p)<k&&(p=0),window.requestAnimationFrame(J))}function B(){t.fullscreen.currently_fullscreen?(o=window.innerWidth/window.innerHeight)>=1?(t.change_canvas_size(w,Math.floor(w/o)),t.world_width=4*Math.pow(2,c)*o,t.world_height=4*Math.pow(2,c)):(t.change_canvas_size(Math.floor(w*o),w),t.world_width=4*Math.pow(2,c),t.world_height=4*Math.pow(2,c)/o):(o=1,t.change_canvas_size(w,w),t.world_width=4*Math.pow(2,c),t.world_height=4*Math.pow(2,c)),window.requestAnimationFrame(J)}E(),window.addEventListener("resize",B),Page.temporary_handlers.resize.push(B)}();