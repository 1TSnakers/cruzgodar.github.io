!function(){"use strict";let e=null,t=document.querySelector("#calcudoku-grid").getContext("2d"),l=0,o=0,c=null,r=[],u=[],n=[],i=[],a=null;document.querySelector("#generate-button").addEventListener("click",d);let s=document.querySelectorAll("#grid-size-input, #max-cage-size-input");for(let e=0;e<s.length;e++)s[e].addEventListener("keydown",function(e){13===e.keyCode&&d()});function d(){e=parseInt(document.querySelector("#grid-size-input").value||5);let s=parseInt(document.querySelector("#max-cage-size-input").value||1e3);for(let t=0;t<e;t++){n.push([]);for(let l=0;l<e;l++)n[t].push(0)}l=0,o=0,document.querySelector("#total-time-clock").textContent="0",document.querySelector("#split-time-clock").textContent="0",0==document.querySelector("#total-time-label").style.opacity?y():(document.querySelector("#total-time-label").style.opacity=0,document.querySelector("#total-time-clock").style.opacity=0,document.querySelector("#split-time-label").style.opacity=0,document.querySelector("#split-time-clock").style.opacity=0,document.querySelector("#calcudoku-grid").style.opacity=0,setTimeout(y,350)),setTimeout(function(){let l=200*e+9;document.querySelector("#calcudoku-grid").setAttribute("width",l),document.querySelector("#calcudoku-grid").setAttribute("height",l),t.clearRect(0,0,l,l)},300),clearInterval(c),c=setInterval(m,1e3),temporary_intervals.push(c);try{a.terminate()}catch(e){}a=DEBUG?new Worker("/applets/calcudoku-generator/scripts/worker.js"):new Worker("/applets/calcudoku-generator/scripts/worker.min.js"),temporary_web_workers.push(a),a.onmessage=function(t){if("log"===t.data[0])console.log(...t.data.slice(1));else{r=t.data[0],u=t.data[1],i=JSON.parse(JSON.stringify(n)),n=t.data[2],f(!1);let l=!1;for(let t=0;t<e;t++){for(let c=0;c<e;c++)if(n[t][c]!==i[t][c]){l=!0,o=0;break}if(l)break}}},setTimeout(function(){a.postMessage([e,s])},300)}function y(){document.querySelector("#total-time-label").style.opacity=1,setTimeout(function(){document.querySelector("#total-time-clock").style.opacity=1,setTimeout(function(){document.querySelector("#split-time-label").style.opacity=1,setTimeout(function(){document.querySelector("#split-time-clock").style.opacity=1,setTimeout(function(){document.querySelector("#calcudoku-grid").style.opacity=1},100)},100)},100)},100)}function m(){let e=l%60,t=Math.floor(l/60)%60,c=Math.floor(l/3600),r="";c>0&&(r+=c+":",t<10&&(r+="0")),(t>0||c>0)&&(r+=t+":",e<10&&(r+="0")),r+=e,document.querySelector("#total-time-clock").textContent=r,e=o%60,t=Math.floor(o/60)%60;let u="";(c=Math.floor(o/3600))>0&&(u+=c+":",t<10&&(r+="0")),(t>0||c>0)&&(u+=t+":",e<10&&(r+="0")),u+=e,document.querySelector("#split-time-clock").textContent=u,l++,o++}function f(l){let o=200*e+9;l?(t.fillStyle="rgb(255, 255, 255)",t.fillRect(0,0,o,o),t.fillStyle="rgb(0, 0, 0)"):(t.clearRect(0,0,o,o),1===url_vars.theme?1===url_vars.contrast?t.fillStyle="rgb(255, 255, 255)":t.fillStyle="rgb(192, 192, 192)":1===url_vars.contrast?t.fillStyle="rgb(0, 0, 0)":t.fillStyle="rgb(64, 64, 64)");for(let l=0;l<=e;l++)t.fillRect(200*l+4,0,2,o+9),t.fillRect(0,200*l+4,o+9,2);for(let l=0;l<e;l++)for(let o=0;o<e;o++)0!==l&&n[l-1][o]===n[l][o]||t.fillRect(200*o,200*l,210,10),l!==e-1&&n[l+1][o]===n[l][o]||t.fillRect(200*o,200*(l+1),210,10),0!==o&&n[l][o-1]===n[l][o]||t.fillRect(200*o,200*l,10,210),o!==e-1&&n[l][o+1]===n[l][o]||t.fillRect(200*(o+1),200*l,10,210);for(let l=0;l<u.length;l++){let o=[e,e];for(let e=0;e<u[l][2].length;e++){let t=u[l][2][e][0],c=u[l][2][e][1];t<o[0]?o=[t,c]:t===o[0]&&c<o[1]&&(o=[t,c])}let c="",r=null;(c="+"===u[l][0]?u[l][1]+"+":"x"===u[l][0]?u[l][1]+"×":"-"===u[l][0]?u[l][1]+"–":":"===u[l][0]?u[l][1]+"꞉":u[l][1]+"").length<=6?(t.font="50px sans-serif",r=50):(t.font=300/c.length+"px sans-serif",r=300/c.length),t.fillText(c,200*o[1]+15,200*o[0]+r+5)}}document.querySelector("#download-button").addEventListener("click",function(){document.querySelector("#calcudoku-grid").style.opacity=0,f(!0);let e=document.createElement("a");e.download="calcudoku.png",e.href=document.querySelector("#calcudoku-grid").toDataURL(),e.click(),e.remove(),f(!1),document.querySelector("#calcudoku-grid").style.opacity=1})}();