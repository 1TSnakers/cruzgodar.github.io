!function(){"use strict";let e=null,t=document.querySelector("#calcudoku-grid").getContext("2d"),l=null,r=null,o=0,c=[],n=[],u=[],a=null;function i(l){let r=200*e+9;l?(t.fillStyle="rgb(255, 255, 255)",t.fillRect(0,0,r,r),t.fillStyle="rgb(0, 0, 0)"):(t.clearRect(0,0,r,r),1===url_vars.theme?1===url_vars.contrast?t.fillStyle="rgb(255, 255, 255)":t.fillStyle="rgb(192, 192, 192)":1===url_vars.contrast?t.fillStyle="rgb(0, 0, 0)":t.fillStyle="rgb(64, 64, 64)");for(let l=0;l<=e;l++)t.fillRect(200*l+4,0,2,r+9),t.fillRect(0,200*l+4,r+9,2);for(let l=0;l<e;l++)for(let r=0;r<e;r++)0!==l&&u[l-1][r]===u[l][r]||t.fillRect(200*r,200*l,210,10),l!==e-1&&u[l+1][r]===u[l][r]||t.fillRect(200*r,200*(l+1),210,10),0!==r&&u[l][r-1]===u[l][r]||t.fillRect(200*r,200*l,10,210),r!==e-1&&u[l][r+1]===u[l][r]||t.fillRect(200*(r+1),200*l,10,210);for(let l=0;l<n.length;l++){let r=[e,e];for(let e=0;e<n[l][2].length;e++){let t=n[l][2][e][0],o=n[l][2][e][1];t<r[0]?r=[t,o]:t===r[0]&&o<r[1]&&(r=[t,o])}let o="",c=null;(o="+"===n[l][0]?n[l][1]+"+":"x"===n[l][0]?n[l][1]+"×":"-"===n[l][0]?n[l][1]+"–":":"===n[l][0]?n[l][1]+"꞉":n[l][1]+"").length<=6?(t.font="50px sans-serif",c=50):(t.font=300/o.length+"px sans-serif",c=300/o.length),t.fillText(o,200*r[1]+15,200*r[0]+c+5)}}document.querySelector("#generate-button").addEventListener("click",function(){e=parseInt(document.querySelector("#grid-size-input").value||5);let s=parseInt(document.querySelector("#max-cage-size-input").value||1e3),d=200*e+9;document.querySelector("#calcudoku-grid").setAttribute("width",d),document.querySelector("#calcudoku-grid").setAttribute("height",d),t.clearRect(0,0,d,d),document.querySelector(".progress-bar").style.opacity=1,document.querySelector(".progress-bar span").style.width=0,o=0;try{a.terminate()}catch(e){}a=DEBUG?new Worker("/applets/calcudoku-generator/scripts/worker.js"):new Worker("/applets/calcudoku-generator/scripts/worker.min.js");temporary_web_workers.push(a),a.onmessage=function(t){"done"===t.data[0]?(clearInterval(r),document.querySelector(".progress-bar").style.opacity=0,console.log("Finished in time!")):"first_grid_complete"===t.data[0]?(clearTimeout(l),l=setTimeout(function(){clearInterval(r),document.querySelector(".progress-bar").style.opacity=0},1e3*(e*e/2+1)),r=setInterval(function(){o+=100/(e*e/2),document.querySelector(".progress-bar span").style.width=o+"%"},1e3),setTimeout(function(){document.querySelector("#calcudoku-grid").style.opacity=1},300)):"log"===t.data[0]?console.log(...t.data.slice(1)):(c=t.data[0],n=t.data[1],u=t.data[2],i(!1))},clearInterval(r),clearTimeout(l),a.postMessage([e,s])}),document.querySelector("#download-button").addEventListener("click",function(){document.querySelector("#calcudoku-grid").style.opacity=0,i(!0),window.open(document.querySelector("#calcudoku-grid").toDataURL(),"_blank"),i(!1),document.querySelector("#calcudoku-grid").style.opacity=1})}();