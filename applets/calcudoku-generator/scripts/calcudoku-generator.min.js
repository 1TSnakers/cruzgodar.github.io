!function(){"use strict";let e=null,t=document.querySelector("#calcudoku-grid").getContext("2d"),l=[],r=[],o=[],c=null;document.querySelector("#generate-button").addEventListener("click",u);let n=document.querySelectorAll("#grid-size-input, #max-cage-size-input");for(let e=0;e<n.length;e++)n[e].addEventListener("keydown",function(e){13===e.keyCode&&u()});function u(){e=parseInt(document.querySelector("#grid-size-input").value||5);let n=parseInt(document.querySelector("#max-cage-size-input").value||1e3);document.querySelector("#calcudoku-grid").style.opacity=0,document.querySelector(".loading-spinner").style.opacity=0;let u=200*e+9;document.querySelector("#calcudoku-grid").setAttribute("width",u),document.querySelector("#calcudoku-grid").setAttribute("height",u),t.clearRect(0,0,u,u);try{c.terminate()}catch(e){}c=DEBUG?new Worker("/applets/calcudoku-generator/scripts/worker.js"):new Worker("/applets/calcudoku-generator/scripts/worker.min.js"),temporary_web_workers.push(c),c.onmessage=function(e){"done"===e.data[0]?(console.log("Finished!"),document.querySelector(".loading-spinner").style.opacity=0):"first_grid_complete"===e.data[0]?document.querySelector("#calcudoku-grid").style.opacity=1:"log"===e.data[0]?console.log(...e.data.slice(1)):(l=e.data[0],r=e.data[1],o=e.data[2],i(!1))},c.postMessage([e,n]),document.querySelector(".loading-spinner").style.opacity=1}function i(l){let c=200*e+9;l?(t.fillStyle="rgb(255, 255, 255)",t.fillRect(0,0,c,c),t.fillStyle="rgb(0, 0, 0)"):(t.clearRect(0,0,c,c),1===url_vars.theme?1===url_vars.contrast?t.fillStyle="rgb(255, 255, 255)":t.fillStyle="rgb(192, 192, 192)":1===url_vars.contrast?t.fillStyle="rgb(0, 0, 0)":t.fillStyle="rgb(64, 64, 64)");for(let l=0;l<=e;l++)t.fillRect(200*l+4,0,2,c+9),t.fillRect(0,200*l+4,c+9,2);for(let l=0;l<e;l++)for(let r=0;r<e;r++)0!==l&&o[l-1][r]===o[l][r]||t.fillRect(200*r,200*l,210,10),l!==e-1&&o[l+1][r]===o[l][r]||t.fillRect(200*r,200*(l+1),210,10),0!==r&&o[l][r-1]===o[l][r]||t.fillRect(200*r,200*l,10,210),r!==e-1&&o[l][r+1]===o[l][r]||t.fillRect(200*(r+1),200*l,10,210);for(let l=0;l<r.length;l++){let o=[e,e];for(let e=0;e<r[l][2].length;e++){let t=r[l][2][e][0],c=r[l][2][e][1];t<o[0]?o=[t,c]:t===o[0]&&c<o[1]&&(o=[t,c])}let c="",n=null;(c="+"===r[l][0]?r[l][1]+"+":"x"===r[l][0]?r[l][1]+"×":"-"===r[l][0]?r[l][1]+"–":":"===r[l][0]?r[l][1]+"꞉":r[l][1]+"").length<=6?(t.font="50px sans-serif",n=50):(t.font=300/c.length+"px sans-serif",n=300/c.length),t.fillText(c,200*o[1]+15,200*o[0]+n+5)}}document.querySelector("#download-button").addEventListener("click",function(){document.querySelector("#calcudoku-grid").style.opacity=0,i(!0);let e=document.createElement("a");e.download="calcudoku.png",e.href=document.querySelector("#calcudoku-grid").toDataURL(),e.click(),e.remove(),i(!1),document.querySelector("#calcudoku-grid").style.opacity=1})}();