!function(){"use strict";let e=null,t=null,o=document.querySelector("#mandelbrot-zoom").offsetWidth,r=document.querySelector("#output-canvas").offsetWidth,n=50,u=100,a=-.75,l=0,c=0,s=0,d=0,i=0,m=0,p=0,y=3,g=.6,b=[],f=!1,q=0,h=0,S=!1,v=!0,w=[],_=!1;function C(){if(c===m&&0===s&&d===p)return void(v=!0);d!==p&&k();f&&(y/=5,g/=5,u+=150,n+=150,a=q,l=h,f=!1);for(let e=0;e<d;e++)z(e,c,s,d,i);let t=w.flat().sort((function(e,t){return e-t})),o=0;if(100===d){b.push(t[Math.round(.999*t.length)-1]),b.length>10&&b.shift(),o=0;for(let e=0;e<b.length;e++)o+=b[e];o/=b.length}else o=t[Math.round(.9999*t.length)-1];for(let e=0;e<d;e++)w[e]=w[e].map((e=>e/o*255));let r=e.getImageData(0,0,d,d),_=r.data;for(let e=0;e<d;e++)for(let t=0;t<d;t++){let o=w[e][t],r=4*e*d+4*t;_[r]=0,_[r+1]=o,_[r+2]=o,_[r+3]=255}if(e.putImageData(r,0,0),500===d){let e=document.querySelector("#mandelbrot-set").getAttribute("width");document.querySelector("#mandelbrot-set").getContext("2d",{alpha:!1}).drawImage(document.querySelector("#mandelbrot-zoom"),0,0,e,e),f=!0,q=c,h=s,S=!1}m=c,m=c,p=d,S?(S=!1,window.requestAnimationFrame(C)):v=!0}function k(){w=[];for(let e=0;e<d;e++)w[e]=[];document.querySelector("#mandelbrot-zoom").setAttribute("width",d),document.querySelector("#mandelbrot-zoom").setAttribute("height",d),e=document.querySelector("#mandelbrot-zoom").getContext("2d",{alpha:!1})}function z(e,t,o,r,n){for(let u=0;u<r;u++){let a=(u-r/2)/r*g+t,l=-(e-r/2)/r*g+o,c=a,s=l,d=Math.exp(-Math.sqrt(a*a+l*l)),i=0;for(i=0;i<n;i++){let e=2*a*l+s;if(a=a*a-l*l+c,l=e,d+=Math.exp(-Math.sqrt(a*a+l*l)),a*a+l*l>4)break}i===n&&(d=0),w[e][u]=d}}function A(){let o=parseInt(document.querySelector("#dim-input").value||1e3);document.querySelector("#output-canvas").setAttribute("width",o),document.querySelector("#output-canvas").setAttribute("height",o),e=document.querySelector("#output-canvas").getContext("2d",{alpha:!1}),document.querySelector("#progress-bar span").insertAdjacentHTML("afterend","<span></span>"),document.querySelector("#progress-bar span").remove();try{t.terminate()}catch(e){}t=DEBUG?new Worker("/applets/mandelbrot-set-explorer/scripts/worker.js"):new Worker("/applets/mandelbrot-set-explorer/scripts/worker.min.js"),temporary_web_workers.push(t),t.onmessage=function(t){if("progress"===t.data[0])document.querySelector("#progress-bar span").style.width=t.data[1]+"%",100===t.data[1]&&setTimeout((function(){document.querySelector("#progress-bar").style.opacity=0,setTimeout((function(){document.querySelector("#progress-bar").style.marginTop=0,document.querySelector("#progress-bar").style.marginBottom=0}),300)}),600);else{let r=e.getImageData(0,0,o,o),n=r.data;for(let e=0;e<o;e++)for(let r=0;r<o;r++){let u=t.data[0][e][r],a=4*e*o+4*r;n[a]=0,n[a+1]=u,n[a+2]=u,n[a+3]=255}e.putImageData(r,0,0),document.querySelector("#progress-bar").style.opacity=0,setTimeout((function(){document.querySelector("#progress-bar").style.marginTop=0,document.querySelector("#progress-bar").style.marginBottom=0}),300)}},document.querySelector("#progress-bar span").style.width=0,document.querySelector("#progress-bar").style.marginTop="5vh",document.querySelector("#progress-bar").style.marginBottom="5vh",setTimeout((function(){document.querySelector("#progress-bar").style.opacity=1}),600),t.postMessage([c,s,o,u,g])}function L(){o=document.querySelector("#mandelbrot-zoom").offsetWidth,r=document.querySelector("#output-canvas").offsetWidth}!function(){1===url_vars.contrast&&(1===url_vars.theme?(document.querySelector("#mandelbrot-set").style.borderColor="rgb(192, 192, 192)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(192, 192, 192)"):(document.querySelector("#mandelbrot-set").style.borderColor="rgb(64, 64, 64)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(64, 64, 64)"));currently_touch_device&&(document.querySelector("#instructions").innerHTML="Drag along the Mandelbrot set to view that area up close, and release to generate a higher-resolution image.")}(),function(){document.querySelector("#mandelbrot-set").setAttribute("width",o),document.querySelector("#mandelbrot-set").setAttribute("height",o);let e=document.querySelector("#mandelbrot-set").getContext("2d",{alpha:!1}),t=new Image;t.src="/applets/mandelbrot-set-explorer/graphics/mandelbrot-set.png",t.onload=function(){e.drawImage(t,0,0,o,o)}}(),document.querySelector("#generate-button").addEventListener("click",A),document.querySelector("#dim-input").addEventListener("keydown",(function(e){13===e.keyCode&&A()})),document.querySelector("#download-button").addEventListener("click",(function(){let e=document.createElement("a");e.download=s<0?c+" - "+-s+"i.png":c+" + "+s+"i.png";e.href=document.querySelector("#output-canvas").toDataURL(),e.click(),e.remove()})),window.addEventListener("resize",L),temporary_handlers.resize.push(L),setTimeout(L,1e3),document.querySelector("#mandelbrot-set").addEventListener("mousemove",(function(e){if(!1===_){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,r=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;c=(t/o-.5)*y+a,s=((o-r)/o-.5)*y+l,d=100,i=n,S=!0,v&&(v=!1,window.requestAnimationFrame(C))}})),document.querySelector("#mandelbrot-set").addEventListener("click",(function(e){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,r=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;c=(t/o-.5)*y+a,s=((o-r)/o-.5)*y+l,d=500,i=u,_=!0,S=!0,v&&(v=!1,window.requestAnimationFrame(C))})),document.querySelector("#mandelbrot-set").addEventListener("mouseleave",(function(e){_=!1})),function(){let e=0,t=0;document.querySelector("#mandelbrot-set").addEventListener("touchmove",(function(r){r.preventDefault();let u=r.touches[0].clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,m=r.touches[0].clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;e=u,t=m,c=(u/o-.5)*y+a,s=((o-m)/o-.5)*y+l,d=100,i=n,S=!0,v&&(v=!1,window.requestAnimationFrame(C))}),!1),document.querySelector("#mandelbrot-set").addEventListener("touchend",(function(r){r.preventDefault(),c=(e/o-.5)*y+a,s=((o-t)/o-.5)*y+l,d=500,i=u,S=!0,v&&(v=!1,window.requestAnimationFrame(C))}),!1)}(),k(),applet_canvases_to_resize=[document.querySelector("#output-canvas")],applet_canvas_resize_callback=function(){r=document.querySelector("#output-canvas").offsetWidth},set_up_canvas_resizer()}();