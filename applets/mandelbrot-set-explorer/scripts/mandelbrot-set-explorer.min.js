!function(){let small_canvas_size=document.querySelector("#mandelbrot-zoom").offsetWidth,large_canvas_size=document.querySelector("#high-res-mandelbrot-zoom").offsetWidth,small_mandelbrot_zoom_size=75,large_mandelbrot_zoom_size=500,small_mandelbrot_zoom_iterations=50,large_mandelbrot_zoom_iterations=100,anchor_x=-.75,anchor_y=0,current_center_x=0,current_center_y=0,old_zoom_level=3,new_zoom_level=.6,queue_variable_change=!1,temp_anchor_x=0,temp_anchor_y=0,image=[],persist_image=!1;function draw_mandelbrot_zoom(e,t,o,r,n){image=[];for(let e=0;e<o;e++)image[e]=[];1==queue_variable_change&&0==n&&(old_zoom_level/=5,new_zoom_level/=5,large_mandelbrot_zoom_iterations+=150,small_mandelbrot_zoom_iterations+=150,anchor_x=temp_anchor_x,anchor_y=temp_anchor_y,queue_variable_change=!1);let l=0;n?(document.querySelector("#high-res-mandelbrot-zoom").setAttribute("width",o),document.querySelector("#high-res-mandelbrot-zoom").setAttribute("height",o),ctx=document.querySelector("#high-res-mandelbrot-zoom").getContext("2d"),l=large_canvas_size):(document.querySelector("#mandelbrot-zoom").setAttribute("width",o),document.querySelector("#mandelbrot-zoom").setAttribute("height",o),ctx=document.querySelector("#mandelbrot-zoom").getContext("2d"),l=small_canvas_size);for(let n=0;n<o;n++)mandelbrot_zoom_row(n,e,t,o,r);let a=image.flat().sort(function(e,t){return e-t}),m=0;m=o==small_mandelbrot_zoom_size?a[Math.round(.995*a.length)-1]:a[Math.round(.9999*a.length)-1];for(let e=0;e<o;e++)for(let t=0;t<o;t++)image[e][t]=image[e][t]/m*255,ctx.fillStyle="rgb(0,"+image[e][t]+","+image[e][t]+")",ctx.fillRect(t,e,1,1);if(ctx.scale(l/o,l/o),o==large_mandelbrot_zoom_size&&0==n){let o=document.querySelector("#mandelbrot-set").getAttribute("width");document.querySelector("#mandelbrot-set").getContext("2d").drawImage(document.querySelector("#mandelbrot-zoom"),0,0,o,o),queue_variable_change=!0,temp_anchor_x=e,temp_anchor_y=t}n&&prepare_download(e,t)}function mandelbrot_zoom_row(e,t,o,r,n){for(let l=0;l<r;l++){let a=(l-r/2)/r*new_zoom_level+t,m=-(e-r/2)/r*new_zoom_level+o,_=a,c=m,s=Math.exp(-Math.sqrt(a*a+m*m)),d=0;for(d=0;d<n;d++){let e=2*a*m+c;if(a=a*a-m*m+_,m=e,s+=Math.exp(-Math.sqrt(a*a+m*m)),Math.sqrt(a*a+m*m)>2)break}d==n&&(s=0),image[e][l]=s}}function prepare_download(e,t){try{document.querySelector("#download-button").style.opacity=0}catch(e){}setTimeout(function(){try{document.querySelector("#download-button").remove()}catch(e){}let e=document.querySelector("#high-res-mandelbrot-zoom").toDataURL();document.querySelector("#download-location").insertAdjacentHTML("afterend",`\n\t\t\t<div id="download-button" class="animated-opacity" style="display: flex; justify-content: center; opacity: 0; width: 70vw; margin: 0 auto">\n\t\t\t\t<a href="${e}" download="Mandelbrot Zoom.png" class="real-link">\n\t\t\t\t\t<button class="text-button" type="button" onclick="">Download Image</button>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t`),document.querySelector("#download-button").style.opacity=1},300)}function draw_high_res_mandelbrot_zoom(){let e=parseInt(document.querySelector("#dim-input").value||1e3);draw_mandelbrot_zoom(current_center_x,current_center_y,e,large_mandelbrot_zoom_iterations,!0)}function adjust_for_settings(){1==url_vars.contrast&&(1==url_vars.theme?(document.querySelector("#mandelbrot-set").style.borderColor="rgb(192, 192, 192)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(192, 192, 192)",document.querySelector("#high-res-mandelbrot-zoom").style.borderColor="rgb(192, 192, 192)"):(document.querySelector("#mandelbrot-set").style.borderColor="rgb(64, 64, 64)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(64, 64, 64)",document.querySelector("#high-res-mandelbrot-zoom").style.borderColor="rgb(64, 64, 64)"))}function draw_initial_mandelbrot_set(){document.querySelector("#mandelbrot-set").setAttribute("width",small_canvas_size),document.querySelector("#mandelbrot-set").setAttribute("height",small_canvas_size);let e=document.querySelector("#mandelbrot-set").getContext("2d"),t=new Image;t.src="/applets/mandelbrot-set-explorer/graphics/mandelbrot-set.png",t.onload=function(){e.drawImage(t,0,0,small_canvas_size,small_canvas_size)}}function init_listeners_no_touch(){document.querySelector("#mandelbrot-set").addEventListener("mousemove",function(e){if(0==persist_image){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,o=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;draw_mandelbrot_zoom((t/small_canvas_size-.5)*old_zoom_level+anchor_x,((small_canvas_size-o)/small_canvas_size-.5)*old_zoom_level+anchor_y,small_mandelbrot_zoom_size,small_mandelbrot_zoom_iterations,!1)}}),document.querySelector("#mandelbrot-set").addEventListener("click",function(e){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,o=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top,r=(t/small_canvas_size-.5)*old_zoom_level+anchor_x,n=((small_canvas_size-o)/small_canvas_size-.5)*old_zoom_level+anchor_y;draw_mandelbrot_zoom(r,n,large_mandelbrot_zoom_size,large_mandelbrot_zoom_iterations,!1),current_center_x=r,current_center_y=n,persist_image=!0}),document.querySelector("#mandelbrot-set").addEventListener("mouseleave",function(e){persist_image=!1})}function init_listeners_touch(){let e=0,t=0;document.querySelector("#instructions").innerHTML='Drag along the Mandelbrot set to view that area up close, and release to generate a higher-resolution image. For more information on Mandelbrot and Julia sets, have a look at <a href="/blog/4/a-taste-of-chaos.html" onclick="redirect(\'/blog/4/a-taste-of-chaos.html\')">this blog post</a>.',document.querySelector("#instructions a").addEventListener("click",function(e){e.preventDefault()}),document.querySelector("#mandelbrot-set").addEventListener("touchmove",function(o){o.preventDefault();let r=o.touches[0].clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,n=o.touches[0].clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;e=r,t=n,draw_mandelbrot_zoom((r/small_canvas_size-.5)*old_zoom_level+anchor_x,((small_canvas_size-n)/small_canvas_size-.5)*old_zoom_level+anchor_y,small_mandelbrot_zoom_size,small_mandelbrot_zoom_iterations,!1)},!1),document.querySelector("#mandelbrot-set").addEventListener("touchend",function(o){o.preventDefault();let r=(e/small_canvas_size-.5)*old_zoom_level+anchor_x,n=((small_canvas_size-t)/small_canvas_size-.5)*old_zoom_level+anchor_y;draw_mandelbrot_zoom(r,n,large_mandelbrot_zoom_size,large_mandelbrot_zoom_iterations,!1),current_center_x=r,current_center_y=n},!1)}function mandelbrot_zoom_resize(){small_canvas_size=document.querySelector("#mandelbrot-zoom").offsetWidth,large_canvas_size=document.querySelector("#high-res-mandelbrot-zoom").offsetWidth}adjust_for_settings(),draw_initial_mandelbrot_set(),document.querySelector("#generate-button").addEventListener("click",draw_high_res_mandelbrot_zoom),window.addEventListener("resize",mandelbrot_zoom_resize),temporary_handlers.resize.push(mandelbrot_zoom_resize),setTimeout(mandelbrot_zoom_resize,1e3),hasTouch()?init_listeners_touch():init_listeners_no_touch();}()