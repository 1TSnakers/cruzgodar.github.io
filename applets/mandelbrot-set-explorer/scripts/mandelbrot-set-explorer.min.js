!function(){"use strict";let e=null,t=document.querySelector("#mandelbrot-zoom").offsetWidth,o=document.querySelector("#high-res-mandelbrot-zoom").offsetWidth,r=100,n=500,l=50,d=100,u=-.75,c=0,m=0,i=0,a=3,s=.6,b=[],h=!1,g=0,y=0,f=[],q=!1;function S(m,i,q,S,v){f=[];for(let e=0;e<q;e++)f[e]=[];!0===h&&!1===v&&(a/=5,s/=5,d+=150,l+=150,u=g,c=y,h=!1);let z=0;v?(document.querySelector("#high-res-mandelbrot-zoom").setAttribute("width",q),document.querySelector("#high-res-mandelbrot-zoom").setAttribute("height",q),e=document.querySelector("#high-res-mandelbrot-zoom").getContext("2d"),z=o):(document.querySelector("#mandelbrot-zoom").setAttribute("width",q),document.querySelector("#mandelbrot-zoom").setAttribute("height",q),e=document.querySelector("#mandelbrot-zoom").getContext("2d"),z=t);for(let e=0;e<q;e++)p(e,m,i,q,S);let C=f.flat().sort(function(e,t){return e-t}),w=0;if(q===r){b.push(C[Math.round(.999*C.length)-1]),b.length>10&&b.shift(),w=0;for(let e=0;e<b.length;e++)w+=b[e];w/=b.length}else w=C[Math.round(.9999*C.length)-1];for(let e=0;e<q;e++)f[e]=f[e].map(e=>e/w*255);let L=e.getImageData(0,0,q,q),E=L.data;for(let e=0;e<q;e++)for(let t=0;t<q;t++){let o=4*e*q+4*t;E[o]=0,E[o+1]=f[e][t],E[o+2]=f[e][t],E[o+3]=255}if(e.putImageData(L,0,0),q===n&&!1===v){let e=document.querySelector("#mandelbrot-set").getAttribute("width");document.querySelector("#mandelbrot-set").getContext("2d").drawImage(document.querySelector("#mandelbrot-zoom"),0,0,e,e),h=!0,g=m,y=i}}function p(e,t,o,r,n){for(let l=0;l<r;l++){let d=(l-r/2)/r*s+t,u=-(e-r/2)/r*s+o,c=d,m=u,i=Math.exp(-Math.sqrt(d*d+u*u)),a=0;for(a=0;a<n;a++){let e=2*d*u+m;if(d=d*d-u*u+c,u=e,i+=Math.exp(-Math.sqrt(d*d+u*u)),d*d+u*u>4)break}a===n&&(i=0),f[e][l]=i}}function v(){let e=parseInt(document.querySelector("#dim-input").value||1e3);S(m,i,e,d,!0)}function z(){t=document.querySelector("#mandelbrot-zoom").offsetWidth,o=document.querySelector("#high-res-mandelbrot-zoom").offsetWidth}!function(){1===url_vars.contrast&&(1===url_vars.theme?(document.querySelector("#mandelbrot-set").style.borderColor="rgb(192, 192, 192)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(192, 192, 192)",document.querySelector("#high-res-mandelbrot-zoom").style.borderColor="rgb(192, 192, 192)"):(document.querySelector("#mandelbrot-set").style.borderColor="rgb(64, 64, 64)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(64, 64, 64)",document.querySelector("#high-res-mandelbrot-zoom").style.borderColor="rgb(64, 64, 64)"));currently_touch_device&&(document.querySelector("#instructions").innerHTML="Drag along the Mandelbrot set to view that area up close, and release to generate a higher-resolution image.")}(),function(){document.querySelector("#mandelbrot-set").setAttribute("width",t),document.querySelector("#mandelbrot-set").setAttribute("height",t);let e=document.querySelector("#mandelbrot-set").getContext("2d"),o=new Image;o.src="/applets/mandelbrot-set-explorer/graphics/mandelbrot-set.png",o.onload=function(){e.drawImage(o,0,0,t,t)}}(),document.querySelector("#generate-button").addEventListener("click",v),document.querySelector("#dim-input").addEventListener("keydown",function(e){13===e.keyCode&&v()}),document.querySelector("#download-button").addEventListener("click",function(){let e=document.createElement("a");e.download=i<0?m+" - "+-i+"i.png":m+" + "+i+"i.png";e.href=document.querySelector("#high-res-mandelbrot-zoom").toDataURL(),e.click(),e.remove()}),window.addEventListener("resize",z),temporary_handlers.resize.push(z),setTimeout(z,1e3),document.querySelector("#mandelbrot-set").addEventListener("mousemove",function(e){if(!1===q){let o=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,n=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top,d=(o/t-.5)*a+u,m=((t-n)/t-.5)*a+c;S(d,m,r,l,!1)}}),document.querySelector("#mandelbrot-set").addEventListener("click",function(e){let o=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,r=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top,l=(o/t-.5)*a+u,s=((t-r)/t-.5)*a+c;S(l,s,n,d,!1),m=l,i=s,q=!0}),document.querySelector("#mandelbrot-set").addEventListener("mouseleave",function(e){q=!1}),function(){let e=0,o=0;document.querySelector("#mandelbrot-set").addEventListener("touchmove",function(n){n.preventDefault();let d=n.touches[0].clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,m=n.touches[0].clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;e=d,o=m;let i=(d/t-.5)*a+u,s=((t-m)/t-.5)*a+c;S(i,s,r,l,!1)},!1),document.querySelector("#mandelbrot-set").addEventListener("touchend",function(r){r.preventDefault();let l=(e/t-.5)*a+u,s=((t-o)/t-.5)*a+c;S(l,s,n,d,!1),m=l,i=s},!1)}()}();