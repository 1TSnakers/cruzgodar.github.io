!function(){"use strict";let e=null,t=null,o=document.querySelector("#mandelbrot-zoom").offsetWidth,r=document.querySelector("#output-canvas").offsetWidth,n=100,u=500,l=50,a=100,c=-.75,d=0,s=0,m=0,i=0,y=0,p=0,g=0,b=0,q=3,f=.6,h=[],S=!1,w=0,v=0,C=!1,A=!0,k=[],L=!1;function E(){if(s===p&&m===g&&i===b)return void(A=!0);k=[];for(let e=0;e<i;e++)k[e]=[];!0===S&&(q/=5,f/=5,a+=150,l+=150,c=w,d=v,S=!1);document.querySelector("#mandelbrot-zoom").setAttribute("width",i),document.querySelector("#mandelbrot-zoom").setAttribute("height",i),e=document.querySelector("#mandelbrot-zoom").getContext("2d",{alpha:!1});for(let e=0;e<i;e++)z(e,s,m,i,y);let t=k.flat().sort(function(e,t){return e-t}),o=0;if(i===n){h.push(t[Math.round(.999*t.length)-1]),h.length>10&&h.shift(),o=0;for(let e=0;e<h.length;e++)o+=h[e];o/=h.length}else o=t[Math.round(.9999*t.length)-1];for(let e=0;e<i;e++)k[e]=k[e].map(e=>e/o*255);let r=e.getImageData(0,0,i,i),L=r.data;for(let e=0;e<i;e++)for(let t=0;t<i;t++){let o=k[e][t],r=4*e*i+4*t;L[r]=0,L[r+1]=o,L[r+2]=o,L[r+3]=255}if(e.putImageData(r,0,0),i===u){let e=document.querySelector("#mandelbrot-set").getAttribute("width");document.querySelector("#mandelbrot-set").getContext("2d",{alpha:!1}).drawImage(document.querySelector("#mandelbrot-zoom"),0,0,e,e),S=!0,w=s,v=m,C=!1}C?(C=!1,p=s,p=s,b=i,window.requestAnimationFrame(E)):A=!0}function z(e,t,o,r,n){for(let u=0;u<r;u++){let l=(u-r/2)/r*f+t,a=-(e-r/2)/r*f+o,c=l,d=a,s=Math.exp(-Math.sqrt(l*l+a*a)),m=0;for(m=0;m<n;m++){let e=2*l*a+d;if(l=l*l-a*a+c,a=e,s+=Math.exp(-Math.sqrt(l*l+a*a)),l*l+a*a>4)break}m===n&&(s=0),k[e][u]=s}}function B(){let o=parseInt(document.querySelector("#dim-input").value||1e3);document.querySelector("#output-canvas").setAttribute("width",o),document.querySelector("#output-canvas").setAttribute("height",o),e=document.querySelector("#output-canvas").getContext("2d",{alpha:!1}),document.querySelector("#progress-bar span").insertAdjacentHTML("afterend","<span></span>"),document.querySelector("#progress-bar span").remove();try{t.terminate()}catch(e){}t=DEBUG?new Worker("/applets/mandelbrot-set-explorer/scripts/worker.js"):new Worker("/applets/mandelbrot-set-explorer/scripts/worker.min.js"),temporary_web_workers.push(t),t.onmessage=function(t){if("progress"===t.data[0])document.querySelector("#progress-bar span").style.width=t.data[1]+"%",100===t.data[1]&&setTimeout(function(){document.querySelector("#progress-bar").style.opacity=0,setTimeout(function(){document.querySelector("#progress-bar").style.marginTop=0,document.querySelector("#progress-bar").style.marginBottom=0},300)},600);else{let r=e.getImageData(0,0,o,o),n=r.data;for(let e=0;e<o;e++)for(let r=0;r<o;r++){let u=t.data[0][e][r],l=4*e*o+4*r;n[l]=0,n[l+1]=u,n[l+2]=u,n[l+3]=255}e.putImageData(r,0,0),document.querySelector("#progress-bar").style.opacity=0,setTimeout(function(){document.querySelector("#progress-bar").style.marginTop=0,document.querySelector("#progress-bar").style.marginBottom=0},300)}},document.querySelector("#progress-bar span").style.width=0,document.querySelector("#progress-bar").style.marginTop="5vh",document.querySelector("#progress-bar").style.marginBottom="5vh",setTimeout(function(){document.querySelector("#progress-bar").style.opacity=1},600),t.postMessage([s,m,o,a,f])}function M(){o=document.querySelector("#mandelbrot-zoom").offsetWidth,r=document.querySelector("#output-canvas").offsetWidth}!function(){1===url_vars.contrast&&(1===url_vars.theme?(document.querySelector("#mandelbrot-set").style.borderColor="rgb(192, 192, 192)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(192, 192, 192)"):(document.querySelector("#mandelbrot-set").style.borderColor="rgb(64, 64, 64)",document.querySelector("#mandelbrot-zoom").style.borderColor="rgb(64, 64, 64)"));currently_touch_device&&(document.querySelector("#instructions").innerHTML="Drag along the Mandelbrot set to view that area up close, and release to generate a higher-resolution image.")}(),function(){document.querySelector("#mandelbrot-set").setAttribute("width",o),document.querySelector("#mandelbrot-set").setAttribute("height",o);let e=document.querySelector("#mandelbrot-set").getContext("2d",{alpha:!1}),t=new Image;t.src="/applets/mandelbrot-set-explorer/graphics/mandelbrot-set.png",t.onload=function(){e.drawImage(t,0,0,o,o)}}(),document.querySelector("#generate-button").addEventListener("click",B),document.querySelector("#dim-input").addEventListener("keydown",function(e){13===e.keyCode&&B()}),document.querySelector("#download-button").addEventListener("click",function(){let e=document.createElement("a");e.download=m<0?s+" - "+-m+"i.png":s+" + "+m+"i.png";e.href=document.querySelector("#output-canvas").toDataURL(),e.click(),e.remove()}),window.addEventListener("resize",M),temporary_handlers.resize.push(M),setTimeout(M,1e3),document.querySelector("#mandelbrot-set").addEventListener("mousemove",function(e){if(!1===L){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,r=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;s=(t/o-.5)*q+c,m=((o-r)/o-.5)*q+d,i=n,y=l,C=!0,A&&(A=!1,window.requestAnimationFrame(E))}}),document.querySelector("#mandelbrot-set").addEventListener("click",function(e){let t=e.clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,r=e.clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;s=(t/o-.5)*q+c,m=((o-r)/o-.5)*q+d,i=u,y=a,L=!0,C=!0,A&&(A=!1,window.requestAnimationFrame(E))}),document.querySelector("#mandelbrot-set").addEventListener("mouseleave",function(e){L=!1}),function(){let e=0,t=0;document.querySelector("#mandelbrot-set").addEventListener("touchmove",function(r){r.preventDefault();let u=r.touches[0].clientX-document.querySelector("#mandelbrot-set").getBoundingClientRect().left,a=r.touches[0].clientY-document.querySelector("#mandelbrot-set").getBoundingClientRect().top;e=u,t=a,s=(u/o-.5)*q+c,m=((o-a)/o-.5)*q+d,i=n,y=l,C=!0,A&&(A=!1,window.requestAnimationFrame(E))},!1),document.querySelector("#mandelbrot-set").addEventListener("touchend",function(r){r.preventDefault(),s=(e/o-.5)*q+c,m=((o-t)/o-.5)*q+d,i=u,y=a,C=!0,A&&(A=!1,window.requestAnimationFrame(E))},!1)}()}();