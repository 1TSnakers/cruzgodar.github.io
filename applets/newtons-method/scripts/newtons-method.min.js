!function(){"use strict";let e=null,t=0,o=[],n=[],r=document.querySelector("#newtons-method-plot").getContext("2d",{alpha:!1}),l=null,u=!1,a=!0,c=[],s=-1,d=-1,i=document.querySelector("#root-selector").offsetWidth,m=document.querySelector("#root-selector").offsetHeight,h=17.5;const p=.05;let y=[],f=[],g=[];const S=[[255,0,0],[0,255,0],[0,0,255],[0,255,255],[255,0,255],[255,255,0],[127,0,255],[255,127,0]];function q(){if(o.length===n.length&&e===t){let e=!1;for(let t=0;t<o.length;t++)if(o[t][0]!==n[t][0]||o[t][1]!==n[t][1]){e=!0;break}if(!e)return void(a=!0)}document.querySelector("#newtons-method-plot").setAttribute("width",e),document.querySelector("#newtons-method-plot").setAttribute("height",e);for(let t=0;t<e;t++){f[t]=[],y[t]=[];for(let o=0;o<e;o++)y[t][o]=0,f[t][o]=-1}for(let t=0;t<e;t++)for(let n=0;n<e;n++){if(0!==y[t][n])continue;let r=[(n-e/2)/e*4,-(t-e/2)/e*4],l=[0,0],u=[];for(let a=0;a<100;a++){let c=w(k(o,r),M(E(o,r)));l[0]=r[0],l[1]=r[1],r[0]=r[0]-c[0],r[1]=r[1]-c[1];let s=Math.floor(r[0]/4*e+e/2),d=Math.floor(-(r[1]/4*e-e/2));d>=0&&d<e&&s>=0&&s<e&&u.push([[d,s],a+1]);let i=!1;for(let e=0;e<o.length;e++){let c=v([r[0]-o[e][0],r[1]-o[e][1]]);if(c<=p*p){let r=v([l[0]-o[e][0],l[1]-o[e][1]]),s=(Math.log(p)-.5*Math.log(c))/(.5*Math.log(r)-.5*Math.log(c));f[t][n]=e,y[t][n]=a-s;for(let t=0;t<u.length;t++)y[u[t][0][0]][u[t][0][1]]=a-s-u[t][1],f[u[t][0][0]][u[t][0][1]]=e;i=!0;break}}if(i)break}}!function(){let t=0,n=1/0;for(let o=0;o<e;o++)for(let r=0;r<e;r++)y[o][r]>t&&(t=y[o][r]),y[o][r]<n&&(n=y[o][r]);if(100===e){g.push(t),g.length>10&&g.shift();let e=0;for(let t=0;t<g.length;t++)e+=g[t];t=e/g.length}let l=r.getImageData(0,0,e,e),u=l.data;for(let r=0;r<e;r++)for(let l=0;l<e;l++){y[r][l]-=n,y[r][l]/=t-n,y[r][l]=1-y[r][l],y[r][l]=Math.pow(y[r][l],1+o.length/4),y[r][l]>=0||y[r][l]<=1||(y[r][l]=1);let a=4*r*e+4*l,c=f[r][l];-1!==c?(u[a]=S[c][0]*y[r][l],u[a+1]=S[c][1]*y[r][l],u[a+2]=S[c][2]*y[r][l],u[a+3]=255):(u[a]=0,u[a+1]=0,u[a+2]=0,u[a+3]=255)}r.putImageData(l,0,0)}(),u?(u=!1,n=JSON.parse(JSON.stringify(o)),t=e,window.requestAnimationFrame(q)):a=!0}function b(){e=parseInt(document.querySelector("#dim-input").value||1e3),document.querySelector("#newtons-method-plot").setAttribute("width",e),document.querySelector("#newtons-method-plot").setAttribute("height",e),document.querySelector("#progress-bar span").insertAdjacentHTML("afterend","<span></span>"),document.querySelector("#progress-bar span").remove();try{l.terminate()}catch(e){}l=DEBUG?new Worker("/applets/newtons-method/scripts/worker.js"):new Worker("/applets/newtons-method/scripts/worker.min.js"),temporary_web_workers.push(l),l.onmessage=function(t){if("progress"===t.data[0])document.querySelector("#progress-bar span").style.width=t.data[1]+"%",100===t.data[1]&&setTimeout((function(){document.querySelector("#progress-bar").style.opacity=0,setTimeout((function(){document.querySelector("#progress-bar").style.marginTop=0,document.querySelector("#progress-bar").style.marginBottom=0}),300)}),600);else{let n=r.getImageData(0,0,e,e),l=n.data,u=t.data[1].length;for(let e=0;e<u;e++)l[e]=t.data[1][e];r.putImageData(n,0,0),function(e){let t=[[-e[0][0],-e[0][1]],[1,0]];for(let o=1;o<e.length;o++){let n=JSON.parse(JSON.stringify(t));t.unshift([0,0]);for(let r=0;r<n.length;r++){let l=w([-e[o][0],-e[o][1]],n[r]);t[r][0]+=l[0],t[r][1]+=l[1]}}let o="\\(f(z) = ",n=0,r=1;document.querySelector("#polynomial-label-1").textContent="",document.querySelector("#polynomial-label-2").textContent="",document.querySelector("#polynomial-label-3").textContent="";for(let e=t.length-1;e>=0;e--){let l=!0;if(n++,t[e][0]=Math.round(100*t[e][0])/100,t[e][1]=Math.round(100*t[e][1])/100,0===t[e][0]&&0===t[e][1])l=!1,n--;else if(0===t[e][1]){let n=Math.abs(t[e][0]);1===n&&e>0?t[e][0]>0&&e===t.length-1?o+="":t[e][0]>0?o+=" + ":t[e][0]<0&&(o+=" - "):t[e][0]>0&&e===t.length-1?o+=""+n:t[e][0]>0?o+=" + "+n:t[e][0]<0&&(o+=" - "+n)}else if(0===t[e][0]){let n=Math.abs(t[e][1]);1===n&&e>0?t[e][1]>0&&e===t.length-1?o+="i":t[e][1]>0?o+=" + i":t[e][1]<0&&(o+=" - i"):t[e][1]>0&&e===t.length-1?o+=n+"i":t[e][1]>0?o+=` + ${n}i`:t[e][1]<0&&(o+=` - ${n}i`)}else e===t.length-1?t[e][1]>0?o+=`(${t[e][0]} + ${t[e][1]}i)`:o+=`(${t[e][0]} - ${Math.abs(t[e][1])}i)`:t[e][1]>0?o+=` + (${t[e][0]} + ${t[e][1]}i)`:o+=` + (${t[e][0]} - ${Math.abs(t[e][1])}i)`;l&&(e>1?o+="z^"+e:1===e&&(o+="z")),3===n&&(o+="\\)",document.querySelector("#polynomial-label-"+r).textContent=o,o="\\(",n=0,r++)}4!==r&&(o+="\\)",document.querySelector("#polynomial-label-"+r).textContent=o);typeset_math()}(o),function(){let e=document.createElement("a");e.download="newtons-method.png",e.href=document.querySelector("#newtons-method-plot").toDataURL(),e.click(),e.remove()}()}},document.querySelector("#progress-bar span").style.width=0,document.querySelector("#progress-bar").style.marginTop="5vh",document.querySelector("#progress-bar").style.marginBottom="5vh",setTimeout((function(){document.querySelector("#progress-bar").style.opacity=1}),600),l.postMessage([e,o])}function v(e){return e[0]*e[0]+e[1]*e[1]}function w(e,t){return[e[0]*t[0]-e[1]*t[1],e[0]*t[1]+e[1]*t[0]]}function M(e){let t=v(e);return[1/t*e[0],-1/t*e[1]]}function k(e,t){let o=[1,0];for(let n=0;n<e.length;n++)o=w(o,[t[0]-e[n][0],t[1]-e[n][1]]);return o}function E(e,t){let o=k(e,t),n=k(e,[t[0]-.001,t[1]]);return o[0]-=n[0],o[1]-=n[1],o[0]/=.001,o[1]/=.001,o}function x(e){s=-1;for(let t=0;t<c.length;t++)if(e.target.id==="root-marker-"+t){e.preventDefault(),g=[],s=t;break}}function _(t){-1!==s&&(document.body.style.WebkitUserSelect="",e=500,u=!0,a&&(a=!1,window.requestAnimationFrame(q)),document.querySelector("#polynomial-label-1").textContent="",document.querySelector("#polynomial-label-2").textContent="",document.querySelector("#polynomial-label-3").textContent="",d=s,document.querySelector("#root-a-input").value=Math.round(1e3*o[d][0])/1e3,document.querySelector("#root-b-input").value=Math.round(1e3*o[d][1])/1e3,document.querySelector("#root-setter").style.pointerEvents="auto",document.querySelector("#root-setter").style.opacity=1),s=-1}function C(t){if(-1===s)return;let n=null,r=null,l=document.querySelector("#root-selector").getBoundingClientRect();"touchmove"===t.type?(n=t.touches[0].clientY-l.top,r=t.touches[0].clientX-l.left):(n=t.clientY-l.top,r=t.clientX-l.left),n<h&&(n=h),n>m-h&&(n=m-h),r<h&&(r=h),r>i-h&&(r=i-h),c[s].style.transform=`translate3d(${r-h}px, ${n-h}px, 0)`;let d=(r-i/2)/i*4,p=-(n-m/2)/m*4;o[s][0]=d,o[s][1]=p,e=100,u=!0,a&&(a=!1,window.requestAnimationFrame(q))}function $(){o[d][0]=parseFloat(document.querySelector("#root-a-input").value)||0,o[d][1]=parseFloat(document.querySelector("#root-b-input").value)||0;let t=Math.floor(m*(1-(o[d][1]/4+.5))),n=Math.floor(i*(o[d][0]/4+.5));c[d].style.transform=`translate3d(${n-h}px, ${t-h}px, 0)`,e=100,q()}function L(){i=document.querySelector("#root-selector").offsetWidth,m=document.querySelector("#root-selector").offsetHeight;document.querySelector("#root-selector").getBoundingClientRect();for(let e=0;e<o.length;e++){let t=Math.floor(m*(1-(o[e][1]/4+.5))),n=Math.floor(i*(o[e][0]/4+.5));c[e].style.transform=`translate3d(${n-h}px, ${t-h}px, 0)`}}!function(){1===url_vars.contrast&&(1===url_vars.theme?document.querySelector("#newtons-method-plot").style.borderColor="rgb(192, 192, 192)":document.querySelector("#newtons-method-plot").style.borderColor="rgb(64, 64, 64)");add_style("\n\t\t\t.root-marker.hover\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\t\n\t\t\t}\n\t\t\t\n\t\t\t.root-marker:not(:hover):focus\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\n\t\t\t\toutline: none;\n\t\t\t}\n\t\t",!0)}(),document.documentElement.addEventListener("touchstart",x,!1),document.documentElement.addEventListener("touchmove",C,!1),document.documentElement.addEventListener("touchend",_,!1),document.documentElement.addEventListener("mousedown",x,!1),document.documentElement.addEventListener("mousemove",C,!1),document.documentElement.addEventListener("mouseup",_,!1),temporary_handlers.touchstart.push(x),temporary_handlers.touchmove.push(C),temporary_handlers.touchend.push(_),temporary_handlers.mousedown.push(x),temporary_handlers.mousemove.push(C),temporary_handlers.mouseup.push(_),document.querySelector("#root-a-input").addEventListener("input",$),document.querySelector("#root-b-input").addEventListener("input",$),document.querySelector("#root-a-input").addEventListener("keydown",(function(t){13===t.keyCode&&(e=500,q())})),document.querySelector("#root-b-input").addEventListener("keydown",(function(t){13===t.keyCode&&(e=500,q())})),document.querySelector("#add-marker-button").addEventListener("click",(function(){if(o.length===S.length)return;let t=document.createElement("div");t.classList.add("root-marker"),t.id="root-marker-"+c.length,t.style.transform=`translate3d(${i/2-h}px, ${m/2-h}px, 0)`,document.querySelector("#root-selector").appendChild(t),c.push(t),o.push([0,0]),g=[],e=100,q()})),document.querySelector("#spread-markers-button").addEventListener("click",(function(t=!0){document.querySelector("#polynomial-label-1").textContent="",document.querySelector("#polynomial-label-2").textContent="",document.querySelector("#polynomial-label-3").textContent="";for(let e=0;e<o.length;e++){e<o.length/2||o.length%2==1?(o[e][0]=Math.cos(2*Math.PI*2*e/o.length),o[e][1]=Math.sin(2*Math.PI*2*e/o.length)):(o[e][0]=Math.cos(2*Math.PI*(2*e+1)/o.length),o[e][1]=Math.sin(2*Math.PI*(2*e+1)/o.length));let t=Math.floor(m*(1-(o[e][1]/4+.5))),n=Math.floor(i*(o[e][0]/4+.5));c[e].style.transform=`translate3d(${n-h}px, ${t-h}px, 0)`}e=t?500:100;q()})),document.querySelector("#generate-high-res-plot-button").addEventListener("click",b),document.querySelector("#dim-input").addEventListener("keydown",(function(e){13===e.keyCode&&b()})),window.addEventListener("resize",L),temporary_handlers.resize.push(L),applet_canvases_to_resize=[document.querySelector("#newtons-method-plot"),document.querySelector("#root-selector")],applet_canvas_resize_callback=function(){e=document.querySelector("#newtons-method-plot").offsetWidth,i=document.querySelector("#root-selector").offsetWidth,m=document.querySelector("#root-selector").offsetHeight,L()},set_up_canvas_resizer()}();