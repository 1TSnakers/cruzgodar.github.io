!function(){"use strict";let t=null,e=[],o=100,n=document.querySelector("#newtons-method-plot").getContext("2d"),r=[],l=-1,u=document.querySelector("#root-selector").offsetWidth,c=document.querySelector("#root-selector").offsetHeight;const d=.05;let a=[],s=[],h=[];const m=[[255,0,0],[0,255,0],[0,0,255],[0,255,255],[255,0,255],[255,255,0],[127,0,255],[255,127,0]];function i(r){document.querySelector("#newtons-method-plot").setAttribute("width",t),document.querySelector("#newtons-method-plot").setAttribute("height",t);for(let e=0;e<t;e++){s[e]=[],a[e]=[];for(let o=0;o<t;o++)a[e][o]=0,s[e][o]=-1}for(let e=0;e<t;e++)for(let n=0;n<t;n++){if(0!==a[e][n])continue;let l=[(n-t/2)/t*4,-(e-t/2)/t*4],u=[0,0],c=[];for(let h=0;h<o;h++){let o=g(v(r,l),y(E(r,l)));u[0]=l[0],u[1]=l[1],l[0]=l[0]-o[0],l[1]=l[1]-o[1];let m=Math.floor(l[0]/4*t+t/2),i=Math.floor(-(l[1]/4*t-t/2));i>=0&&i<t&&m>=0&&m<t&&c.push([[i,m],h+1]);let f=!1;for(let t=0;t<r.length;t++){let o=p([l[0]-r[t][0],l[1]-r[t][1]]);if(o<=d*d){let l=p([u[0]-r[t][0],u[1]-r[t][1]]),m=(Math.log(d)-.5*Math.log(o))/(.5*Math.log(l)-.5*Math.log(o));s[e][n]=t,a[e][n]=h-m;for(let e=0;e<c.length;e++)a[c[e][0][0]][c[e][0][1]]=h-m-c[e][1],s[c[e][0][0]][c[e][0][1]]=t;f=!0;break}}if(f)break}}!function(){let o=0,r=1/0;for(let e=0;e<t;e++)for(let n=0;n<t;n++)a[e][n]>o&&(o=a[e][n]),a[e][n]<r&&(r=a[e][n]);if(100===t){h.push(o),h.length>10&&h.shift();let t=0;for(let e=0;e<h.length;e++)t+=h[e];o=t/h.length}let l=n.getImageData(0,0,t,t),u=l.data;for(let n=0;n<t;n++)for(let l=0;l<t;l++){a[n][l]-=r,a[n][l]/=o-r,a[n][l]=1-a[n][l],a[n][l]=Math.pow(a[n][l],1+e.length/4),a[n][l]>=0||a[n][l]<=1||(a[n][l]=1);let c=4*n*t+4*l,d=s[n][l];-1!==d?(u[c]=m[d][0]*a[n][l],u[c+1]=m[d][1]*a[n][l],u[c+2]=m[d][2]*a[n][l],u[c+3]=255):(u[c]=0,u[c+1]=0,u[c+2]=0,u[c+3]=255)}n.putImageData(l,0,0)}()}function f(){t=parseInt(document.querySelector("#dim-input").value||1e3),i(e),function(){let t=document.createElement("a");t.download="newtons-method.png",t.href=document.querySelector("#newtons-method-plot").toDataURL(),t.click(),t.remove()}()}function p(t){return t[0]*t[0]+t[1]*t[1]}function g(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function y(t){let e=p(t);return[1/e*t[0],-1/e*t[1]]}function v(t,e){let o=[1,0];for(let n=0;n<t.length;n++)o=g(o,[e[0]-t[n][0],e[1]-t[n][1]]);return o}function E(t,e){let o=v(t,e),n=v(t,[e[0]-.001,e[1]]);return o[0]-=n[0],o[1]-=n[1],o[0]/=.001,o[1]/=.001,o}function k(t){l=-1;for(let e=0;e<r.length;e++)if(t.target.id===`root-marker-${e}`){t.preventDefault(),h=[],l=e;break}}function M(o){-1!==l&&(document.body.style.WebkitUserSelect="",t=500,i(e)),l=-1}function b(o){if(-1===l)return;let n=null,d=null,a=document.querySelector("#root-selector").getBoundingClientRect();"touchmove"===o.type?(n=o.touches[0].clientY-a.top,d=o.touches[0].clientX-a.left):(n=o.clientY-a.top,d=o.clientX-a.left),n<24&&(n=24),n>c-24&&(n=c-24),d<24&&(d=24),d>u-24&&(d=u-24),r[l].style.transform=`translate3d(${d-24}px, ${n-24}px, 0)`;let s=(d-u/2)/u*4,h=-(n-c/2)/c*4;e[l][0]=s,e[l][1]=h,t=100,i(e)}!function(){1===url_vars.contrast&&(1===url_vars.theme?document.querySelector("#newtons-method-plot").style.borderColor="rgb(192, 192, 192)":document.querySelector("#newtons-method-plot").style.borderColor="rgb(64, 64, 64)");hasTouch()||add_style("\n\t\t\t\t.root-marker:hover\n\t\t\t\t{\n\t\t\t\t\tbackground-color: rgb(127, 127, 127);\t\n\t\t\t\t}\n\t\t\t",!0)}(),document.documentElement.addEventListener("touchstart",k,!1),document.documentElement.addEventListener("touchmove",b,!1),document.documentElement.addEventListener("touchend",M,!1),document.documentElement.addEventListener("mousedown",k,!1),document.documentElement.addEventListener("mousemove",b,!1),document.documentElement.addEventListener("mouseup",M,!1),temporary_handlers.touchstart.push(k),temporary_handlers.touchmove.push(b),temporary_handlers.touchend.push(M),temporary_handlers.mousedown.push(k),temporary_handlers.mousemove.push(b),temporary_handlers.mouseup.push(M),document.querySelector("#add-marker-button").addEventListener("click",function(){if(e.length===m.length)return;let o=document.createElement("div");o.classList.add("root-marker"),o.id=`root-marker-${r.length}`,o.style.transform=`translate3d(${u/2-24}px, ${c/2-24}px, 0)`,document.querySelector("#root-selector").appendChild(o),r.push(o),e.push([0,0]),h=[],t=100,i(e)}),document.querySelector("#spread-markers-button").addEventListener("click",function(o=!0){for(let t=0;t<e.length;t++){t<e.length/2||e.length%2==1?(e[t][0]=Math.cos(2*Math.PI*2*t/e.length),e[t][1]=Math.sin(2*Math.PI*2*t/e.length)):(e[t][0]=Math.cos(2*Math.PI*(2*t+1)/e.length),e[t][1]=Math.sin(2*Math.PI*(2*t+1)/e.length));let o=Math.floor(c*(1-(e[t][1]/4+.5))),n=Math.floor(u*(e[t][0]/4+.5));r[t].style.transform=`translate3d(${n-24}px, ${o-24}px, 0)`}t=o?500:100;i(e)}),document.querySelector("#generate-high-res-plot-button").addEventListener("click",f),document.querySelector("#dim-input").addEventListener("keydown",function(t){13===t.keyCode&&f()})}();