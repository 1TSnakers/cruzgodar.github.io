!function(){"use strict";let t=document.querySelector("#output-canvas").getContext("webgl"),e=100,n=20,i=2e3,o=50;document.querySelector("#output-canvas").setAttribute("width",i),document.querySelector("#output-canvas").setAttribute("height",i);let r=document.querySelectorAll("#num-julias-input, #julia-size-input");for(let t=0;t<r.length;t++)r[t].addEventListener("keydown",function(t){13===t.keyCode&&c()});document.querySelector("#generate-button").addEventListener("click",c),document.querySelector("#download-button").addEventListener("click",function(){c();let t=document.createElement("a");t.download="a-julia-set-mosaic.png",t.href=document.querySelector("#output-canvas").toDataURL(),t.click(),t.remove()}),applet_canvases_to_resize=[document.querySelector("#output-canvas")],applet_canvas_true_fullscreen=!1,set_up_canvas_resizer(),setTimeout(function(){let e=l(t,t.VERTEX_SHADER,a),n=l(t,t.FRAGMENT_SHADER,u);s=t.createProgram(),t.attachShader(s,e),t.attachShader(s,n),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(console.log(`Couldn't link shader program: ${t.getShaderInfoLog(shader)}`),t.deleteProgram(s));t.useProgram(s);let o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,0,-1,1,0,1,-1,0,1,1,0]),t.STATIC_DRAW),s.position_attribute=t.getAttribLocation(s,"position"),t.enableVertexAttribArray(s.position_attribute),t.vertexAttribPointer(s.position_attribute,3,t.FLOAT,!1,0,0),s.julia_sets_per_side_uniform=t.getUniformLocation(s,"julia_sets_per_side"),s.julia_set_size_uniform=t.getUniformLocation(s,"julia_set_size"),s.image_size_uniform=t.getUniformLocation(s,"image_size"),s.num_iterations_uniform=t.getUniformLocation(s,"num_iterations"),t.viewport(0,0,i,i)},500);const a="\n\t\tattribute vec3 position;\n\t\tvarying vec2 uv;\n\n\t\tvoid main(void)\n\t\t{\n\t\t\tgl_Position = vec4(position, 1.0);\n\n\t\t\t//Interpolate quad coordinates in the fragment shader.\n\t\t\tuv = position.xy;\n\t\t}\n\t",u="\n\t\tprecision highp float;\n\t\t\n\t\tvarying vec2 uv;\n\t\t\n\t\tuniform float julia_sets_per_side;\n\t\tuniform float julia_set_size;\n\t\tuniform float image_size;\n\t\tuniform int num_iterations;\n\t\t\n\t\t\n\t\t\n\t\tvoid main(void)\n\t\t{\n\t\t\tfloat a = (floor((uv.x + 1.0) / 2.0 * julia_sets_per_side) / julia_sets_per_side * 2.0 - 1.0) * 1.5 - .75;\n\t\t\tfloat b = (floor((uv.y + 1.0) / 2.0 * julia_sets_per_side) / julia_sets_per_side * 2.0 - 1.0) * 1.5;\n\t\t\t\n\t\t\tvec2 z = vec2((mod((uv.x + 1.0) / 2.0 * image_size, julia_set_size) / julia_set_size * 2.0 - 1.0) * 1.5, (mod((uv.y + 1.0) / 2.0 * image_size, julia_set_size) / julia_set_size * 2.0 - 1.0) * 1.5);\n\t\t\tfloat brightness = exp(-length(z));\n\t\t\t\n\t\t\tvec3 color = normalize(vec3(abs(z.x + z.y) / 2.0, abs(z.x) / 2.0, abs(z.y) / 2.0) + .1 / length(z) * vec3(1.0, 1.0, 1.0));\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfor (int iteration = 0; iteration < 100; iteration++)\n\t\t\t{\n\t\t\t\tif (iteration == num_iterations)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (length(z) >= 2.0)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tz = vec2(z.x * z.x - z.y * z.y + a, 2.0 * z.x * z.y + b);\n\t\t\t\t\n\t\t\t\tbrightness += exp(-length(z));\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tgl_FragColor = vec4(brightness / 10.0 * color, 1.0);\n\t\t}\n\t";let s=null;function l(t,e,n){let i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||(console.log(`Couldn't load shader: ${t.getProgramInfoLog(shaderProgram)}`),t.deleteShader(i)),i}function c(){e=parseInt(document.querySelector("#num-julias-input").value||100),n=parseInt(document.querySelector("#julia-size-input").value||20),i=e*n,document.querySelector("#output-canvas").setAttribute("width",i),document.querySelector("#output-canvas").setAttribute("height",i),t.viewport(0,0,i,i),t.uniform1f(s.julia_sets_per_side_uniform,e),t.uniform1f(s.julia_set_size_uniform,n),t.uniform1f(s.image_size_uniform,e*n),t.uniform1i(s.num_iterations_uniform,o),t.drawArrays(t.TRIANGLE_STRIP,0,4)}}();