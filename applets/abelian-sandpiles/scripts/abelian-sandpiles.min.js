!function(){"use strict";let e=null,t=document.querySelector("#sandpile-graph").getContext("2d"),r=5,n=null;function l(){let l=parseInt(document.querySelector("#num-grains-input").value||1e4),o=document.querySelector("#toggle-maximum-speed-checkbox").checked;(e=Math.floor(Math.sqrt(l))+2)%2==0&&e++;let a=.8*Math.min(window_width,window_height);r=Math.ceil(a/e),document.querySelector("#sandpile-graph").setAttribute("width",e*r),document.querySelector("#sandpile-graph").setAttribute("height",e*r),t.fillStyle="rgb(0, 0, 0)",t.fillRect(0,0,e*r,e*r);try{n.terminate()}catch(e){}n=DEBUG?new Worker("/applets/abelian-sandpiles/scripts/worker.js"):new Worker("/applets/abelian-sandpiles/scripts/worker.min.js"),temporary_web_workers.push(n),n.onmessage=function(n){if("done"===n.data[0])console.log("Finished");else if("log"===n.data[0])console.log(...n.data.slice(1));else{let l=n.data[0];for(let n=0;n<e;n++)for(let o=0;o<e;o++)t.fillStyle=l[n][o],t.fillRect(o*r,n*r,r,r)}},n.postMessage([e,l,o])}1===url_vars.contrast&&(1===url_vars.theme?document.querySelector("#sandpile-graph").style.borderColor="rgb(192, 192, 192)":document.querySelector("#sandpile-graph").style.borderColor="rgb(64, 64, 64)"),document.querySelector("#generate-button").addEventListener("click",l),document.querySelector("#num-grains-input").addEventListener("keydown",function(e){13===e.keyCode&&l()}),document.querySelector("#download-button").addEventListener("click",function(){let e=document.createElement("a");e.download="abelian-sandpiles.png",e.href=document.querySelector("#sandpile-graph").toDataURL(),e.click(),e.remove()})}();