!function(){"use strict";let e=null,t=document.querySelector("#output-canvas").getContext("2d",{alpha:!1}),n=5,a=null;function r(){let r=parseInt(document.querySelector("#num-grains-input").value||1e4),o=document.querySelector("#toggle-maximum-speed-checkbox").checked;(e=Math.floor(Math.sqrt(r))+2)%2==0&&e++;let s=Math.min(window_width,window_height);n=Math.ceil(s/e),document.querySelector("#output-canvas").setAttribute("width",e*n),document.querySelector("#output-canvas").setAttribute("height",e*n),t.fillStyle="rgb(0, 0, 0)",t.fillRect(0,0,e*n,e*n);try{a.terminate()}catch(e){}a=DEBUG?new Worker("/applets/abelian-sandpiles/scripts/worker.js"):new Worker("/applets/abelian-sandpiles/scripts/worker.min.js"),temporary_web_workers.push(a),a.onmessage=function(a){if("done"===a.data[0])console.log("Finished");else if("log"===a.data[0])console.log(...a.data.slice(1));else{let r=a.data[0];for(let a=0;a<e;a++)for(let o=0;o<e;o++)t.fillStyle=r[a][o],t.fillRect(o*n,a*n,n,n)}},a.postMessage([e,r,o])}document.querySelector("#generate-button").addEventListener("click",r),document.querySelector("#num-grains-input").addEventListener("keydown",function(e){13===e.keyCode&&r()}),document.querySelector("#download-button").addEventListener("click",function(){let e=document.createElement("a");e.download="abelian-sandpiles.png",e.href=document.querySelector("#output-canvas").toDataURL(),e.click(),e.remove()}),"Chrome"!==browser_name&&"Opera"!==browser_name||function(){let e=document.querySelector("main").children;(e=e[e.length-1].children)[e.length-1].insertAdjacentHTML("afterend",'\n\t\t\t<div data-aos="fade-up" style="margin-top: 10vh">\n\t\t\t\t<p class="body-text">\n\t\t\t\t\tYour browser treats canvases in a way that may make this applet stutter excessively. If this happens, try temporarily turning off hardware acceleration in the browser&#x2019;s settings.\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t'),aos_resize()}(),applet_canvases_to_resize=[document.querySelector("#output-canvas")],applet_canvas_true_fullscreen=!1,set_up_canvas_resizer()}();