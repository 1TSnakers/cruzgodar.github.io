!function(){"use strict";let e=new Wilson(Page.element.querySelector("#output-canvas"),{renderer:"cpu",canvas_width:1e3,canvas_height:1e3,use_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png"}),t=null,n=5,a=null;Page.element.querySelector("#generate-button").addEventListener("click",s);let l=Page.element.querySelector("#num-grains-input");l.addEventListener("keydown",e=>{13===e.keyCode&&s()}),Page.element.querySelector("#download-button").addEventListener("click",()=>{e.download_frame("an-abelian-sandpile.png")});let r=Page.element.querySelector("#toggle-maximum-speed-checkbox");function s(){let s=parseInt(l.value||1e4),i=r.checked;(t=Math.floor(Math.sqrt(s))+2)%2==0&&t++;let o=Math.min(Page.Layout.window_width,Page.Layout.window_height);n=Math.ceil(o/t),e.change_canvas_size(t*n,t*n),e.ctx.fillStyle="rgb(0, 0, 0)",e.ctx.fillRect(0,0,t*n,t*n);try{a.terminate()}catch(e){}a=DEBUG?new Worker("/applets/abelian-sandpiles/scripts/worker.js"):new Worker("/applets/abelian-sandpiles/scripts/worker.min.js"),Page.temporary_web_workers.push(a),a.onmessage=function(a){if("done"===a.data[0])console.log("Finished");else if("log"===a.data[0])console.log(...a.data.slice(1));else{let l=a.data[0];for(let a=0;a<t;a++)for(let r=0;r<t;r++)e.ctx.fillStyle=l[a][r],e.ctx.fillRect(r*n,a*n,n,n)}},a.postMessage([t,s,i])}"Chrome"!==Browser.name&&"Opera"!==Browser.name||function(){let e=Page.element.querySelector("main").children;(e=e[e.length-1].children)[e.length-1].insertAdjacentHTML("afterend",'\n\t\t\t<div data-aos="fade-up" style="margin-top: 10vh">\n\t\t\t\t<p class="body-text">\n\t\t\t\t\tYour browser treats canvases in a way that may make this applet stutter excessively. If this happens, try temporarily turning off hardware acceleration in the browser&#x2019;s settings.\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t'),Page.Load.AOS.on_resize()}()}();