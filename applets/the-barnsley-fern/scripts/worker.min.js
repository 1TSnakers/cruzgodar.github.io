"use strict";onmessage=async function(r){grid_size=r.data[0],num_iterations=r.data[1],await draw_fern()};let grid_size=null,num_iterations=null,fern_graph=null,randomization_coefficients=[.1,.1,.1,.1,.5,.5],transformation_coefficients=[[0,0,0,.16,0,0],[.85,.04,-.04,.85,0,1.6],[.2,-.26,.23,.22,0,1.6],[-.15,.28,.26,.24,0,.44]],current_x=0,current_y=0;const min_x=-6,max_x=6,min_y=-1,max_y=11;function draw_fern(){return new Promise(function(r,n){fern_graph=new Uint8ClampedArray(grid_size*grid_size*4);for(let r=0;r<grid_size;r++)for(let n=0;n<grid_size;n++)fern_graph[4*(grid_size*r+n)+3]=255;for(let r=0;r<num_iterations;r++){r%Math.floor(num_iterations/10)==0&&postMessage([fern_graph]);let n=Math.random(),t=3;if(n<.01?t=0:n<.86?t=1:n<.93&&(t=2),affine_transformation(t),current_x>=max_x||current_x<=min_x||current_y>=max_y||current_y<=min_y)continue;let e=(current_x-min_x)/(max_x-min_x);e=Math.floor(grid_size*e);let i=(current_y-min_y)/(max_y-min_y);i=Math.floor(grid_size*(1-i)),fern_graph[4*(grid_size*i+e)+1]++}postMessage([fern_graph]),r()})}function affine_transformation(r){let n=transformation_coefficients[r][0]*current_x+transformation_coefficients[r][1]*current_y+transformation_coefficients[r][4];current_y=transformation_coefficients[r][2]*current_x+transformation_coefficients[r][3]*current_y+transformation_coefficients[r][5],current_x=n}