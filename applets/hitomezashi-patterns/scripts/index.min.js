!function(){"use strict";let e=new Wilson(Page.element.querySelector("#output-canvas"),{renderer:"cpu",canvas_width:1e3,canvas_height:1e3,use_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png"}),t=!0,l=!0,n=!1,r=null,o=null,c=null,i=null,$=[],_=[],u=[],s=[],f=[],a=0,d=0,h=[],g=1,x=1,k=0,p=null;Page.element.querySelector("#generate-button").addEventListener("click",E);let m=Page.element.querySelector("#resolution-input"),b=Page.element.querySelector("#grid-size-input"),y=Page.element.querySelector("#row-prob-input"),v=Page.element.querySelector("#col-prob-input");m.addEventListener("keydown",e=>{13===e.keyCode&&E()}),b.addEventListener("keydown",e=>{13===e.keyCode&&E()}),y.addEventListener("keydown",e=>{13===e.keyCode&&E()}),v.addEventListener("keydown",e=>{13===e.keyCode&&E()});let q=Page.element.querySelector("#toggle-draw-boundaries-checkbox"),S=Page.element.querySelector("#toggle-draw-regions-checkbox"),w=Page.element.querySelector("#toggle-maximum-speed-checkbox");q.checked=!0,S.checked=!0,q.addEventListener("input",()=>{q.checked||S.checked||(S.checked=!0)}),S.addEventListener("input",()=>{q.checked||S.checked||(q.checked=!0)});function E(){r=parseInt(m.value||2e3),o=parseInt(b.value||50),c=parseFloat(y.value||.5),i=parseFloat(v.value||.5),e.change_canvas_size(r,r),e.ctx.fillStyle="rgb(0, 0, 0)",e.ctx.fillRect(0,0,r,r),e.ctx.strokeStyle="rgb(127, 127, 127)",p=r/o/20,e.ctx.lineWidth=p,t=q.checked,l=S.checked,n=w.checked,$=Array(o+1),_=Array(o+1),u=Array(o),s=[],f=[],a=0,h=Array(o+1);for(let E=0;E<o+1;E++){$[E]=Array(o+1),_[E]=Array(o+1);for(let A=0;A<o+1;A++)$[E][A]=0,_[E][A]=0}for(let C=0;C<o;C++){u[C]=Array(o);for(let F=0;F<o;F++)u[C][F]=-1}for(let P=0;P<o+1;P++)h[P]=[];let z=Math.floor(o/2);for(let O=0;O<o;O++)for(let W=0;W<o;W++)h[Math.abs(O-z)+Math.abs(W-z)].push([O,W]);for(let j=0;j<o+1;j++){let B=0;Math.random()<c&&(B=1);for(let D=B;D<o;D+=2)$[j][D]=1}for(let G=0;G<o+1;G++){let H=0;Math.random()<i&&(H=1);for(let I=H;I<o;I+=2)_[I][G]=1}n?(t&&function t(){for(let l=1;l<o;l++)for(let n=0;n<o;n++)$[l][n]&&(e.ctx.beginPath(),e.ctx.moveTo(r/o*n,r/o*l),e.ctx.lineTo(r/o*(n+1),r/o*l),e.ctx.stroke());for(let c=0;c<o;c++)for(let i=1;i<o;i++)_[c][i]&&(e.ctx.beginPath(),e.ctx.moveTo(r/o*i,r/o*c),e.ctx.lineTo(r/o*i,r/o*(c+1)),e.ctx.stroke())}(),l&&(T(),function t(){e.ctx.fillStyle="rgb(0, 0, 0)",e.ctx.fillRect(0,0,r,r);for(let l=0;l<a;l++){let n=s[l].length,c=l%(2*o)/(2*o),i=Math.sqrt(f.indexOf(n)/(d-2));1===n&&(i=.5);let $=e.utils.hsv_to_rgb(c,1,i);e.ctx.fillStyle=`rgb(${$[0]}, ${$[1]}, ${$[2]})`;for(let _=0;_<n;_++){let u=s[l][_][0],h=s[l][_][1];e.ctx.fillRect(r/o*h+p/2,r/o*u+p/2,r/o-p,r/o-p)}}}())):t?(g=1,x=1,function t(){for(let l=0;l<o;l++)$[g][l]&&(e.ctx.beginPath(),e.ctx.moveTo(r/o*l,r/o*g),e.ctx.lineTo(r/o*(l+1),r/o*g),e.ctx.stroke());++g<o?window.requestAnimationFrame(t):window.requestAnimationFrame(L)}()):l&&(T(),k=0,R())}function L(){for(let t=0;t<o;t++)_[t][x]&&(e.ctx.beginPath(),e.ctx.moveTo(r/o*x,r/o*t),e.ctx.lineTo(r/o*x,r/o*(t+1)),e.ctx.stroke());++x<o?window.requestAnimationFrame(L):l&&(T(),k=0,setTimeout(R,1e3))}function T(){let e=0,t=0;for(;;){let l=[[e,t]];for(u[e][t]=a,s.push([[e,t]]);0!==l.length;){let n=l.length;for(let r=0;r<n;r++){let c=l[r][0],i=l[r][1];c>0&&-1===u[c-1][i]&&!$[c][i]&&(l.push([c-1,i]),u[c-1][i]=a,s[a].push([c-1,i])),c<o-1&&-1===u[c+1][i]&&!$[c+1][i]&&(l.push([c+1,i]),u[c+1][i]=a,s[a].push([c+1,i])),i>0&&-1===u[c][i-1]&&!_[c][i]&&(l.push([c,i-1]),u[c][i-1]=a,s[a].push([c,i-1])),i<o-1&&-1===u[c][i+1]&&!_[c][i+1]&&(l.push([c,i+1]),u[c][i+1]=a,s[a].push([c,i+1]))}l.splice(0,n)}f.push(s[a].length);let g=!1;for(let x=0;x<=o;x++){for(let k=0;k<h[x].length;k++){let p=h[x][k][0],m=h[x][k][1];if(-1===u[p][m]){e=p,t=m,g=!0;break}}if(g)break}if(a++,!g)break}(f=[...new Set(f)]).sort((e,t)=>t-e),d=f.length}function R(){for(let t=0;t<Math.ceil(o/50);t++){let l=s[k].length,n=k%(2*o)/(2*o),c=Math.sqrt(f.indexOf(l)/(d-2));1===l&&(c=.5);let i=e.utils.hsv_to_rgb(n,1,c);e.ctx.fillStyle="rgb(0, 0, 0)";for(let $=0;$<l;$++){let _=s[k][$][0],u=s[k][$][1];e.ctx.fillRect(r/o*u,r/o*_,r/o,r/o)}e.ctx.fillStyle=`rgb(${i[0]}, ${i[1]}, ${i[2]})`;for(let h=0;h<l;h++){let g=s[k][h][0],x=s[k][h][1];e.ctx.fillRect(r/o*x+p/2,r/o*g+p/2,r/o-p,r/o-p)}if(++k===a)return}k<a&&window.requestAnimationFrame(R)}Page.element.querySelector("#download-button").addEventListener("click",()=>{e.download_frame("a-hitomezashi-pattern.png")}),Page.show()}();