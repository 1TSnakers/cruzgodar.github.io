!function(){"use strict";let t="\n\t\tprecision highp float;\n\t\t\n\t\tvarying vec2 uv;\n\t\t\n\t\tuniform float aspect_ratio;\n\t\t\n\t\tuniform float world_center_x;\n\t\tuniform float world_center_y;\n\t\tuniform float world_size;\n\t\t\n\t\tuniform int num_roots;\n\t\t\n\t\tuniform vec2 root_1;\n\t\tuniform vec2 root_2;\n\t\tuniform vec2 root_3;\n\t\tuniform vec2 root_4;\n\t\tuniform vec2 root_5;\n\t\tuniform vec2 root_6;\n\t\tuniform vec2 root_7;\n\t\tuniform vec2 root_8;\n\t\t\n\t\tconst vec3 color_1 = vec3(1.0, 0.0, 0.0);\n\t\tconst vec3 color_2 = vec3(0.0, 1.0, 0.0);\n\t\tconst vec3 color_3 = vec3(0.0, 0.0, 1.0);\n\t\tconst vec3 color_4 = vec3(0.0, 1.0, 1.0);\n\t\tconst vec3 color_5 = vec3(1.0, 0.0, 1.0);\n\t\tconst vec3 color_6 = vec3(1.0, 1.0, 0.0);\n\t\tconst vec3 color_7 = vec3(0.5, 0.0, 1.0);\n\t\tconst vec3 color_8 = vec3(1.0, 0.5, 0.0);\n\t\t\n\t\tuniform vec2 a;\n\t\tuniform vec2 c;\n\t\t\n\t\tuniform float brightness_scale;\n\t\t\n\t\tconst float threshhold = .05;\n\t\t\n\t\t\n\t\t\n\t\t//Returns z_1 * z_2.\n\t\tvec2 cmul(vec2 z_1, vec2 z_2)\n\t\t{\n\t\t\treturn vec2(z_1.x * z_2.x - z_1.y * z_2.y, z_1.x * z_2.y + z_1.y * z_2.x);\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t//Returns 1/z.\n\t\tvec2 cinv(vec2 z)\n\t\t{\n\t\t\tfloat magnitude = z.x*z.x + z.y*z.y;\n\t\t\t\n\t\t\treturn vec2(z.x / magnitude, -z.y / magnitude);\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t//Returns f(z) for a polynomial f with given roots.\n\t\tvec2 cpoly(vec2 z)\n\t\t{\n\t\t\tvec2 result = vec2(1.0, 0.0);\n\t\t\t\n\t\t\tif (num_roots == 0)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_1);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif (num_roots == 1)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_2);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif (num_roots == 2)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_3);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif (num_roots == 3)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_4);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif (num_roots == 4)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_5);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif (num_roots == 5)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_6);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif (num_roots == 6)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_7);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif (num_roots == 7)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t\n\t\t\tresult = cmul(result, z - root_8);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\treturn result;\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t//Approximates f'(z) for a polynomial f with given roots.\n\t\tvec2 cderiv(vec2 z)\n\t\t{\n\t\t\treturn 20.0 * (cpoly(z + vec2(.025, 0.0)) - cpoly(z - vec2(.025, 0.0)));\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tvoid main(void)\n\t\t{\n\t\t\tvec2 z;\n\t\t\tvec2 last_z = vec2(0.0, 0.0);\n\t\t\t\n\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t{\n\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t}\n\t\t\t\n\t\t\telse\n\t\t\t{\n\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t}\n\t\t\t\n\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfor (int iteration = 0; iteration < 100; iteration++)\n\t\t\t{\n\t\t\t\tvec2 temp = cmul(cmul(cpoly(z), cmul(z - last_z, cinv(cpoly(z) - cpoly(last_z)))), a) + c;\n\t\t\t\t\n\t\t\t\tlast_z = z;\n\t\t\t\t\n\t\t\t\tz -= temp;\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif (num_roots >= 1)\n\t\t\t\t{\n\t\t\t\t\tfloat d_0 = length(z - root_1);\n\t\t\t\t\t\n\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat d_1 = length(last_z - root_1);\n\t\t\t\t\t\t\n\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\n\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\n\t\t\t\t\t\tgl_FragColor = vec4(color_1 * brightness, 1.0);\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tif (num_roots >= 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat d_0 = length(z - root_2);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfloat d_1 = length(last_z - root_2);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tgl_FragColor = vec4(color_2 * brightness, 1.0);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (num_roots >= 3)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfloat d_0 = length(z - root_3);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfloat d_1 = length(last_z - root_3);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tgl_FragColor = vec4(color_3 * brightness, 1.0);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (num_roots >= 4)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfloat d_0 = length(z - root_4);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfloat d_1 = length(last_z - root_4);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(color_4 * brightness, 1.0);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (num_roots >= 5)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfloat d_0 = length(z - root_5);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfloat d_1 = length(last_z - root_5);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(color_5 * brightness, 1.0);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (num_roots >= 6)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfloat d_0 = length(z - root_6);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfloat d_1 = length(last_z - root_6);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(color_6 * brightness, 1.0);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (num_roots >= 7)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfloat d_0 = length(z - root_7);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tfloat d_1 = length(last_z - root_7);\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(color_7 * brightness, 1.0);\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif (num_roots >= 8)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tfloat d_0 = length(z - root_8);\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tif (d_0 < threshhold)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tfloat d_1 = length(last_z - root_8);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tfloat brightness_adjust = (log(threshhold) - log(d_0)) / (log(d_1) - log(d_0));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tfloat brightness = 1.0 - (float(iteration) - brightness_adjust) / brightness_scale;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(color_8 * brightness, 1.0);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t",n={renderer:"gpu",shader:t,canvas_width:500,canvas_height:500,world_width:3,world_height:3,world_center_x:0,world_center_y:0,use_draggables:!0,draggables_mousemove_callback:D,draggables_touchmove_callback:D,draggables_mouseup_callback:G,draggables_touchend_callback:G,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:K,mousedown_callback:$,touchstart_callback:$,mousedrag_callback:H,touchmove_callback:H,mouseup_callback:T,touchend_callback:T,wheel_callback:function(t,n,o,e){f=t,m=n,Math.abs(o/100)<.3?u+=o/100:y+=.05*Math.sign(o);B()},pinch_callback:function(t,n,o,r){c>=1?(u-=o/e.world_width*10,b=-o/e.world_width*10):(u-=o/e.world_height*10,b=-o/e.world_height*10);f=t,m=n,B()}},o={renderer:"gpu",shader:t,canvas_width:100,canvas_height:100},e=new Wilson(document.querySelector("#output-canvas"),n);e.render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","num_roots","root_1","root_2","root_3","root_4","root_5","root_6","root_7","root_8","a","c","brightness_scale"]);let r=new Wilson(document.querySelector("#hidden-canvas"),o);r.render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","num_roots","root_1","root_2","root_3","root_4","root_5","root_6","root_7","root_8","a","c","brightness_scale"]);let l=[1,0],a=[0,0],s=[],_=0,i=0,c=1,u=0,d=[],h=500,g=100,f=0,m=0,w=0,v=0,b=0,p=0,z=0,y=0;const M=.96,x=.005,F=5e-4,q=.93,k=.01,j=.001;let A=-1,L=e.draggables.add(1,0);L.classList.add("a-marker"),(L=e.draggables.add(0,0)).classList.add("c-marker"),P(),P(),P(),R();let S=document.querySelector("#resolution-input");S.addEventListener("input",()=>{h=parseInt(S.value||500),e.change_canvas_size(h,h),window.requestAnimationFrame(J)}),document.querySelector("#add-root-button").addEventListener("click",P),document.querySelector("#remove-root-button").addEventListener("click",function(){if(1===i)return;i--,s.pop(),e.draggables.draggables[i+2].remove(),e.draggables.draggables.pop(),e.draggables.world_coordinates.pop(),e.draggables.num_draggables--,window.requestAnimationFrame(J)}),document.querySelector("#spread-roots-button").addEventListener("click",R),document.querySelector("#download-button").addEventListener("click",()=>{e.download_frame("newtons-method.png")});let C=document.querySelector("#root-a-input"),E=document.querySelector("#root-b-input");C.addEventListener("input",W),E.addEventListener("input",W);let I=document.querySelector("#root-setter");function P(){if(8===i)return;let t=3*Math.random()-1.5,n=3*Math.random()-1.5;e.draggables.add(t,n),s.push([t,n]),i++,window.requestAnimationFrame(J)}function R(){for(let t=0;t<i;t++)t<i/2||i%2==1?(s[t][0]=Math.cos(2*Math.PI*2*t/i),s[t][1]=Math.sin(2*Math.PI*2*t/i)):(s[t][0]=Math.cos(2*Math.PI*(2*t+1)/i),s[t][1]=Math.sin(2*Math.PI*(2*t+1)/i)),e.draggables.world_coordinates[t+2]=[s[t][0],s[t][1]];window.requestAnimationFrame(J),e.draggables.recalculate_locations()}function W(){0===_?(l[0]=parseFloat(C.value||1),l[1]=parseFloat(E.value||0),e.draggables.world_coordinates[0]=[l[0],l[1]]):1===_?(a[0]=10*parseFloat(C.value||0),a[1]=10*parseFloat(E.value||0),e.draggables.world_coordinates[1]=[a[0],a[1]]):(s[_-2][0]=parseFloat(C.value||0),s[_-2][1]=parseFloat(E.value||0),e.draggables.world_coordinates[_-2]=[s[_-2][0],s[_-2][1]]),window.requestAnimationFrame(J),e.draggables.recalculate_locations()}function $(t,n,o){p=0,z=0,y=0,w=0,v=0,b=0}function H(t,n,o,r,l){e.world_center_x-=o,e.world_center_y-=r,w=-o,v=-r,window.requestAnimationFrame(J),e.draggables.recalculate_locations()}function T(t,n,o){Math.sqrt(w*w+v*v)>=x*Math.min(e.world_width,e.world_height)&&(p=w,z=v),Math.abs(b)>=k&&(y=b),window.requestAnimationFrame(J)}function B(){if(c>=1){let t=e.input.get_zoomed_world_center(f,m,3*Math.pow(2,u)*c,3*Math.pow(2,u));e.world_width=3*Math.pow(2,u)*c,e.world_height=3*Math.pow(2,u),e.world_center_x=t[0],e.world_center_y=t[1]}else{let t=e.input.get_zoomed_world_center(f,m,3*Math.pow(2,u),3*Math.pow(2,u)/c);e.world_width=3*Math.pow(2,u),e.world_height=3*Math.pow(2,u)/c,e.world_center_x=t[0],e.world_center_y=t[1]}window.requestAnimationFrame(J),e.draggables.recalculate_locations()}function D(t,n,o,e){0===t?l=[n,o]:1===t?a=[n,o]:s[t-2]=[n,o],window.requestAnimationFrame(J)}function G(t,n,o,e){I.style.opacity=0,setTimeout(()=>{0===(_=t)?(C.value=Math.round(1e3*l[0])/1e3,E.value=Math.round(1e3*l[1])/1e3):1===_?(C.value=Math.round(1e3*a[0])/1e4,E.value=Math.round(1e3*a[1])/1e4):(C.value=Math.round(1e3*s[_-2][0])/1e3,E.value=Math.round(1e3*s[_-2][1])/1e3),I.style.opacity=1},300)}function J(t){let n=t-A;if(A=t,0===n)return;r.gl.uniform1f(r.uniforms.aspect_ratio,c),r.gl.uniform1f(r.uniforms.world_center_x,e.world_center_x),r.gl.uniform1f(r.uniforms.world_center_y,e.world_center_y),r.gl.uniform1f(r.uniforms.world_size,Math.min(e.world_height,e.world_width)/2),r.gl.uniform1i(r.uniforms.num_roots,i);for(let t=0;t<i;t++)r.gl.uniform2fv(r.uniforms[`root_${t+1}`],s[t]);r.gl.uniform2fv(r.uniforms.a,l),r.gl.uniform2f(r.uniforms.c,a[0]/10,a[1]/10),r.gl.uniform1f(r.uniforms.brightness_scale,30),r.render.draw_frame();let o=r.render.get_pixel_data(),_=new Array(g*g);for(let t=0;t<g*g;t++)_[t]=Math.max(Math.max(o[4*t],o[4*t+1]),o[4*t+2]);_.sort((t,n)=>t-n);let h=Math.min(1e4/(_[Math.floor(g*g*.96)]+_[Math.floor(g*g*.98)]),200);d.push(h);let f=d.length;f>10&&d.shift(),h=Math.max(d.reduce((t,n)=>t+n)/f,.5),e.gl.uniform1f(e.uniforms.aspect_ratio,c),e.gl.uniform1f(e.uniforms.world_center_x,e.world_center_x),e.gl.uniform1f(e.uniforms.world_center_y,e.world_center_y),e.gl.uniform1f(e.uniforms.world_size,Math.min(e.world_height,e.world_width)/2),e.gl.uniform1i(e.uniforms.num_roots,i);for(let t=0;t<i;t++)e.gl.uniform2fv(e.uniforms[`root_${t+1}`],s[t]);e.gl.uniform2fv(e.uniforms.a,l),e.gl.uniform2f(e.uniforms.c,a[0]/10,a[1]/10),e.gl.uniform1f(e.uniforms.brightness_scale,h),e.render.draw_frame(),0===p&&0===z&&0===y||(e.world_center_x+=p,e.world_center_y+=z,p*=M,z*=M,Math.sqrt(p*p+z*z)<F*Math.min(e.world_width,e.world_height)&&(p=0,z=0),u+=y,B(),y*=q,Math.abs(y)<j&&(y=0),window.requestAnimationFrame(J),e.draggables.recalculate_locations())}function K(){e.fullscreen.currently_fullscreen?(c=window.innerWidth/window.innerHeight)>=1?(e.change_canvas_size(h,Math.floor(h/c)),e.world_width=3*Math.pow(2,u)*c,e.world_height=3*Math.pow(2,u)):(e.change_canvas_size(Math.floor(h*c),h),e.world_width=3*Math.pow(2,u),e.world_height=3*Math.pow(2,u)/c):(c=1,e.change_canvas_size(h,h),e.world_width=3*Math.pow(2,u),e.world_height=3*Math.pow(2,u)),window.requestAnimationFrame(J)}e.gl.uniform1f(e.uniforms.aspect_ratio,1),window.requestAnimationFrame(J),window.addEventListener("resize",K),Page.temporary_handlers.resize.push(K)}();