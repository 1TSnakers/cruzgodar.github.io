import{Mandelbulb}from"./class.min.mjs";import{changeOpacity,opacityAnimationTime}from"/scripts/src/animation.min.mjs";import{equalizeTextButtons}from"/scripts/src/buttons.min.mjs";import{showPage}from"/scripts/src/load-page.min.mjs";import{$}from"/scripts/src/main.min.mjs";function load(){const rotationAngleXInputElement=$("#rotation-angle-x-input"),rotationAngleYInputElement=$("#rotation-angle-y-input"),rotationAngleZInputElement=$("#rotation-angle-z-input"),cXInputElement=$("#c-x-input"),cYInputElement=$("#c-y-input"),cZInputElement=$("#c-z-input"),applet=new Mandelbulb($("#output-canvas"),cXInputElement,cYInputElement,cZInputElement,rotationAngleXInputElement,rotationAngleYInputElement,rotationAngleZInputElement),resolutionInputElement=$("#resolution-input"),viewDistanceInputElement=$("#view-distance-input"),iterationsInputElement=(applet.setInputCaps([resolutionInputElement,viewDistanceInputElement],[750,200]),resolutionInputElement.addEventListener("input",()=>{var resolution=parseInt(resolutionInputElement.value||500);applet.changeResolution(resolution)}),$("#iterations-input"));iterationsInputElement.addEventListener("input",()=>{applet.maxIterations=parseInt(iterationsInputElement.value||16),applet.wilson.gl.uniform1i(applet.wilson.uniforms.maxIterations,applet.maxIterations)}),viewDistanceInputElement.addEventListener("input",()=>{applet.maxMarches=Math.max(parseInt(viewDistanceInputElement.value||100),32),applet.wilson.gl.uniform1i(applet.wilson.uniforms.maxMarches,applet.maxMarches)}),$("#download-button").addEventListener("click",()=>{applet.wilson.gl.uniform1i(applet.wilson.uniforms.maxMarches,1024),applet.wilson.gl.uniform1f(applet.wilson.uniforms.stepFactor,12),applet.juliaProportion<.5?applet.wilson.downloadFrame("the-mandelbulb.png"):applet.wilson.downloadFrame("a-juliabulb.png"),applet.wilson.gl.uniform1i(applet.wilson.uniforms.maxMarches,applet.maxMarches),applet.wilson.gl.uniform1f(applet.wilson.uniforms.stepFactor,1)});const powerInputElement=$("#power-input");var elements=[rotationAngleXInputElement,rotationAngleYInputElement,rotationAngleZInputElement,cXInputElement,cYInputElement,cZInputElement,powerInputElement];for(let i=0;i<7;i++)elements[i].addEventListener("input",updateParameters);var randomizeRotationButtonElement=$("#randomize-rotation-button"),randomizeRotationButtonElement=(randomizeRotationButtonElement.style.opacity=1,randomizeRotationButtonElement.addEventListener("click",function(){applet.randomizeRotation()}),$("#randomize-c-button"));randomizeRotationButtonElement.style.opacity=1,randomizeRotationButtonElement.addEventListener("click",function(){applet.randomizeC()});const switchBulbButtonElement=$("#switch-bulb-button"),switchMovementButtonElement=(switchBulbButtonElement.style.opacity=1,switchBulbButtonElement.addEventListener("click",function(){changeOpacity(switchBulbButtonElement,0),changeOpacity(switchMovementButtonElement,0),setTimeout(()=>{applet.juliaProportion<.5?(switchBulbButtonElement.textContent="Switch to Mandelbulb",changeOpacity(switchMovementButtonElement,1)):switchBulbButtonElement.textContent="Switch to Juliabulb",equalizeTextButtons(),changeOpacity(switchBulbButtonElement,1)},opacityAnimationTime),applet.switchBulb()}),$("#switch-movement-button"));function updateParameters(){var cx=parseFloat(cXInputElement.value||0),cy=parseFloat(cYInputElement.value||0),cz=parseFloat(cZInputElement.value||0);applet.c=[cx,cy,cz],applet.wilson.gl.uniform3fv(applet.wilson.uniforms.c,applet.c),applet.rotationAngleX=parseFloat(rotationAngleXInputElement.value||0),applet.rotationAngleY=parseFloat(rotationAngleYInputElement.value||0),applet.rotationAngleZ=parseFloat(rotationAngleZInputElement.value||0),applet.power=parseFloat(powerInputElement.value||8),applet.wilson.gl.uniform1f(applet.wilson.uniforms.power,applet.power),applet.updateRotationMatrix()}switchMovementButtonElement.style.opacity=0,switchMovementButtonElement.addEventListener("click",function(){changeOpacity(switchMovementButtonElement,0),setTimeout(()=>{applet.movingPos?switchMovementButtonElement.textContent="Change Juliabulb":switchMovementButtonElement.textContent="Move Camera",equalizeTextButtons(),changeOpacity(switchMovementButtonElement,1)},opacityAnimationTime),applet.switchMovement()}),equalizeTextButtons(),showPage()}export{load};