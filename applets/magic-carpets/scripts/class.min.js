"use strict";class MagicCarpet extends Applet{grid_size=null;max_cage_size=null;cages=[];web_worker=null;constructor(s){super(s);let i={renderer:"cpu",canvas_width:500,canvas_height:500};this.wilson=new Wilson(s,i)}async run(s,i){this.grid_size=s,this.max_cage_size=i;let e=200*this.grid_size+9;this.wilson.change_canvas_size(e,e),this.wilson.ctx.clearRect(0,0,e,e);try{this.web_worker.terminate()}catch(t){}this.web_worker=new Worker(`/applets/magic-carpets/scripts/worker.${DEBUG?"":"min."}js`),this.workers.push(this.web_worker),this.web_worker.onmessage=s=>{console.log(s.data)},this.web_worker.postMessage([this.grid_size,this.max_cage_size])}draw_grid(s){let i=200*this.grid_size+9;s?(this.wilson.ctx.fillStyle="rgb(255, 255, 255)",this.wilson.ctx.fillRect(0,0,i,i),this.wilson.ctx.fillStyle="rgb(0, 0, 0)"):(this.wilson.ctx.clearRect(0,0,i,i),1===Site.Settings.url_vars.theme?this.wilson.ctx.fillStyle="rgb(192, 192, 192)":this.wilson.ctx.fillStyle="rgb(64, 64, 64)");for(let e=0;e<=this.grid_size;e++)this.wilson.ctx.fillRect(200*e+4,0,2,i+9),this.wilson.ctx.fillRect(0,200*e+4,i+9,2)}}