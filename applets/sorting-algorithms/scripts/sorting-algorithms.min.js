!function(){"use strict";let t=2e3,e=null,l=[],n=[],r=40,a=null,o=20,i=600,c=!0,u=-1,f=0,d=null,s={bubble:function*(){p=Math.ceil(e*e/2500);for(;;){let t=!0;for(let n=0;n<e-1;n++)if(U(n),U(n+1),l[n]>l[n+1]){t=!1;let e=l[n];l[n]=l[n+1],l[n+1]=e,z(n)&&(yield),z(n+1)&&(yield)}if(t)break}C()},insertion:function*(){p=Math.ceil(e*e/5e3);for(let t=1;t<e;t++)if(U(t),U(t-1),l[t]<l[t-1])for(let e=0;e<t;e++)if(U(e),U(t),l[e]>l[t]){let n=l[t];for(let n=t;n>e;n--)l[n]=l[n-1],z(n)&&(yield);l[e]=n,z(e)&&(yield)}C()},selection:function*(){p=Math.ceil(e/1e3);for(let t=0;t<e;t++){let n=-1,r=e;for(let a=t;a<e;a++)U(a),U(r),l[a]<r&&(r=l[a],n=a);let a=l[t];l[t]=r,l[n]=a,z(t)&&(yield),z(n)&&(yield)}C()},heap:function*(){p=Math.ceil(e*Math.log(e)/500);for(let t=1;t<e;t++){let e=t,n=0;for(;0!==e&&(n=Math.floor((e-1)/2),U(e),U(n),l[e]>l[n]);){let t=l[e];l[e]=l[n],l[n]=t,z(e)&&(yield),z(n)&&(yield),e=n}}for(let t=e-1;t>=0;t--){let e=l[0];l[0]=l[t],l[t]=e,z(0)&&(yield),z(t)&&(yield);let n=0,r=0,a=0,o=0;for(;a=(r=2*n+1)+1,!(r>=t)&&(a>=t?o=r:(U(r),U(a),o=l[r]>l[a]?r:a),U(n),U(o),l[n]<l[o]);){let t=l[n];l[n]=l[o],l[o]=t,z(n)&&(yield),z(o)&&(yield),n=o}}C()},merge:function*(){p=Math.ceil(e*Math.log(e)/450);let t=new Array(e),n=1;for(;;){for(let r=0;r<e;r+=2*n){let a=0,o=n,i=0;for(;;)if(o+r>=e||o>=2*n){if(a>=n||r+a>=e)break;t[i]=l[r+a],z(r+a)&&(yield),a++,i++}else a>=n||r+a>=e?(t[i]=l[r+o],z(r+o)&&(yield),o++,i++):(U(r+a),U(r+o),l[r+a]<l[r+o]?(t[i]=l[r+a],z(r+a)&&(yield),a++,i++):(t[i]=l[r+o],z(r+o)&&(yield),o++,i++));for(let a=0;a<2*n&&!(r+a>=e);a++)l[r+a]=t[a],z(r+a)&&(yield)}if((n*=2)>=e)break}C()},quick:function*(){p=Math.ceil(e*Math.log(e)/2250);let t=new Array(e);t[0]=0,t[1]=e-1;let n=new Array(e),r=1,a=0;for(;r>0;){for(let e=0;e<r;e++){let r=l[Math.floor((t[2*e]+t[2*e+1])/2)];U(Math.floor((t[2*e]+t[2*e+1])/2));let o=t[2*e]-1,i=t[2*e+1]+1;for(;;){do{U(++o)}while(l[o]<r);U(o);do{U(--i)}while(l[i]>r);if(U(i),o>=i)break;let t=l[o];l[o]=l[i],l[i]=t,z(o)&&(yield),z(i)&&(yield)}i>t[2*e]&&(n[2*a]=t[2*e],n[2*a+1]=i,a++),t[2*e+1]>i+1&&(n[2*a]=i+1,n[2*a+1]=t[2*e+1],a++)}r=a,a=0;for(let e=0;e<2*r;e++)t[e]=n[e]}C()},cycle:function*(){p=Math.ceil(e/2e3);let t=new Array(e);for(let l=0;l<e;l++)t[l]=!1;for(let n=0;n<e;n++){if(t[n])continue;U(n);let r=l[n],a=r,o=0;do{o=0;for(let t=0;t<e;t++)U(t),l[t]<r&&o++;r>a&&o--;let n=l[o];l[o]=r,r=n,z(o)&&(yield),t[o]=!0}while(o!==n)}C()},"msd-radix":function*(){let t=0,n=1/Math.log(2);for(let r=0;r<e;r++){U(r);let e=Math.log(l[r])*n;t=Math.max(t,e)}t=Math.round(t),p=Math.ceil(e*t/650);let r=new Array(e);r[0]=0,r[1]=e-1;let a=new Array(e),o=1,i=0,c=new Array(e),u=Math.pow(2,t-1);for(let e=0;e<t;e++){for(let t=0;t<o;t++){let e=r[2*t],n=r[2*t+1];for(let a=r[2*t];a<=r[2*t+1];a++){U(a);let t=Math.floor(l[a]/u)%2;0===t?(c[e]=l[a],z(e)&&(yield),e++):(c[n]=l[a],z(n)&&(yield),n--)}for(let e=r[2*t];e<=r[2*t+1];e++)l[e]=c[e],z(e)&&(yield);n++,--e>r[2*t]&&(a[2*i]=r[2*t],a[2*i+1]=e,i++),r[2*t+1]>n&&(a[2*i]=n,a[2*i+1]=r[2*t+1],i++)}o=i,i=0;for(let t=0;t<2*o;t++)r[t]=a[t];u/=2}C()},"lsd-radix":function*(){let t=0,n=1/Math.log(2);for(let r=0;r<e;r++){U(r);let e=Math.log(l[r])*n;t=Math.max(t,e)}t=Math.round(t),p=Math.ceil(e*t/650);let r=new Array(e),a=1;for(let n=0;n<t;n++){let t=0,n=e-1;for(let o=0;o<e;o++){U(o);let e=Math.floor(l[o]/a)%2;0===e?(r[t]=l[o],z(t)&&(yield),t++):(r[n]=l[o],z(n)&&(yield),n--)}t--,n++;for(let e=0;e<=t;e++)l[e]=r[e],z(e)&&(yield);for(let t=0;t<e-n;t++)l[n+t]=r[e-1-t],z(n+t)&&(yield);a*=2}C()},gravity:function*(){p=Math.ceil(e*e/1e6);let t=new Array(e);for(let l=0;l<e;l++){t[l]=new Array(e);for(let n=0;n<e;n++)t[l][n]=!1}let n=0,r=0;for(let a=0;a<e;a++){U(a);let e=l[a];for(let l=0;l<e;l++)t[a][l]=!0;e-a>r&&(r=e-a,n=a)}for(let r=0;r<e;r++){for(let n=e-1;n>=0;n--)if(t[n][r]){let a=n;do{a++}while(a<e&&!t[a][r]);a--,t[n][r]=!1,t[a][r]=!0,l[n]--,l[a]++,z(n,!1,!1),z(a,!1,!1)}z(n,!1,!0)&&(yield),y--,m--}C()}},g=[X,null,L],h=0,_=0,y=0,m=0,p=1,T=!1,x=!1,v=[],E={renderer:"gpu",shader:"\n\t\tprecision highp float;\n\t\t\n\t\tvarying vec2 uv;\n\t\t\n\t\tuniform float data_length;\n\t\t\n\t\tconst float circle_size = .8;\n\t\t\n\t\tuniform sampler2D u_texture;\n\t\t\n\t\t\n\t\t\n\t\tvec3 hsv2rgb(vec3 c)\n\t\t{\n\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tvoid main(void)\n\t\t{\n\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\n\t\t\tif (length(uv) <= circle_size)\n\t\t\t{\n\t\t\t\tfloat sample = mod(atan(uv.y, uv.x) / 6.283, 1.0);\n\t\t\t\t\n\t\t\t\tvec4 output_1 = texture2D(u_texture, vec2(floor(sample * data_length) / data_length, .5));\n\t\t\t\tvec4 output_2 = texture2D(u_texture, vec2(mod(floor(sample * data_length + 1.0) / data_length, 1.0), .5));\n\t\t\t\t\n\t\t\t\tfloat brightness = mix(output_1.z, output_2.z, fract(sample * data_length));\n\t\t\t\t\n\t\t\t\tfloat h_1 = (output_1.x * 256.0 + output_1.y) / data_length * 255.0;\n\t\t\t\tfloat h_2 = (output_2.x * 256.0 + output_2.y) / data_length * 255.0;\n\t\t\t\t\n\t\t\t\tif (abs(h_1 - h_2) > .5)\n\t\t\t\t{\n\t\t\t\t\tif (h_1 > h_2)\n\t\t\t\t\t{\n\t\t\t\t\t\th_1 -= 1.0;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\th_2 -= 1.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat h = mix(h_1, h_2, fract(sample * data_length));\n\t\t\t\t\n\t\t\t\tfloat s = clamp((length(uv) / circle_size - .03) * (1.0 - brightness), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tfloat v = clamp((1.0 - length(uv) / circle_size) * 100.0, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t}\n\t\t}\n\t",canvas_width:2e3,canvas_height:2e3,use_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png"},M=new Wilson(Page.element.querySelector("#output-canvas"),E);M.render.init_uniforms(["data_length"]);let w=M.gl.createTexture();M.gl.bindTexture(M.gl.TEXTURE_2D,w),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_MAG_FILTER,M.gl.NEAREST),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_MIN_FILTER,M.gl.NEAREST),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_WRAP_S,M.gl.CLAMP_TO_EDGE),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_WRAP_T,M.gl.CLAMP_TO_EDGE),M.gl.disable(M.gl.DEPTH_TEST);let A=Page.element.querySelector("#algorithm-selector-dropdown");A.addEventListener("input",()=>{Page.set_element_styles(".info-text","opacity",0),setTimeout(()=>{Page.set_element_styles(".info-text","display","none");let t=Page.element.querySelector(`#${A.value}-info`);t.style.display="block",setTimeout(()=>{t.style.opacity=1},10)},Site.opacity_animation_time)}),Page.element.querySelector("#generate-button").addEventListener("click",q);let R=Page.element.querySelector("#resolution-input");R.addEventListener("keydown",t=>{13===t.keyCode&&q()});let b=Page.element.querySelector("#array-size-input");b.addEventListener("keydown",t=>{13===t.keyCode&&q()});let P=Page.element.querySelector("#play-sound-checkbox");P.checked=!0;let S=Page.element.querySelector("#num-reads"),k=Page.element.querySelector("#num-writes");function q(){try{v[h][2].gain.linearRampToValueAtTime(1e-4,v[h][0].currentTime+f/1e3)}catch(t){}d=Site.applet_process_id,t=parseInt(R.value||2e3),M.change_canvas_size(t,t);let r=e;if((e=parseInt(b.value||256))!==r){l=new Array(e),n=new Array(e);for(let t=0;t<e;t++)l[t]=t,n[t]=0;M.gl.uniform1f(M.uniforms.data_length,e)}_=0,y=0,m=0,T=!1,S.textContent="0",k.textContent="0",c=P.checked,g=[X,s[A.value],L],h=0,v=[],function(){if(c)for(let t=0;t<g.length;t++){let t=new AudioContext,e=t.createOscillator();e.type="sine",e.frequency.value=50;let l=t.createGain();e.connect(l),l.connect(t.destination),v.push([t,e,l])}}(),c&&v[h][1].start(0),a=g[0](),window.requestAnimationFrame(D)}function D(t){if(f=t-u,u=t,0===f)return;let o=new Uint8Array(4*e);for(let t=0;t<e;t++)o[4*t]=Math.floor(l[t]/256),o[4*t+1]=l[t]%256,o[4*t+2]=Math.floor(n[t]/r*256);if(M.gl.texImage2D(M.gl.TEXTURE_2D,0,M.gl.RGBA,e,1,0,M.gl.RGBA,M.gl.UNSIGNED_BYTE,o),M.render.draw_frame(),function(){for(let t=0;t<e;t++)n[t]=Math.max(n[t]-1,0)}(),T&&(S.textContent=_,k.textContent=y),x||a.next(),d===Site.applet_process_id)window.requestAnimationFrame(D);else{console.log("Terminated applet process");try{v[h][2].gain.linearRampToValueAtTime(1e-4,v[h][0].currentTime+f/1e3)}catch(t){}}}function U(t,e=!1){_++}function z(t,a=!0,u=!0){return a&&(n[t]=r-1),y++,++m>=p&&(m=0,u&&function(t){c&&v[h][1].frequency.linearRampToValueAtTime((i-o)*l[t]/e+o,v[h][0].currentTime+f/1e3)}(t),!0)}function C(){x=!0,c&&v[h][2].gain.linearRampToValueAtTime(1e-4,v[h][0].currentTime+f/1e3),++h<g.length&&setTimeout(()=>{c&&v[h][1].start(0),a=g[h](),x=!1},1e3)}function*X(){p=Math.ceil(e/60);for(let t=0;t<e-1;t++){let n=Math.floor(Math.random()*(e-t-1))+t,r=l[t];l[t]=l[n],l[n]=r,z(t)&&(yield),z(n)&&(yield)}_=0,y=0,T=!0,C()}function*L(){T=!1,p=Math.ceil(e/60);for(let t=0;t<e;t++)z(t)&&(yield);c&&v[h][2].gain.linearRampToValueAtTime(1e-4,v[h][0].currentTime+f/1e3)}Page.element.querySelector("#download-button").addEventListener("click",()=>{M.download_frame("an-aztec-diamond.png")})}();