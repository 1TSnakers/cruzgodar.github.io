!function(){"use strict";let t=2e3,e=null,l=[],n=[],r=40,o=null,a=20,i=600,c=!0,u=-1,f=null,d={bubble:function*(){m=Math.ceil(e*e/2500);for(;;){let t=!0;for(let n=0;n<e-1;n++)if(U(n),U(n+1),l[n]>l[n+1]){t=!1;let e=l[n];l[n]=l[n+1],l[n+1]=e,z(n)&&(yield),z(n+1)&&(yield)}if(t)break}C()},insertion:function*(){m=Math.ceil(e*e/5e3);for(let t=1;t<e;t++)if(U(t),U(t-1),l[t]<l[t-1])for(let e=0;e<t;e++)if(U(e),U(t),l[e]>l[t]){let n=l[t];for(let n=t;n>e;n--)l[n]=l[n-1],z(n)&&(yield);l[e]=n,z(e)&&(yield)}C()},selection:function*(){m=Math.ceil(e/1e3);for(let t=0;t<e;t++){let n=-1,r=e;for(let o=t;o<e;o++)U(o),U(r),l[o]<r&&(r=l[o],n=o);let o=l[t];l[t]=r,l[n]=o,z(t)&&(yield),z(n)&&(yield)}C()},heap:function*(){m=Math.ceil(e*Math.log(e)/500);for(let t=1;t<e;t++){let e=t,n=0;for(;0!==e&&(n=Math.floor((e-1)/2),U(e),U(n),l[e]>l[n]);){let t=l[e];l[e]=l[n],l[n]=t,z(e)&&(yield),z(n)&&(yield),e=n}}for(let t=e-1;t>=0;t--){let e=l[0];l[0]=l[t],l[t]=e,z(0)&&(yield),z(t)&&(yield);let n=0,r=0,o=0,a=0;for(;o=(r=2*n+1)+1,!(r>=t)&&(o>=t?a=r:(U(r),U(o),a=l[r]>l[o]?r:o),U(n),U(a),l[n]<l[a]);){let t=l[n];l[n]=l[a],l[a]=t,z(n)&&(yield),z(a)&&(yield),n=a}}C()},merge:function*(){m=Math.ceil(e*Math.log(e)/450);let t=new Array(e),n=1;for(;;){for(let r=0;r<e;r+=2*n){let o=0,a=n,i=0;for(;;)if(a+r>=e||a>=2*n){if(o>=n||r+o>=e)break;t[i]=l[r+o],z(r+o)&&(yield),o++,i++}else o>=n||r+o>=e?(t[i]=l[r+a],z(r+a)&&(yield),a++,i++):(U(r+o),U(r+a),l[r+o]<l[r+a]?(t[i]=l[r+o],z(r+o)&&(yield),o++,i++):(t[i]=l[r+a],z(r+a)&&(yield),a++,i++));for(let o=0;o<2*n&&!(r+o>=e);o++)l[r+o]=t[o],z(r+o)&&(yield)}if((n*=2)>=e)break}C()},quick:function*(){m=Math.ceil(e*Math.log(e)/2250);let t=new Array(e);t[0]=0,t[1]=e-1;let n=new Array(e),r=1,o=0;for(;r>0;){for(let e=0;e<r;e++){let r=l[Math.floor((t[2*e]+t[2*e+1])/2)];U(Math.floor((t[2*e]+t[2*e+1])/2));let a=t[2*e]-1,i=t[2*e+1]+1;for(;;){do{U(++a)}while(l[a]<r);U(a);do{U(--i)}while(l[i]>r);if(U(i),a>=i)break;let t=l[a];l[a]=l[i],l[i]=t,z(a)&&(yield),z(i)&&(yield)}i>t[2*e]&&(n[2*o]=t[2*e],n[2*o+1]=i,o++),t[2*e+1]>i+1&&(n[2*o]=i+1,n[2*o+1]=t[2*e+1],o++)}r=o,o=0;for(let e=0;e<2*r;e++)t[e]=n[e]}C()},cycle:function*(){m=Math.ceil(e/2e3);let t=new Array(e);for(let l=0;l<e;l++)t[l]=!1;for(let n=0;n<e;n++){if(t[n])continue;U(n);let r=l[n],o=r,a=0;do{a=0;for(let t=0;t<e;t++)U(t),l[t]<r&&a++;r>o&&a--;let n=l[a];l[a]=r,r=n,z(a)&&(yield),t[a]=!0}while(a!==n)}C()},"msd-radix":function*(){let t=0,n=1/Math.log(2);for(let r=0;r<e;r++){U(r);let e=Math.log(l[r])*n;t=Math.max(t,e)}t=Math.round(t),m=Math.ceil(e*t/650);let r=new Array(e);r[0]=0,r[1]=e-1;let o=new Array(e),a=1,i=0,c=new Array(e),u=Math.pow(2,t-1);for(let e=0;e<t;e++){for(let t=0;t<a;t++){let e=r[2*t],n=r[2*t+1];for(let o=r[2*t];o<=r[2*t+1];o++){U(o);let t=Math.floor(l[o]/u)%2;0===t?(c[e]=l[o],z(e)&&(yield),e++):(c[n]=l[o],z(n)&&(yield),n--)}for(let e=r[2*t];e<=r[2*t+1];e++)l[e]=c[e],z(e)&&(yield);n++,--e>r[2*t]&&(o[2*i]=r[2*t],o[2*i+1]=e,i++),r[2*t+1]>n&&(o[2*i]=n,o[2*i+1]=r[2*t+1],i++)}a=i,i=0;for(let t=0;t<2*a;t++)r[t]=o[t];u/=2}C()},"lsd-radix":function*(){let t=0,n=1/Math.log(2);for(let r=0;r<e;r++){U(r);let e=Math.log(l[r])*n;t=Math.max(t,e)}t=Math.round(t),m=Math.ceil(e*t/650);let r=new Array(e),o=1;for(let n=0;n<t;n++){let t=0,n=e-1;for(let a=0;a<e;a++){U(a);let e=Math.floor(l[a]/o)%2;0===e?(r[t]=l[a],z(t)&&(yield),t++):(r[n]=l[a],z(n)&&(yield),n--)}t--,n++;for(let e=0;e<=t;e++)l[e]=r[e],z(e)&&(yield);for(let t=0;t<e-n;t++)l[n+t]=r[e-1-t],z(n+t)&&(yield);o*=2}C()},gravity:function*(){m=1;let t=new Array(e);for(let l=0;l<e;l++){t[l]=new Array(e);for(let n=0;n<e;n++)t[l][n]=!1}let n=0,r=0;for(let o=0;o<e;o++){U(o);let e=l[o];for(let l=0;l<e;l++)t[o][l]=!0;e-o>r&&(r=e-o,n=o)}for(let r=0;r<e;r++){for(let n=e-1;n>=0;n--)if(t[n][r]){let o=n;do{o++}while(o<e&&!t[o][r]);o--,t[n][r]=!1,t[o][r]=!0,l[n]--,l[o]++,z(n,!1,!1),z(o,!1,!1)}z(n,!1,!0)&&(yield),g--,y--}C()}},s=[P,null,X],h=0,_=0,g=0,y=0,m=1,p=!1,T=!1,x=[],v={renderer:"gpu",shader:"\n\t\tprecision highp float;\n\t\t\n\t\tvarying vec2 uv;\n\t\t\n\t\tuniform float data_length;\n\t\t\n\t\tconst float circle_size = .8;\n\t\t\n\t\tuniform sampler2D u_texture;\n\t\t\n\t\t\n\t\t\n\t\tvec3 hsv2rgb(vec3 c)\n\t\t{\n\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tvoid main(void)\n\t\t{\n\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\n\t\t\tif (length(uv) <= circle_size)\n\t\t\t{\n\t\t\t\tfloat sample = mod(atan(uv.y, uv.x) / 6.283, 1.0);\n\t\t\t\t\n\t\t\t\tvec4 output_1 = texture2D(u_texture, vec2(floor(sample * data_length) / data_length, .5));\n\t\t\t\tvec4 output_2 = texture2D(u_texture, vec2(mod(floor(sample * data_length + 1.0) / data_length, 1.0), .5));\n\t\t\t\t\n\t\t\t\tfloat brightness = mix(output_1.z, output_2.z, fract(sample * data_length));\n\t\t\t\t\n\t\t\t\tfloat h_1 = (output_1.x * 256.0 + output_1.y) / data_length * 255.0;\n\t\t\t\tfloat h_2 = (output_2.x * 256.0 + output_2.y) / data_length * 255.0;\n\t\t\t\t\n\t\t\t\tif (abs(h_1 - h_2) > .5)\n\t\t\t\t{\n\t\t\t\t\tif (h_1 > h_2)\n\t\t\t\t\t{\n\t\t\t\t\t\th_1 -= 1.0;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\th_2 -= 1.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat h = mix(h_1, h_2, fract(sample * data_length));\n\t\t\t\t\n\t\t\t\tfloat s = clamp((length(uv) / circle_size - .03) * (1.0 - brightness), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tfloat v = clamp((1.0 - length(uv) / circle_size) * 100.0, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t}\n\t\t}\n\t",canvas_width:2e3,canvas_height:2e3,use_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png"},E=new Wilson(document.querySelector("#output-canvas"),v);E.render.init_uniforms(["data_length"]);let M=E.gl.createTexture();E.gl.bindTexture(E.gl.TEXTURE_2D,M),E.gl.texParameteri(E.gl.TEXTURE_2D,E.gl.TEXTURE_MAG_FILTER,E.gl.NEAREST),E.gl.texParameteri(E.gl.TEXTURE_2D,E.gl.TEXTURE_MIN_FILTER,E.gl.NEAREST),E.gl.texParameteri(E.gl.TEXTURE_2D,E.gl.TEXTURE_WRAP_S,E.gl.CLAMP_TO_EDGE),E.gl.texParameteri(E.gl.TEXTURE_2D,E.gl.TEXTURE_WRAP_T,E.gl.CLAMP_TO_EDGE),E.gl.disable(E.gl.DEPTH_TEST);let w=document.querySelector("#algorithm-selector-dropdown");w.addEventListener("input",()=>{Page.set_element_styles(".info-text","opacity",0),setTimeout(()=>{Page.set_element_styles(".info-text","display","none");let t=document.querySelector(`#${w.value}-info`);t.style.display="block",setTimeout(()=>{t.style.opacity=1},10)},Site.opacity_animation_time)}),document.querySelector("#generate-button").addEventListener("click",q);let A=document.querySelector("#resolution-input");A.addEventListener("keydown",t=>{13===t.keyCode&&q()});let R=document.querySelector("#array-size-input");R.addEventListener("keydown",t=>{13===t.keyCode&&q()});let b=document.querySelector("#play-sound-checkbox");b.checked=!0;let S=document.querySelector("#num-reads"),k=document.querySelector("#num-writes");function q(){try{x[h][2].gain.linearRampToValueAtTime(1e-4,x[h][0].currentTime+.016)}catch(t){}f=Site.applet_process_id,t=parseInt(A.value||2e3),E.change_canvas_size(t,t);let r=e;if((e=parseInt(R.value||256))!==r){l=new Array(e),n=new Array(e);for(let t=0;t<e;t++)l[t]=t,n[t]=0;E.gl.uniform1f(E.uniforms.data_length,e)}_=0,g=0,y=0,p=!1,S.textContent="0",k.textContent="0",c=b.checked,s=[P,d[w.value],X],h=0,x=[],function(){if(c)for(let t=0;t<s.length;t++){let t=new AudioContext,e=t.createOscillator();e.type="sine",e.frequency.value=50;let l=t.createGain();e.connect(l),l.connect(t.destination),x.push([t,e,l])}}(),c&&x[h][1].start(0),o=s[0](),window.requestAnimationFrame(D)}function D(t){let a=t-u;if(u=t,0===a)return;let i=new Uint8Array(4*e);for(let t=0;t<e;t++)i[4*t]=Math.floor(l[t]/256),i[4*t+1]=l[t]%256,i[4*t+2]=Math.floor(n[t]/r*256);if(E.gl.texImage2D(E.gl.TEXTURE_2D,0,E.gl.RGBA,e,1,0,E.gl.RGBA,E.gl.UNSIGNED_BYTE,i),E.render.draw_frame(),function(){for(let t=0;t<e;t++)n[t]=Math.max(n[t]-1,0)}(),p&&(S.textContent=_,k.textContent=g),T||o.next(),f===Site.applet_process_id)window.requestAnimationFrame(D);else{console.log("Terminated applet process");try{x[h][2].gain.linearRampToValueAtTime(1e-4,x[h][0].currentTime+.016)}catch(t){}}}function U(t,e=!1){_++}function z(t,o=!0,u=!0){return o&&(n[t]=r-1),g++,++y>=m&&(y=0,u&&function(t){c&&x[h][1].frequency.linearRampToValueAtTime((i-a)*l[t]/e+a,x[h][0].currentTime+.016)}(t),!0)}function C(){T=!0,c&&x[h][2].gain.linearRampToValueAtTime(1e-4,x[h][0].currentTime+.016),++h<s.length&&setTimeout(()=>{c&&x[h][1].start(0),o=s[h](),T=!1},1e3)}function*P(){m=Math.ceil(e/60);for(let t=0;t<e-1;t++){let n=Math.floor(Math.random()*(e-t-1))+t,r=l[t];l[t]=l[n],l[n]=r,z(t)&&(yield),z(n)&&(yield)}_=0,g=0,p=!0,C()}function*X(){p=!1,m=Math.ceil(e/60);for(let t=0;t<e;t++)z(t)&&(yield);c&&x[h][2].gain.linearRampToValueAtTime(1e-4,x[h][0].currentTime+.016)}document.querySelector("#download-button").addEventListener("click",()=>{E.download_frame("an-aztec-diamond.png")})}();