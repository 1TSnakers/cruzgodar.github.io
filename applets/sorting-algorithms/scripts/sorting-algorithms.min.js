!function(){"use strict";let t=2e3,e=null,l=[],n=[],r=40,o=null,a=20,i=600,c=!0,u=-1,f=0,d=null,s={bubble:function*(){p=Math.ceil(e*e/2500);for(;;){let t=!0;for(let n=0;n<e-1;n++)if(z(n),z(n+1),l[n]>l[n+1]){t=!1;let e=l[n];l[n]=l[n+1],l[n+1]=e,C(n)&&(yield),C(n+1)&&(yield)}if(t)break}P()},insertion:function*(){p=Math.ceil(e*e/5e3);for(let t=1;t<e;t++)if(z(t),z(t-1),l[t]<l[t-1])for(let e=0;e<t;e++)if(z(e),z(t),l[e]>l[t]){let n=l[t];for(let n=t;n>e;n--)l[n]=l[n-1],C(n)&&(yield);l[e]=n,C(e)&&(yield)}P()},selection:function*(){p=Math.ceil(e/1e3);for(let t=0;t<e;t++){let n=-1,r=e;for(let o=t;o<e;o++)z(o),z(r),l[o]<r&&(r=l[o],n=o);let o=l[t];l[t]=r,l[n]=o,C(t)&&(yield),C(n)&&(yield)}P()},heap:function*(){p=Math.ceil(e*Math.log(e)/500);for(let t=1;t<e;t++){let e=t,n=0;for(;0!==e&&(n=Math.floor((e-1)/2),z(e),z(n),l[e]>l[n]);){let t=l[e];l[e]=l[n],l[n]=t,C(e)&&(yield),C(n)&&(yield),e=n}}for(let t=e-1;t>=0;t--){let e=l[0];l[0]=l[t],l[t]=e,C(0)&&(yield),C(t)&&(yield);let n=0,r=0,o=0,a=0;for(;o=(r=2*n+1)+1,!(r>=t)&&(o>=t?a=r:(z(r),z(o),a=l[r]>l[o]?r:o),z(n),z(a),l[n]<l[a]);){let t=l[n];l[n]=l[a],l[a]=t,C(n)&&(yield),C(a)&&(yield),n=a}}P()},merge:function*(){p=Math.ceil(e*Math.log(e)/450);let t=new Array(e),n=1;for(;;){for(let r=0;r<e;r+=2*n){let o=0,a=n,i=0;for(;;)if(a+r>=e||a>=2*n){if(o>=n||r+o>=e)break;t[i]=l[r+o],C(r+o)&&(yield),o++,i++}else o>=n||r+o>=e?(t[i]=l[r+a],C(r+a)&&(yield),a++,i++):(z(r+o),z(r+a),l[r+o]<l[r+a]?(t[i]=l[r+o],C(r+o)&&(yield),o++,i++):(t[i]=l[r+a],C(r+a)&&(yield),a++,i++));for(let o=0;o<2*n&&!(r+o>=e);o++)l[r+o]=t[o],C(r+o)&&(yield)}if((n*=2)>=e)break}P()},quick:function*(){p=Math.ceil(e*Math.log(e)/2250);let t=new Array(e);t[0]=0,t[1]=e-1;let n=new Array(e),r=1,o=0;for(;r>0;){for(let e=0;e<r;e++){let r=l[Math.floor((t[2*e]+t[2*e+1])/2)];z(Math.floor((t[2*e]+t[2*e+1])/2));let a=t[2*e]-1,i=t[2*e+1]+1;for(;;){do{z(++a)}while(l[a]<r);z(a);do{z(--i)}while(l[i]>r);if(z(i),a>=i)break;let t=l[a];l[a]=l[i],l[i]=t,C(a)&&(yield),C(i)&&(yield)}i>t[2*e]&&(n[2*o]=t[2*e],n[2*o+1]=i,o++),t[2*e+1]>i+1&&(n[2*o]=i+1,n[2*o+1]=t[2*e+1],o++)}r=o,o=0;for(let e=0;e<2*r;e++)t[e]=n[e]}P()},cycle:function*(){p=Math.ceil(e/2e3);let t=new Array(e);for(let l=0;l<e;l++)t[l]=!1;for(let n=0;n<e;n++){if(t[n])continue;z(n);let r=l[n],o=r,a=0;do{a=0;for(let t=0;t<e;t++)z(t),l[t]<r&&a++;r>o&&a--;let n=l[a];l[a]=r,r=n,C(a)&&(yield),t[a]=!0}while(a!==n)}P()},"msd-radix":function*(){let t=0,n=1/Math.log(2);for(let r=0;r<e;r++){z(r);let e=Math.log(l[r])*n;t=Math.max(t,e)}t=Math.round(t),p=Math.ceil(e*t/650);let r=new Array(e);r[0]=0,r[1]=e-1;let o=new Array(e),a=1,i=0,c=new Array(e),u=Math.pow(2,t-1);for(let e=0;e<t;e++){for(let t=0;t<a;t++){let e=r[2*t],n=r[2*t+1];for(let o=r[2*t];o<=r[2*t+1];o++){z(o);let t=Math.floor(l[o]/u)%2;0===t?(c[e]=l[o],C(e)&&(yield),e++):(c[n]=l[o],C(n)&&(yield),n--)}for(let e=r[2*t];e<=r[2*t+1];e++)l[e]=c[e],C(e)&&(yield);n++,--e>r[2*t]&&(o[2*i]=r[2*t],o[2*i+1]=e,i++),r[2*t+1]>n&&(o[2*i]=n,o[2*i+1]=r[2*t+1],i++)}a=i,i=0;for(let t=0;t<2*a;t++)r[t]=o[t];u/=2}P()},"lsd-radix":function*(){let t=0,n=1/Math.log(2);for(let r=0;r<e;r++){z(r);let e=Math.log(l[r])*n;t=Math.max(t,e)}t=Math.round(t),p=Math.ceil(e*t/650);let r=new Array(e),o=1;for(let n=0;n<t;n++){let t=0,n=e-1;for(let a=0;a<e;a++){z(a);let e=Math.floor(l[a]/o)%2;0===e?(r[t]=l[a],C(t)&&(yield),t++):(r[n]=l[a],C(n)&&(yield),n--)}t--,n++;for(let e=0;e<=t;e++)l[e]=r[e],C(e)&&(yield);for(let t=0;t<e-n;t++)l[n+t]=r[e-1-t],C(n+t)&&(yield);o*=2}P()},gravity:function*(){p=Math.ceil(e*e/1e6);let t=new Array(e);for(let l=0;l<e;l++){t[l]=new Array(e);for(let n=0;n<e;n++)t[l][n]=!1}let n=0,r=0;for(let o=0;o<e;o++){z(o);let e=l[o];for(let l=0;l<e;l++)t[o][l]=!0;e-o>r&&(r=e-o,n=o)}for(let r=0;r<e;r++){for(let n=e-1;n>=0;n--)if(t[n][r]){let o=n;do{o++}while(o<e&&!t[o][r]);o--,t[n][r]=!1,t[o][r]=!0,l[n]--,l[o]++,C(n,!1,!1),C(o,!1,!1)}C(n,!1,!0)&&(yield),y--,m--}P()}},h=[X,null,L],_=0,g=0,y=0,m=0,p=1,T=!1,x=!1,v=[],E={renderer:"gpu",shader:"\n\t\tprecision highp float;\n\t\t\n\t\tvarying vec2 uv;\n\t\t\n\t\tuniform float data_length;\n\t\t\n\t\tconst float circle_size = .8;\n\t\t\n\t\tuniform sampler2D u_texture;\n\t\t\n\t\t\n\t\t\n\t\tvec3 hsv2rgb(vec3 c)\n\t\t{\n\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tvoid main(void)\n\t\t{\n\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\n\t\t\tif (length(uv) <= circle_size)\n\t\t\t{\n\t\t\t\tfloat sample = mod(atan(uv.y, uv.x) / 6.283, 1.0);\n\t\t\t\t\n\t\t\t\tvec4 output_1 = texture2D(u_texture, vec2(floor(sample * data_length) / data_length, .5));\n\t\t\t\tvec4 output_2 = texture2D(u_texture, vec2(mod(floor(sample * data_length + 1.0) / data_length, 1.0), .5));\n\t\t\t\t\n\t\t\t\tfloat brightness = mix(output_1.z, output_2.z, fract(sample * data_length));\n\t\t\t\t\n\t\t\t\tfloat h_1 = (output_1.x * 256.0 + output_1.y) / data_length * 255.0;\n\t\t\t\tfloat h_2 = (output_2.x * 256.0 + output_2.y) / data_length * 255.0;\n\t\t\t\t\n\t\t\t\tif (abs(h_1 - h_2) > .5)\n\t\t\t\t{\n\t\t\t\t\tif (h_1 > h_2)\n\t\t\t\t\t{\n\t\t\t\t\t\th_1 -= 1.0;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\th_2 -= 1.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat h = mix(h_1, h_2, fract(sample * data_length));\n\t\t\t\t\n\t\t\t\tfloat s = clamp((length(uv) / circle_size - .03) * (1.0 - brightness), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tfloat v = clamp((1.0 - length(uv) / circle_size) * 100.0, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t}\n\t\t}\n\t",canvas_width:2e3,canvas_height:2e3,use_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png"},M=new Wilson(document.querySelector("#output-canvas"),E);M.render.init_uniforms(["data_length"]);let w=M.gl.createTexture();M.gl.bindTexture(M.gl.TEXTURE_2D,w),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_MAG_FILTER,M.gl.NEAREST),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_MIN_FILTER,M.gl.NEAREST),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_WRAP_S,M.gl.CLAMP_TO_EDGE),M.gl.texParameteri(M.gl.TEXTURE_2D,M.gl.TEXTURE_WRAP_T,M.gl.CLAMP_TO_EDGE),M.gl.disable(M.gl.DEPTH_TEST);let A=document.querySelector("#algorithm-selector-dropdown");A.addEventListener("input",()=>{Page.set_element_styles(".info-text","opacity",0),setTimeout(()=>{Page.set_element_styles(".info-text","display","none");let t=document.querySelector(`#${A.value}-info`);t.style.display="block",setTimeout(()=>{t.style.opacity=1},10)},Site.opacity_animation_time)}),document.querySelector("#generate-button").addEventListener("click",D);let R=document.querySelector("#resolution-input");R.addEventListener("keydown",t=>{13===t.keyCode&&D()});let b=document.querySelector("#array-size-input");b.addEventListener("keydown",t=>{13===t.keyCode&&D()});let S=document.querySelector("#play-sound-checkbox");S.checked=!0;let k=document.querySelector("#num-reads"),q=document.querySelector("#num-writes");function D(){try{v[_][2].gain.linearRampToValueAtTime(1e-4,v[_][0].currentTime+f/1e3)}catch(t){}d=Site.applet_process_id,t=parseInt(R.value||2e3),M.change_canvas_size(t,t);let r=e;if((e=parseInt(b.value||256))!==r){l=new Array(e),n=new Array(e);for(let t=0;t<e;t++)l[t]=t,n[t]=0;M.gl.uniform1f(M.uniforms.data_length,e)}g=0,y=0,m=0,T=!1,k.textContent="0",q.textContent="0",c=S.checked,h=[X,s[A.value],L],_=0,v=[],function(){if(c)for(let t=0;t<h.length;t++){let t=new AudioContext,e=t.createOscillator();e.type="sine",e.frequency.value=50;let l=t.createGain();e.connect(l),l.connect(t.destination),v.push([t,e,l])}}(),c&&v[_][1].start(0),o=h[0](),window.requestAnimationFrame(U)}function U(t){if(f=t-u,u=t,0===f)return;let a=new Uint8Array(4*e);for(let t=0;t<e;t++)a[4*t]=Math.floor(l[t]/256),a[4*t+1]=l[t]%256,a[4*t+2]=Math.floor(n[t]/r*256);if(M.gl.texImage2D(M.gl.TEXTURE_2D,0,M.gl.RGBA,e,1,0,M.gl.RGBA,M.gl.UNSIGNED_BYTE,a),M.render.draw_frame(),function(){for(let t=0;t<e;t++)n[t]=Math.max(n[t]-1,0)}(),T&&(k.textContent=g,q.textContent=y),x||o.next(),d===Site.applet_process_id)window.requestAnimationFrame(U);else{console.log("Terminated applet process");try{v[_][2].gain.linearRampToValueAtTime(1e-4,v[_][0].currentTime+f/1e3)}catch(t){}}}function z(t,e=!1){g++}function C(t,o=!0,u=!0){return o&&(n[t]=r-1),y++,++m>=p&&(m=0,u&&function(t){c&&v[_][1].frequency.linearRampToValueAtTime((i-a)*l[t]/e+a,v[_][0].currentTime+f/1e3)}(t),!0)}function P(){x=!0,c&&v[_][2].gain.linearRampToValueAtTime(1e-4,v[_][0].currentTime+f/1e3),++_<h.length&&setTimeout(()=>{c&&v[_][1].start(0),o=h[_](),x=!1},1e3)}function*X(){p=Math.ceil(e/60);for(let t=0;t<e-1;t++){let n=Math.floor(Math.random()*(e-t-1))+t,r=l[t];l[t]=l[n],l[n]=r,C(t)&&(yield),C(n)&&(yield)}g=0,y=0,T=!0,P()}function*L(){T=!1,p=Math.ceil(e/60);for(let t=0;t<e;t++)C(t)&&(yield);c&&v[_][2].gain.linearRampToValueAtTime(1e-4,v[_][0].currentTime+f/1e3)}document.querySelector("#download-button").addEventListener("click",()=>{M.download_frame("an-aztec-diamond.png")})}();