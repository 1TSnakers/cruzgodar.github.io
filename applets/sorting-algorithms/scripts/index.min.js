!function(){"use strict";let e=2e3,t=null,l=[],i=[],o=null,n=!0,r=-1,a=0,c=null,f={bubble:function* e(){for(m=Math.ceil(t*t/2500);;){let i=!0;for(let o=0;o<t-1;o++)if(P(o),P(o+1),l[o]>l[o+1]){i=!1;let n=l[o];l[o]=l[o+1],l[o+1]=n,F(o)&&(yield),F(o+1)&&(yield)}if(i)break}S()},insertion:function* e(){m=Math.ceil(t*t/5e3);for(let i=1;i<t;i++)if(P(i),P(i-1),l[i]<l[i-1]){for(let o=0;o<i;o++)if(P(o),P(i),l[o]>l[i]){let n=l[i];for(let r=i;r>o;r--)l[r]=l[r-1],F(r)&&(yield);l[o]=n,F(o)&&(yield)}}S()},selection:function* e(){m=Math.ceil(t/1e3);for(let i=0;i<t;i++){let o=-1,n=t;for(let r=i;r<t;r++)P(r),P(n),l[r]<n&&(n=l[r],o=r);let a=l[i];l[i]=n,l[o]=a,F(i)&&(yield),F(o)&&(yield)}S()},heap:function* e(){m=Math.ceil(t*Math.log(t)/500);for(let i=1;i<t;i++){let o=i,n=0;for(;0!==o;)if(n=Math.floor((o-1)/2),P(o),P(n),l[o]>l[n]){let r=l[o];l[o]=l[n],l[n]=r,F(o)&&(yield),F(n)&&(yield),o=n}else break}for(let a=t-1;a>=0;a--){let c=l[0];l[0]=l[a],l[a]=c,F(0)&&(yield),F(a)&&(yield);let f=0,_=0,u=0,d=0;for(;u=(_=2*f+1)+1,!(_>=a);)if(u>=a?d=_:(P(_),P(u),d=l[_]>l[u]?_:u),P(f),P(d),l[f]<l[d]){let s=l[f];l[f]=l[d],l[d]=s,F(f)&&(yield),F(d)&&(yield),f=d}else break}S()},merge:function* e(){m=Math.ceil(t*Math.log(t)/450);let i=Array(t),o=1;for(;;){for(let n=0;n<t;n+=2*o){let r=0,a=o,c=0;for(;;)if(a+n>=t||a>=2*o){if(r>=o||n+r>=t)break;i[c]=l[n+r],F(n+r)&&(yield),r++,c++}else r>=o||n+r>=t?(i[c]=l[n+a],F(n+a)&&(yield),a++,c++):(P(n+r),P(n+a),l[n+r]<l[n+a]?(i[c]=l[n+r],F(n+r)&&(yield),r++,c++):(i[c]=l[n+a],F(n+a)&&(yield),a++,c++));for(let f=0;f<2*o&&!(n+f>=t);f++)l[n+f]=i[f],F(n+f)&&(yield)}if((o*=2)>=t)break}S()},quick:function* e(){m=Math.ceil(t*Math.log(t)/2250);let i=Array(t);i[0]=0,i[1]=t-1;let o=Array(t),n=1,r=0;for(;n>0;){for(let a=0;a<n;a++){let c=l[Math.floor((i[2*a]+i[2*a+1])/2)];P(Math.floor((i[2*a]+i[2*a+1])/2));let f=i[2*a]-1,_=i[2*a+1]+1;for(;;){do P(++f);while(l[f]<c);P(f);do P(--_);while(l[_]>c);if(P(_),f>=_)break;let u=l[f];l[f]=l[_],l[_]=u,F(f)&&(yield),F(_)&&(yield)}_>i[2*a]&&(o[2*r]=i[2*a],o[2*r+1]=_,r++),i[2*a+1]>_+1&&(o[2*r]=_+1,o[2*r+1]=i[2*a+1],r++)}n=r,r=0;for(let d=0;d<2*n;d++)i[d]=o[d]}S()},cycle:function* e(){m=Math.ceil(t/2e3);let i=Array(t);for(let o=0;o<t;o++)i[o]=!1;for(let n=0;n<t;n++){if(i[n])continue;P(n);let r=l[n],a=r,c=0;do{c=0;for(let f=0;f<t;f++)P(f),l[f]<r&&c++;r>a&&c--;let _=l[c];l[c]=r,r=_,F(c)&&(yield),i[c]=!0}while(c!==n)}S()},"msd-radix":function* e(){let i=0,o=1/Math.log(2);for(let n=0;n<t;n++){P(n);i=Math.max(i,Math.log(l[n])*o)}m=Math.ceil(t*(i=Math.round(i))/650);let r=Array(t);r[0]=0,r[1]=t-1;let a=Array(t),c=1,f=0,_=Array(t),u=Math.pow(2,i-1);for(let d=0;d<i;d++){for(let s=0;s<c;s++){let g=r[2*s],y=r[2*s+1];for(let h=r[2*s];h<=r[2*s+1];h++){P(h);0==Math.floor(l[h]/u)%2?(_[g]=l[h],F(g)&&(yield),g++):(_[y]=l[h],F(y)&&(yield),y--)}for(let p=r[2*s];p<=r[2*s+1];p++)l[p]=_[p],F(p)&&(yield);g--,y++,g>r[2*s]&&(a[2*f]=r[2*s],a[2*f+1]=g,f++),r[2*s+1]>y&&(a[2*f]=y,a[2*f+1]=r[2*s+1],f++)}c=f,f=0;for(let T=0;T<2*c;T++)r[T]=a[T];u/=2}S()},"lsd-radix":function* e(){let i=0,o=1/Math.log(2);for(let n=0;n<t;n++){P(n);i=Math.max(i,Math.log(l[n])*o)}m=Math.ceil(t*(i=Math.round(i))/650);let r=Array(t),a=1;for(let c=0;c<i;c++){let f=0,_=t-1;for(let u=0;u<t;u++){P(u);0==Math.floor(l[u]/a)%2?(r[f]=l[u],F(f)&&(yield),f++):(r[_]=l[u],F(_)&&(yield),_--)}f--,_++;for(let d=0;d<=f;d++)l[d]=r[d],F(d)&&(yield);for(let s=0;s<t-_;s++)l[_+s]=r[t-1-s],F(_+s)&&(yield);a*=2}S()},gravity:function* e(){m=Math.ceil(t*t/1e6);let i=Array(t);for(let o=0;o<t;o++){i[o]=Array(t);for(let n=0;n<t;n++)i[o][n]=!1}let r=0,a=0;for(let c=0;c<t;c++){P(c);let f=l[c];for(let _=0;_<f;_++)i[c][_]=!0;f-c>a&&(a=f-c,r=c)}for(let u=0;u<t;u++){for(let d=t-1;d>=0;d--)if(i[d][u]){let y=d;do y++;while(y<t&&!i[y][u]);y--,i[d][u]=!1,i[y][u]=!0,l[d]--,l[y]++,F(d,!1,!1),F(y,!1,!1)}F(r,!1,!0)&&(yield),s--,g--}S()}},_=[U,null,z],u=0,d=0,s=0,g=0,m=1,y=!1,h=!1,p=[],T=`
  precision highp float;
  
  varying vec2 uv;
  
  uniform float dataLength;
  
  const float circleSize = .8;
  
  uniform sampler2D uTexture;
  
  
  
  vec3 hsv2rgb(vec3 c)
  {
   vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
   vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
   return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
  }
  
  
  
  void main(void)
  {
   gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
   
   if (length(uv) <= circleSize)
   {
    float sample = mod(atan(uv.y, uv.x) / 6.283, 1.0);
    
    vec4 output1 = texture2D(uTexture, vec2(floor(sample * dataLength) / dataLength, .5));
    vec4 output2 = texture2D(uTexture, vec2(mod(floor(sample * dataLength + 1.0) / dataLength, 1.0), .5));
    
    float brightness = mix(output1.z, output2.z, fract(sample * dataLength));
    
    float h1 = (output1.x * 256.0 + output1.y) / dataLength * 255.0;
    float h2 = (output2.x * 256.0 + output2.y) / dataLength * 255.0;
    
    if (abs(h1 - h2) > .5)
    {
     if (h1 > h2)
     {
      h1 -= 1.0;
     }
     
     else
     {
      h2 -= 1.0;
     }
    }
    
    
    
    float h = mix(h1, h2, fract(sample * dataLength));
    
    float s = clamp((length(uv) / circleSize - .03) * (1.0 - brightness), 0.0, 1.0);
    
    float v = clamp((1.0 - length(uv) / circleSize) * 100.0, 0.0, 1.0);
    
    gl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);
   }
  }
 `,x=new Wilson($("#output-canvas"),{renderer:"gpu",shader:T,canvasWidth:2e3,canvasHeight:2e3,useFullscreen:!0,useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"});x.render.initUniforms(["dataLength"]);let v=x.gl.createTexture();x.gl.bindTexture(x.gl.TEXTURE_2D,v),x.gl.texParameteri(x.gl.TEXTURE_2D,x.gl.TEXTURE_MAG_FILTER,x.gl.NEAREST),x.gl.texParameteri(x.gl.TEXTURE_2D,x.gl.TEXTURE_MIN_FILTER,x.gl.NEAREST),x.gl.texParameteri(x.gl.TEXTURE_2D,x.gl.TEXTURE_WRAP_S,x.gl.CLAMP_TO_EDGE),x.gl.texParameteri(x.gl.TEXTURE_2D,x.gl.TEXTURE_WRAP_T,x.gl.CLAMP_TO_EDGE),x.gl.disable(x.gl.DEPTH_TEST);let E=$("#algorithm-selector-dropdown");E.addEventListener("input",()=>{Page.setElementStyles(".info-text","opacity",0),setTimeout(()=>{Page.setElementStyles(".info-text","display","none");let e=$(`#${E.value}-info`);e.style.display="block",setTimeout(()=>{e.style.opacity=1},10)},Site.opacityAnimationTime)});$("#generate-button").addEventListener("click",A);let R=$("#resolution-input");R.addEventListener("keydown",e=>{13===e.keyCode&&A()});let b=$("#array-size-input");b.addEventListener("keydown",e=>{13===e.keyCode&&A()});let L=$("#play-sound-checkbox");L.checked=!0;let w=$("#num-reads"),k=$("#num-writes");function A(){try{p[u][2].gain.linearRampToValueAtTime(1e-4,p[u][0].currentTime+a/1e3)}catch(r){}c=Site.appletProcessId,e=parseInt(R.value||2e3),x.changeCanvasSize(e,e);let m=t;if((t=parseInt(b.value||256))!==m){l=Array(t),i=Array(t);for(let h=0;h<t;h++)l[h]=h,i[h]=0;x.gl.uniform1f(x.uniforms.dataLength,t)}d=0,s=0,g=0,y=!1,w.textContent="0",k.textContent="0",n=L.checked,_=[U,f[E.value],z],u=0,p=[],function e(){if(n)for(let t=0;t<_.length;t++){let l=new AudioContext,i=l.createOscillator();i.type="sine",i.frequency.value=50;let o=l.createGain();i.connect(o),o.connect(l.destination),p.push([l,i,o])}}(),n&&p[u][1].start(0),o=_[0](),window.requestAnimationFrame(D)}function D(e){if(a=e-r,r=e,0===a)return;let n=new Uint8Array(4*t);for(let f=0;f<t;f++)n[4*f]=Math.floor(l[f]/256),n[4*f+1]=l[f]%256,n[4*f+2]=Math.floor(i[f]/40*256);if(x.gl.texImage2D(x.gl.TEXTURE_2D,0,x.gl.RGBA,t,1,0,x.gl.RGBA,x.gl.UNSIGNED_BYTE,n),x.render.drawFrame(),function e(){for(let l=0;l<t;l++)i[l]=Math.max(i[l]-1,0)}(),y&&(w.textContent=d,k.textContent=s),h||o.next(),c!==Site.appletProcessId){console.log("Terminated applet process");try{p[u][2].gain.linearRampToValueAtTime(1e-4,p[u][0].currentTime+a/1e3)}catch(_){}return}window.requestAnimationFrame(D)}function P(e,t=!1){d++}function F(e,o=!0,r=!0){var c;return o&&(i[e]=39),s++,++g>=m&&(g=0,r&&(c=e,n&&p[u][1].frequency.linearRampToValueAtTime(580*l[c]/t+20,p[u][0].currentTime+a/1e3)),!0)}function S(){h=!0,n&&p[u][2].gain.linearRampToValueAtTime(1e-4,p[u][0].currentTime+a/1e3),++u<_.length&&setTimeout(()=>{n&&p[u][1].start(0),o=_[u](),h=!1},1e3)}function*U(){m=Math.ceil(t/60);for(let e=0;e<t-1;e++){let i=Math.floor(Math.random()*(t-e-1))+e,o=l[e];l[e]=l[i],l[i]=o,F(e)&&(yield),F(i)&&(yield)}d=0,s=0,y=!0,S()}function*z(){y=!1,m=Math.ceil(t/60);for(let e=0;e<t;e++)F(e)&&(yield);n&&p[u][2].gain.linearRampToValueAtTime(1e-4,p[u][0].currentTime+a/1e3)}$("#download-button").addEventListener("click",()=>{x.downloadFrame("an-aztec-diamond.png")}),Page.show()}();