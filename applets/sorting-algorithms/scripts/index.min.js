!function(){"use strict";let e=2e3,t=null,l=[],$=[],r=null,o=!0,n=-1,i=0,a=null,c={bubble:function* e(){for(g=Math.ceil(t*t/2500);;){let $=!0;for(let r=0;r<t-1;r++)if(A(r),A(r+1),l[r]>l[r+1]){$=!1;let o=l[r];l[r]=l[r+1],l[r+1]=o,q(r)&&(yield),q(r+1)&&(yield)}if($)break}D()},insertion:function* e(){g=Math.ceil(t*t/5e3);for(let $=1;$<t;$++)if(A($),A($-1),l[$]<l[$-1]){for(let r=0;r<$;r++)if(A(r),A($),l[r]>l[$]){let o=l[$];for(let n=$;n>r;n--)l[n]=l[n-1],q(n)&&(yield);l[r]=o,q(r)&&(yield)}}D()},selection:function* e(){g=Math.ceil(t/1e3);for(let $=0;$<t;$++){let r=-1,o=t;for(let n=$;n<t;n++)A(n),A(o),l[n]<o&&(o=l[n],r=n);let i=l[$];l[$]=o,l[r]=i,q($)&&(yield),q(r)&&(yield)}D()},heap:function* e(){g=Math.ceil(t*Math.log(t)/500);for(let $=1;$<t;$++){let r=$,o=0;for(;0!==r;)if(o=Math.floor((r-1)/2),A(r),A(o),l[r]>l[o]){let n=l[r];l[r]=l[o],l[o]=n,q(r)&&(yield),q(o)&&(yield),r=o}else break}for(let i=t-1;i>=0;i--){let a=l[0];l[0]=l[i],l[i]=a,q(0)&&(yield),q(i)&&(yield);let c=0,u=0,f=0,_=0;for(;f=(u=2*c+1)+1,!(u>=i);)if(f>=i?_=u:(A(u),A(f),_=l[u]>l[f]?u:f),A(c),A(_),l[c]<l[_]){let d=l[c];l[c]=l[_],l[_]=d,q(c)&&(yield),q(_)&&(yield),c=_}else break}D()},merge:function* e(){g=Math.ceil(t*Math.log(t)/450);let $=Array(t),r=1;for(;;){for(let o=0;o<t;o+=2*r){let n=0,i=r,a=0;for(;;)if(i+o>=t||i>=2*r){if(n>=r||o+n>=t)break;$[a]=l[o+n],q(o+n)&&(yield),n++,a++}else n>=r||o+n>=t?($[a]=l[o+i],q(o+i)&&(yield),i++,a++):(A(o+n),A(o+i),l[o+n]<l[o+i]?($[a]=l[o+n],q(o+n)&&(yield),n++,a++):($[a]=l[o+i],q(o+i)&&(yield),i++,a++));for(let c=0;c<2*r&&!(o+c>=t);c++)l[o+c]=$[c],q(o+c)&&(yield)}if((r*=2)>=t)break}D()},quick:function* e(){g=Math.ceil(t*Math.log(t)/2250);let $=Array(t);$[0]=0,$[1]=t-1;let r=Array(t),o=1,n=0;for(;o>0;){for(let i=0;i<o;i++){let a=l[Math.floor(($[2*i]+$[2*i+1])/2)];A(Math.floor(($[2*i]+$[2*i+1])/2));let c=$[2*i]-1,u=$[2*i+1]+1;for(;;){do A(++c);while(l[c]<a);A(c);do A(--u);while(l[u]>a);if(A(u),c>=u)break;let f=l[c];l[c]=l[u],l[u]=f,q(c)&&(yield),q(u)&&(yield)}u>$[2*i]&&(r[2*n]=$[2*i],r[2*n+1]=u,n++),$[2*i+1]>u+1&&(r[2*n]=u+1,r[2*n+1]=$[2*i+1],n++)}o=n,n=0;for(let _=0;_<2*o;_++)$[_]=r[_]}D()},cycle:function* e(){g=Math.ceil(t/2e3);let $=Array(t);for(let r=0;r<t;r++)$[r]=!1;for(let o=0;o<t;o++){if($[o])continue;A(o);let n=l[o],i=n,a=0;do{a=0;for(let c=0;c<t;c++)A(c),l[c]<n&&a++;n>i&&a--;let u=l[a];l[a]=n,n=u,q(a)&&(yield),$[a]=!0}while(a!==o)}D()},"msd-radix":function* e(){let $=0,r=1/Math.log(2);for(let o=0;o<t;o++){A(o);$=Math.max($,Math.log(l[o])*r)}g=Math.ceil(t*($=Math.round($))/650);let n=Array(t);n[0]=0,n[1]=t-1;let i=Array(t),a=1,c=0,u=Array(t),f=Math.pow(2,$-1);for(let _=0;_<$;_++){for(let d=0;d<a;d++){let s=n[2*d],m=n[2*d+1];for(let y=n[2*d];y<=n[2*d+1];y++){A(y);0==Math.floor(l[y]/f)%2?(u[s]=l[y],q(s)&&(yield),s++):(u[m]=l[y],q(m)&&(yield),m--)}for(let h=n[2*d];h<=n[2*d+1];h++)l[h]=u[h],q(h)&&(yield);s--,m++,s>n[2*d]&&(i[2*c]=n[2*d],i[2*c+1]=s,c++),n[2*d+1]>m&&(i[2*c]=m,i[2*c+1]=n[2*d+1],c++)}a=c,c=0;for(let p=0;p<2*a;p++)n[p]=i[p];f/=2}D()},"lsd-radix":function* e(){let $=0,r=1/Math.log(2);for(let o=0;o<t;o++){A(o);$=Math.max($,Math.log(l[o])*r)}g=Math.ceil(t*($=Math.round($))/650);let n=Array(t),i=1;for(let a=0;a<$;a++){let c=0,u=t-1;for(let f=0;f<t;f++){A(f);0==Math.floor(l[f]/i)%2?(n[c]=l[f],q(c)&&(yield),c++):(n[u]=l[f],q(u)&&(yield),u--)}c--,u++;for(let _=0;_<=c;_++)l[_]=n[_],q(_)&&(yield);for(let d=0;d<t-u;d++)l[u+d]=n[t-1-d],q(u+d)&&(yield);i*=2}D()},gravity:function* e(){g=Math.ceil(t*t/1e6);let $=Array(t);for(let r=0;r<t;r++){$[r]=Array(t);for(let o=0;o<t;o++)$[r][o]=!1}let n=0,i=0;for(let a=0;a<t;a++){A(a);let c=l[a];for(let u=0;u<c;u++)$[a][u]=!0;c-a>i&&(i=c-a,n=a)}for(let f=0;f<t;f++){for(let _=t-1;_>=0;_--)if($[_][f]){let m=_;do m++;while(m<t&&!$[m][f]);m--,$[_][f]=!1,$[m][f]=!0,l[_]--,l[m]++,q(_,!1,!1),q(m,!1,!1)}q(n,!1,!0)&&(yield),d--,s--}D()}},u=[P,null,F],f=0,_=0,d=0,s=0,g=1,m=!1,y=!1,h=[],p=`
  precision highp float;
  
  varying vec2 uv;
  
  uniform float dataLength;
  
  const float circleSize = .8;
  
  uniform sampler2D uTexture;
  
  
  
  vec3 hsv2rgb(vec3 c)
  {
   vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
   vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
   return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
  }
  
  
  
  void main(void)
  {
   gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
   
   if (length(uv) <= circleSize)
   {
    float sample = mod(atan(uv.y, uv.x) / 6.283, 1.0);
    
    vec4 output1 = texture2D(uTexture, vec2(floor(sample * dataLength) / dataLength, .5));
    vec4 output2 = texture2D(uTexture, vec2(mod(floor(sample * dataLength + 1.0) / dataLength, 1.0), .5));
    
    float brightness = mix(output1.z, output2.z, fract(sample * dataLength));
    
    float h1 = (output1.x * 256.0 + output1.y) / dataLength * 255.0;
    float h2 = (output2.x * 256.0 + output2.y) / dataLength * 255.0;
    
    if (abs(h1 - h2) > .5)
    {
     if (h1 > h2)
     {
      h1 -= 1.0;
     }
     
     else
     {
      h2 -= 1.0;
     }
    }
    
    
    
    float h = mix(h1, h2, fract(sample * dataLength));
    
    float s = clamp((length(uv) / circleSize - .03) * (1.0 - brightness), 0.0, 1.0);
    
    float v = clamp((1.0 - length(uv) / circleSize) * 100.0, 0.0, 1.0);
    
    gl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);
   }
  }
 `,T=new Wilson(Page.element.querySelector("#output-canvas"),{renderer:"gpu",shader:p,canvasWidth:2e3,canvasHeight:2e3,useFullscreen:!0,useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"});T.render.initUniforms(["dataLength"]);let x=T.gl.createTexture();T.gl.bindTexture(T.gl.TEXTURE_2D,x),T.gl.texParameteri(T.gl.TEXTURE_2D,T.gl.TEXTURE_MAG_FILTER,T.gl.NEAREST),T.gl.texParameteri(T.gl.TEXTURE_2D,T.gl.TEXTURE_MIN_FILTER,T.gl.NEAREST),T.gl.texParameteri(T.gl.TEXTURE_2D,T.gl.TEXTURE_WRAP_S,T.gl.CLAMP_TO_EDGE),T.gl.texParameteri(T.gl.TEXTURE_2D,T.gl.TEXTURE_WRAP_T,T.gl.CLAMP_TO_EDGE),T.gl.disable(T.gl.DEPTH_TEST);let v=Page.element.querySelector("#algorithm-selector-dropdown");v.addEventListener("input",()=>{Page.setElementStyles(".info-text","opacity",0),setTimeout(()=>{Page.setElementStyles(".info-text","display","none");let e=Page.element.querySelector(`#${v.value}-info`);e.style.display="block",setTimeout(()=>{e.style.opacity=1},10)},Site.opacityAnimationTime)});Page.element.querySelector("#generate-button").addEventListener("click",w);let E=Page.element.querySelector("#resolution-input");E.addEventListener("keydown",e=>{13===e.keyCode&&w()});let R=Page.element.querySelector("#array-size-input");R.addEventListener("keydown",e=>{13===e.keyCode&&w()});let S=Page.element.querySelector("#play-sound-checkbox");S.checked=!0;let b=Page.element.querySelector("#num-reads"),L=Page.element.querySelector("#num-writes");function w(){try{h[f][2].gain.linearRampToValueAtTime(1e-4,h[f][0].currentTime+i/1e3)}catch(n){}a=Site.appletProcessId,e=parseInt(E.value||2e3),T.changeCanvasSize(e,e);let g=t;if((t=parseInt(R.value||256))!==g){l=Array(t),$=Array(t);for(let y=0;y<t;y++)l[y]=y,$[y]=0;T.gl.uniform1f(T.uniforms.dataLength,t)}_=0,d=0,s=0,m=!1,b.textContent="0",L.textContent="0",o=S.checked,u=[P,c[v.value],F],f=0,h=[],function e(){if(o)for(let t=0;t<u.length;t++){let l=new AudioContext,$=l.createOscillator();$.type="sine",$.frequency.value=50;let r=l.createGain();$.connect(r),r.connect(l.destination),h.push([l,$,r])}}(),o&&h[f][1].start(0),r=u[0](),window.requestAnimationFrame(k)}function k(e){if(i=e-n,n=e,0===i)return;let o=new Uint8Array(4*t);for(let c=0;c<t;c++)o[4*c]=Math.floor(l[c]/256),o[4*c+1]=l[c]%256,o[4*c+2]=Math.floor($[c]/40*256);if(T.gl.texImage2D(T.gl.TEXTURE_2D,0,T.gl.RGBA,t,1,0,T.gl.RGBA,T.gl.UNSIGNED_BYTE,o),T.render.drawFrame(),function e(){for(let l=0;l<t;l++)$[l]=Math.max($[l]-1,0)}(),m&&(b.textContent=_,L.textContent=d),y||r.next(),a!==Site.appletProcessId){console.log("Terminated applet process");try{h[f][2].gain.linearRampToValueAtTime(1e-4,h[f][0].currentTime+i/1e3)}catch(u){}return}window.requestAnimationFrame(k)}function A(e,t=!1){_++}function q(e,r=!0,n=!0){var a;return r&&($[e]=39),d++,++s>=g&&(s=0,n&&(a=e,o&&h[f][1].frequency.linearRampToValueAtTime(580*l[a]/t+20,h[f][0].currentTime+i/1e3)),!0)}function D(){y=!0,o&&h[f][2].gain.linearRampToValueAtTime(1e-4,h[f][0].currentTime+i/1e3),++f<u.length&&setTimeout(()=>{o&&h[f][1].start(0),r=u[f](),y=!1},1e3)}function*P(){g=Math.ceil(t/60);for(let e=0;e<t-1;e++){let $=Math.floor(Math.random()*(t-e-1))+e,r=l[e];l[e]=l[$],l[$]=r,q(e)&&(yield),q($)&&(yield)}_=0,d=0,m=!0,D()}function*F(){m=!1,g=Math.ceil(t/60);for(let e=0;e<t;e++)q(e)&&(yield);o&&h[f][2].gain.linearRampToValueAtTime(1e-4,h[f][0].currentTime+i/1e3)}Page.element.querySelector("#download-button").addEventListener("click",()=>{T.downloadFrame("an-aztec-diamond.png")}),Page.show()}();