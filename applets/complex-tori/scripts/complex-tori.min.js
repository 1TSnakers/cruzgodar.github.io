!async function(){"use strict";await Site.load_glsl();let t=null,e=null,n=null,r=null,o=null,a=1,i=1,l=-.585,_=1,c=500,s=1e3,d=-2,u=0,w=0,g=0,f=0,h=0,m=0,p=0,v=0,x=0,z=0,b=0,y=0,M=0,k=0,F=0,q=0,A=0;const K=.96,C=.0025,P=25e-5;let S=-1,D=-1,E=-1;const R=Page.element.querySelector("#resolution-input");R.addEventListener("input",(()=>{c=parseInt(R.value||500),t.change_canvas_size(c,c),e.change_canvas_size(c,c),n.change_canvas_size(c,c),window.requestAnimationFrame(Z),window.requestAnimationFrame(tt)}));const W=Page.element.querySelector("#g2-slider"),L=Page.element.querySelector("#g2-slider-value");W.addEventListener("input",(()=>{d=parseInt(W.value||5e3)/1e3-5,L.textContent=Math.round(1e3*d)/1e3,o.draggables.world_coordinates[0]=[d,u],o.draggables.recalculate_locations(),window.requestAnimationFrame(Z),window.requestAnimationFrame(tt),window.requestAnimationFrame(et)})),L.textContent=d;const j=Page.element.querySelector("#g3-slider"),B=Page.element.querySelector("#g3-slider-value");j.addEventListener("input",(()=>{u=parseInt(j.value||5e3)/1e3-5,B.textContent=Math.round(1e3*u)/1e3,o.draggables.world_coordinates[0]=[d,u],o.draggables.recalculate_locations(),window.requestAnimationFrame(Z),window.requestAnimationFrame(tt),window.requestAnimationFrame(et)})),B.textContent=u;function I(t,e,n){p=0,v=0,x=0,f=0,h=0,m=0}function T(t,e,n){F=0,q=0,A=0,y=0,M=0,k=0}function U(n,r,o,a,i){t.world_center_x-=o,t.world_center_y-=a,e.world_center_x-=o,e.world_center_y-=a,f=-o/t.world_width,h=-a/t.world_height,window.requestAnimationFrame(Z)}function $(t,e,r,o,a){n.world_center_x-=r,n.world_center_y-=o,y=-r/n.world_width,M=-o/n.world_height,window.requestAnimationFrame(tt)}function G(t,e,n){Math.sqrt(f*f+h*h)>=C&&(p=f,v=h),Math.abs(m)>=.01&&(x=m),window.requestAnimationFrame(Z)}function N(t,e,n){Math.sqrt(y*y+M*M)>=C&&(F=y,q=M),Math.abs(k)>=.01&&(A=k),window.requestAnimationFrame(tt)}function H(t,e,n,r){w=t,g=e,Math.abs(n/100)<.3?l+=n/100:x+=.05*Math.sign(n),Y()}function J(t,e,n,r){z=t,b=e,Math.abs(n/100)<.3?_+=n/100:A+=.05*Math.sign(n),Q()}function O(e,n,r,o){a>=1?(l-=r/t.world_width*10,m=-r/t.world_width*10):(l-=r/t.world_height*10,m=-r/t.world_height*10),w=e,g=n,Y()}function X(t,e,r,o){i>=1?(_-=r/n.world_width*10,k=-r/n.world_width*10):(_-=r/n.world_height*10,k=-r/n.world_height*10),z=t,b=e,Q()}function Y(){if(a>=1){const n=t.input.get_zoomed_world_center(w,g,3*Math.pow(2,l)*a,3*Math.pow(2,l));t.world_width=3*Math.pow(2,l)*a,t.world_height=3*Math.pow(2,l),e.world_width=3*Math.pow(2,l)*a,e.world_height=3*Math.pow(2,l),t.world_center_x=n[0],t.world_center_y=n[1],e.world_center_x=n[0],e.world_center_y=n[1]}else{const n=t.input.get_zoomed_world_center(w,g,3*Math.pow(2,l),3*Math.pow(2,l)/a);t.world_width=3*Math.pow(2,l),t.world_height=3*Math.pow(2,l)/a,e.world_width=3*Math.pow(2,l),e.world_height=3*Math.pow(2,l)/a,t.world_center_x=n[0],t.world_center_y=n[1],e.world_center_x=n[0],e.world_center_y=n[1]}window.requestAnimationFrame(Z)}function Q(){if(i>=1){const t=n.input.get_zoomed_world_center(z,b,3*Math.pow(2,_)*i,3*Math.pow(2,_));n.world_width=3*Math.pow(2,_)*i,n.world_height=3*Math.pow(2,_),n.world_center_x=t[0],n.world_center_y=t[1]}else{const t=n.input.get_zoomed_world_center(z,b,3*Math.pow(2,_),3*Math.pow(2,_)/i);n.world_width=3*Math.pow(2,_),n.world_height=3*Math.pow(2,_)/i,n.world_center_x=t[0],n.world_center_y=t[1]}window.requestAnimationFrame(tt)}function V(t,e,n,r){d=e,u=n,W.value=1e3*(d+5),j.value=1e3*(u+5),L.textContent=Math.round(1e3*d)/1e3,B.textContent=Math.round(1e3*u)/1e3,window.requestAnimationFrame(Z),window.requestAnimationFrame(tt),window.requestAnimationFrame(et)}function Z(n){const r=n-S;S=n,0!==r&&(t.gl.uniform1f(t.uniforms.aspect_ratio,a),t.gl.uniform1f(t.uniforms.world_center_x,t.world_center_x),t.gl.uniform1f(t.uniforms.world_center_y,t.world_center_y),t.gl.uniform1f(t.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),t.gl.uniform1f(t.uniforms.black_point,1),t.gl.uniform1f(t.uniforms.white_point,1),t.gl.uniform1f(t.uniforms.g2_arg,d),t.gl.uniform1f(t.uniforms.g3_arg,u),t.render.draw_frame(),e.gl.uniform1f(e.uniforms.aspect_ratio,a),e.gl.uniform1f(e.uniforms.world_center_x,e.world_center_x),e.gl.uniform1f(e.uniforms.world_center_y,e.world_center_y),e.gl.uniform1f(e.uniforms.world_size,Math.min(e.world_height,e.world_width)/2),e.gl.uniform1f(e.uniforms.black_point,1),e.gl.uniform1f(e.uniforms.white_point,1),e.gl.uniform1f(e.uniforms.g2_arg,d),e.gl.uniform1f(e.uniforms.g3_arg,u),e.render.draw_frame(),r>=50&&(p=0,v=0,x=0,f=0,h=0,m=0),0===p&&0===v&&0===x||(t.world_center_x+=p*t.world_width,t.world_center_y+=v*t.world_height,e.world_center_x+=p*e.world_width,e.world_center_y+=v*e.world_height,p*=K,v*=K,Math.sqrt(p*p+v*v)<P&&(p=0,v=0),l+=x,Y(),x*=.93,Math.abs(x)<.001&&(x=0),window.requestAnimationFrame(Z)))}function tt(t){const e=t-D;if(D=t,0===e)return;n.gl.useProgram(n.render.shader_programs[0]),n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,n.render.framebuffers[0].framebuffer),n.gl.uniform1f(n.uniforms.aspect_ratio,i),n.gl.uniform1f(n.uniforms.world_center_x,n.world_center_x),n.gl.uniform1f(n.uniforms.world_center_y,n.world_center_y);const r=Math.min(n.world_height,n.world_width);n.gl.uniform1f(n.uniforms.world_size,r/2),n.gl.uniform1f(n.uniforms.step,r/s),n.gl.uniform1f(n.uniforms.g2_arg,d),n.gl.uniform1f(n.uniforms.g3_arg,u),n.render.draw_frame();let o=n.render.get_pixel_data(),a=[];const l=n.canvas_width;let c=n.canvas_width;for(let t=2;t<n.canvas_height-2;t++)for(let e=2;e<l-2;e++){let n=l*t+e;if(0!==o[4*n]){if(o[4*(n-1)]+o[4*(n+1)]+o[4*(n-l)]+o[4*(n+l)]+o[4*(n-1-l)]+o[4*(n+1-l)]+o[4*(n-1+l)]+o[4*(n+1+l)]<=255){0===o[4*(n-2*l-2)]+o[4*(n-2*l-1)]+o[4*(n-2*l)]+o[4*(n-2*l+1)]+o[4*(n-2*l+2)]+o[4*(n+2*l-2)]+o[4*(n+2*l-1)]+o[4*(n+2*l)]+o[4*(n+2*l+1)]+o[4*(n+2*l+2)]+o[4*(n-l-2)]+o[4*(n-2)]+o[4*(n+l-2)]+o[4*(n-l+2)]+o[4*(n+2)]+o[4*(n+l+2)]?a.push([t,e,!0]):a.push([t,e,!1])}}}for(let t=0;t<a.length;t++){if(a[t][0]<n.canvas_width/20||a[t][1]<n.canvas_height/20||a[t][0]>19*n.canvas_width/20||a[t][1]>19*n.canvas_height/20)continue;let e=-1,r=c;a[t][2]||(r=c/20,_>10&&(r*=_/10));for(let n=0;n<a.length;n++){if(n===t)continue;const i=Math.sqrt((a[t][0]-a[n][0])*(a[t][0]-a[n][0])+(a[t][1]-a[n][1])*(a[t][1]-a[n][1]));if(i<r&&i>=2){let _=(a[n][0]-a[t][0])/i*1.414214,c=(a[n][1]-a[t][1])/i*1.414214;_=Math.sign(_)*Math.floor(Math.abs(_)),c=Math.sign(c)*Math.floor(Math.abs(c));let s=0;if(0===_){let e=l*(a[t][0]+_)+(a[t][1]+c);s+=o[4*e],e=l*(a[t][0]+_+1)+(a[t][1]+c),s+=o[4*e],e=l*(a[t][0]+_-1)+(a[t][1]+c),s+=o[4*e]}else if(0===c){let e=l*(a[t][0]+_)+(a[t][1]+c);s+=o[4*e],e=l*(a[t][0]+_)+(a[t][1]+c+1),s+=o[4*e],e=l*(a[t][0]+_)+(a[t][1]+c-1),s+=o[4*e]}else{let e=l*(a[t][0]+_)+(a[t][1]+c);s+=o[4*e],e=l*a[t][0]+(a[t][1]+c),s+=o[4*e],e=l*(a[t][0]+_)+a[t][1],s+=o[4*e]}0===s&&(e=n,r=i)}}if(-1!==e)for(let n=1;n<2*r;n++){const i=n/(2*r),_=l*Math.round((1-i)*a[t][0]+i*a[e][0])+Math.round((1-i)*a[t][1]+i*a[e][1]);o[4*_]=0,o[4*_+1]=255,o[4*_+2]=0}}n.gl.texImage2D(n.gl.TEXTURE_2D,0,n.gl.RGBA,n.canvas_width,n.canvas_height,0,n.gl.RGBA,n.gl.UNSIGNED_BYTE,o),n.gl.useProgram(n.render.shader_programs[1]),n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,null),n.render.draw_frame(o),e>=50&&(F=0,q=0,A=0,y=0,M=0,k=0),0===F&&0===q&&0===A||(n.world_center_x+=F*n.world_width,n.world_center_y+=q*n.world_height,F*=K,q*=K,Math.sqrt(F*F+q*q)<P&&(F=0,q=0),_+=A,Q(),A*=.93,Math.abs(A)<.001&&(A=0),window.requestAnimationFrame(tt))}function et(t){const e=t-E;E=t,0!==e&&(r.gl.uniform1f(r.uniforms.g2_arg,d),r.gl.uniform1f(r.uniforms.g3_arg,u),o.gl.uniform1f(o.uniforms.g2_arg,d),o.gl.uniform1f(o.uniforms.g3_arg,u),r.render.draw_frame(),o.render.draw_frame())}function nt(){t.fullscreen.currently_fullscreen?(a=window.innerWidth/window.innerHeight,a>=1?(t.change_canvas_size(c,Math.floor(c/a)),e.change_canvas_size(c,Math.floor(c/a)),t.world_width=3*Math.pow(2,l)*a,t.world_height=3*Math.pow(2,l),e.world_width=3*Math.pow(2,l)*a,e.world_height=3*Math.pow(2,l)):(t.change_canvas_size(Math.floor(c*a),c),e.change_canvas_size(Math.floor(c*a),c),t.world_width=3*Math.pow(2,l),t.world_height=3*Math.pow(2,l)/a,e.world_width=3*Math.pow(2,l),e.world_height=3*Math.pow(2,l)/a)):(a=1,t.change_canvas_size(c,c),e.change_canvas_size(c,c),t.world_width=3*Math.pow(2,l),t.world_height=3*Math.pow(2,l),e.world_width=3*Math.pow(2,l),e.world_height=3*Math.pow(2,l)),window.requestAnimationFrame(Z)}function rt(){n.fullscreen.currently_fullscreen?(i=window.innerWidth/window.innerHeight,i>=1?(n.change_canvas_size(s,Math.floor(s/i)),n.world_width=3*Math.pow(2,_)*i,n.world_height=3*Math.pow(2,_)):(n.change_canvas_size(Math.floor(s*i),s),n.world_width=3*Math.pow(2,_),n.world_height=3*Math.pow(2,_)/i)):(i=1,n.change_canvas_size(s,s),n.world_width=3*Math.pow(2,_),n.world_height=3*Math.pow(2,_)),window.requestAnimationFrame(tt)}Page.element.querySelector("#download-button").addEventListener("click",(()=>{t.download_frame("wp.png")})),function(){const a=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float black_point;\n\t\t\tuniform float white_point;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tfloat dot_center_radius = world_size * .065;\n\t\t\tfloat dot_border_radius = world_size * .078;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("inverse_g2_g3, wp")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\treturn wp(z, tau);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\t\n\t\t\t\tfloat distance = length(tau - z);\n\t\t\t\t\n\t\t\t\tif (distance < dot_center_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse if (distance < dot_border_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.25, 0.25, 0.25, 1.0);\n\t\t\t\t}\n\t\t\t}\n\t\t`,i=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float black_point;\n\t\t\tuniform float white_point;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tfloat dot_center_radius = world_size * .065;\n\t\t\tfloat dot_border_radius = world_size * .078;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("inverse_g2_g3, wpprime")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\treturn wpprime(z, tau);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\t\n\t\t\t\tfloat distance = length(tau - z);\n\t\t\t\t\n\t\t\t\tif (distance < dot_center_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse if (distance < dot_border_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.25, 0.25, 0.25, 1.0);\n\t\t\t\t}\n\t\t\t}\n\t\t`,l=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tconst float aspect_ratio = 1.0;\n\t\t\t\n\t\t\tconst float world_center_x = 0.0;\n\t\t\tconst float world_center_y = 1.0;\n\t\t\tconst float world_size = 1.0;\n\t\t\t\n\t\t\tconst float black_point = 1.0;\n\t\t\tconst float white_point = 1.0;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tfloat dot_center_radius = world_size * .065;\n\t\t\tfloat dot_border_radius = world_size * .078;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("kleinJ, inverse_g2_g3")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\treturn kleinJ(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\t\n\t\t\t\tfloat distance = length(tau - z);\n\t\t\t\t\n\t\t\t\tif (distance < dot_center_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse if (distance < dot_border_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.25, 0.25, 0.25, 1.0);\n\t\t\t\t}\n\t\t\t}\n\t\t`,_=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tconst float aspect_ratio = 1.0;\n\t\t\t\n\t\t\tconst float world_center_x = 0.0;\n\t\t\tconst float world_center_y = 0.0;\n\t\t\tconst float world_size = 10.0;\n\t\t\t\n\t\t\tconst float black_point = 1.0;\n\t\t\tconst float white_point = 1.0;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("kleinj_from_g2_g3")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\treturn kleinj_from_g2_g3(z.x, z.y) * ONE;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t}\n\t\t`,c={renderer:"gpu",shader:a,canvas_width:500,canvas_height:500,world_width:2,world_height:2,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:nt,mousedown_callback:I,touchstart_callback:I,mousedrag_callback:U,touchmove_callback:U,mouseup_callback:G,touchend_callback:G,wheel_callback:H,pinch_callback:O},w={renderer:"gpu",shader:i,canvas_width:500,canvas_height:500,world_width:2,world_height:2,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:nt,mousedown_callback:I,touchstart_callback:I,mousedrag_callback:U,touchmove_callback:U,mouseup_callback:G,touchend_callback:G,wheel_callback:H,pinch_callback:O},g={renderer:"gpu",shader:"\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float step;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tconst int max_iterations = 200;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfloat f(vec2 z)\n\t\t\t{\n\t\t\t\treturn z.y * z.y   -   z.x * z.x * z.x   -   g2_arg * z.x   -   g3_arg;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tfloat threshhold = world_size * 1000.0;\n\t\t\t\t\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfor (int i = 0; i < max_iterations; i++)\n\t\t\t\t{\n\t\t\t\t\tfloat score = abs(f(z)) / threshhold;\n\t\t\t\t\t\n\t\t\t\t\tif (score < 1.0)\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat adjacent_score = (abs(f(z + vec2(step, 0.0))) + abs(f(z - vec2(step, 0.0))) + abs(f(z + vec2(0.0, step))) + abs(f(z - vec2(0.0, step)))) / threshhold;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (adjacent_score >= 6.0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthreshhold /= 1.25;\n\t\t\t\t}\n\t\t\t}\n\t\t",canvas_width:s,canvas_height:s,world_width:6,world_height:6,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:rt,mousedown_callback:T,touchstart_callback:T,mousedrag_callback:$,touchmove_callback:$,mouseup_callback:N,touchend_callback:N,wheel_callback:J,pinch_callback:X},z={renderer:"gpu",shader:l,canvas_width:500,canvas_height:500},b={renderer:"gpu",shader:_,canvas_width:500,canvas_height:500,world_width:10,world_height:10,world_center_x:0,world_center_y:0,use_draggables:!0,draggables_mousemove_callback:V,draggables_touchmove_callback:V};t=new Wilson(Page.element.querySelector("#wp-canvas"),c),t.render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","black_point","white_point","g2_arg","g3_arg"]),t.gl.uniform1f(t.uniforms.aspect_ratio,1),e=new Wilson(Page.element.querySelector("#wpprime-canvas"),w),e.render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","black_point","white_point","g2_arg","g3_arg"]),e.gl.uniform1f(e.uniforms.aspect_ratio,1),n=new Wilson(Page.element.querySelector("#ec-plot-canvas"),g),n.render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","step","g2_arg","g3_arg"]),n.render.load_new_shader("\n\t\t\tprecision highp float;\n\t\t\tprecision highp sampler2D;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform sampler2D u_texture;\n\t\t\t\n\t\t\tuniform float texture_step;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\t//Dilate the pixels to make a thicker line.\n\t\t\t\tvec2 center = (uv + vec2(1.0, 1.0)) / 2.0;\n\t\t\t\t\n\t\t\t\tfloat state = (4.0 * texture2D(u_texture, center).y +\n\t\t\t\t\n\t\t\t\t\ttexture2D(u_texture, center + vec2(texture_step, 0.0)).y +\n\t\t\t\t\ttexture2D(u_texture, center - vec2(texture_step, 0.0)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(0.0, texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center - vec2(0.0, texture_step)).y +\n\t\t\t\t\t\n\t\t\t\t\ttexture2D(u_texture, center + vec2(texture_step, texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(texture_step, -texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(-texture_step, texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(-texture_step, -texture_step)).y\n\t\t\t\t) / 2.0;\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(state, state, state, 1.0);\n\t\t\t}\n\t\t"),n.render.init_uniforms(["texture_step"]),n.gl.uniform1f(n.uniforms.texture_step,.001),n.render.create_framebuffer_texture_pair(),r=new Wilson(Page.element.querySelector("#kleinj-canvas"),z),r.render.init_uniforms(["g2_arg","g3_arg"]),o=new Wilson(Page.element.querySelector("#g2-canvas"),b),o.render.init_uniforms(["g2_arg","g3_arg"]),o.draggables.add(d,u),Page.set_element_styles(".wilson-applet-canvas-container","margin-top","0",!0),Page.set_element_styles(".wilson-applet-canvas-container","margin-bottom","0",!0),window.requestAnimationFrame(Z),window.requestAnimationFrame(tt),setTimeout((()=>window.requestAnimationFrame(tt)),0),window.requestAnimationFrame(et),f=0,h=0,m=0,p=0,v=0,x=0,y=0,M=0,k=0,F=0,q=0,A=0}(),Page.show(),window.addEventListener("resize",nt),Page.temporary_handlers.resize.push(nt),window.addEventListener("resize",rt),Page.temporary_handlers.resize.push(rt)}();