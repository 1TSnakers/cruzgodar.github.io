!async function(){"use strict";Site.scripts_loaded.glsl||await Site.load_glsl();let t=null,e=null,n=null,r=null,o=null,a=1,l=1,i=-.585,_=1,c=500,s=1e3,d=1,u=1,w=-2,g=0,f=0,h=0,m=0,p=0,v=0,x=0,z=0,b=0,y=0,M=0,k=0,F=0,q=0,A=0,K=0,C=0;const P=.96,S=.0025,D=25e-5,E=.93,R=.01,W=.001;let L=-1,j=-1,B=-1,I=Page.element.querySelector("#resolution-input");I.addEventListener("input",()=>{c=parseInt(I.value||500),t.change_canvas_size(c,c),e.change_canvas_size(c,c),n.change_canvas_size(c,c),window.requestAnimationFrame(ot),window.requestAnimationFrame(at)});let T=Page.element.querySelector("#g2-slider"),U=Page.element.querySelector("#g2-slider-value");T.addEventListener("input",()=>{w=parseInt(T.value||5e3)/1e3-5,U.textContent=Math.round(1e3*w)/1e3,o.draggables.world_coordinates[0]=[w,g],o.draggables.recalculate_locations(),window.requestAnimationFrame(ot),window.requestAnimationFrame(at),window.requestAnimationFrame(lt)}),U.textContent=w;let $=Page.element.querySelector("#g3-slider"),G=Page.element.querySelector("#g3-slider-value");function N(t,e,n){x=0,z=0,b=0,m=0,p=0,v=0}function H(t,e,n){A=0,K=0,C=0,k=0,F=0,q=0}function J(n,r,o,a,l){t.world_center_x-=o,t.world_center_y-=a,e.world_center_x-=o,e.world_center_y-=a,m=-o/t.world_width,p=-a/t.world_height,window.requestAnimationFrame(ot)}function O(t,e,r,o,a){n.world_center_x-=r,n.world_center_y-=o,k=-r/n.world_width,F=-o/n.world_height,window.requestAnimationFrame(at)}function X(t,e,n){Math.sqrt(m*m+p*p)>=S&&(x=m,z=p),Math.abs(v)>=R&&(b=v),window.requestAnimationFrame(ot)}function Y(t,e,n){Math.sqrt(k*k+F*F)>=S&&(A=k,K=F),Math.abs(q)>=R&&(C=q),window.requestAnimationFrame(at)}function Q(t,e,n,r){f=t,h=e,Math.abs(n/100)<.3?i+=n/100:b+=.05*Math.sign(n),et()}function V(t,e,n,r){y=t,M=e,Math.abs(n/100)<.3?_+=n/100:C+=.05*Math.sign(n),nt()}function Z(e,n,r,o){a>=1?(i-=r/t.world_width*10,v=-r/t.world_width*10):(i-=r/t.world_height*10,v=-r/t.world_height*10),f=e,h=n,et()}function tt(t,e,r,o){l>=1?(_-=r/n.world_width*10,q=-r/n.world_width*10):(_-=r/n.world_height*10,q=-r/n.world_height*10),y=t,M=e,nt()}function et(){if(a>=1){let n=t.input.get_zoomed_world_center(f,h,3*Math.pow(2,i)*a,3*Math.pow(2,i));t.world_width=3*Math.pow(2,i)*a,t.world_height=3*Math.pow(2,i),e.world_width=3*Math.pow(2,i)*a,e.world_height=3*Math.pow(2,i),t.world_center_x=n[0],t.world_center_y=n[1],e.world_center_x=n[0],e.world_center_y=n[1]}else{let n=t.input.get_zoomed_world_center(f,h,3*Math.pow(2,i),3*Math.pow(2,i)/a);t.world_width=3*Math.pow(2,i),t.world_height=3*Math.pow(2,i)/a,e.world_width=3*Math.pow(2,i),e.world_height=3*Math.pow(2,i)/a,t.world_center_x=n[0],t.world_center_y=n[1],e.world_center_x=n[0],e.world_center_y=n[1]}window.requestAnimationFrame(ot)}function nt(){if(l>=1){let t=n.input.get_zoomed_world_center(y,M,3*Math.pow(2,_)*l,3*Math.pow(2,_));n.world_width=3*Math.pow(2,_)*l,n.world_height=3*Math.pow(2,_),n.world_center_x=t[0],n.world_center_y=t[1]}else{let t=n.input.get_zoomed_world_center(y,M,3*Math.pow(2,_),3*Math.pow(2,_)/l);n.world_width=3*Math.pow(2,_),n.world_height=3*Math.pow(2,_)/l,n.world_center_x=t[0],n.world_center_y=t[1]}window.requestAnimationFrame(at)}function rt(t,e,n,r){w=e,g=n,T.value=1e3*(w+5),$.value=1e3*(g+5),U.textContent=Math.round(1e3*w)/1e3,G.textContent=Math.round(1e3*g)/1e3,window.requestAnimationFrame(ot),window.requestAnimationFrame(at),window.requestAnimationFrame(lt)}function ot(n){let r=n-L;L=n,0!==r&&(t.gl.uniform1f(t.uniforms.aspect_ratio,a),t.gl.uniform1f(t.uniforms.world_center_x,t.world_center_x),t.gl.uniform1f(t.uniforms.world_center_y,t.world_center_y),t.gl.uniform1f(t.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),t.gl.uniform1f(t.uniforms.black_point,d),t.gl.uniform1f(t.uniforms.white_point,u),t.gl.uniform1f(t.uniforms.g2_arg,w),t.gl.uniform1f(t.uniforms.g3_arg,g),t.render.draw_frame(),e.gl.uniform1f(e.uniforms.aspect_ratio,a),e.gl.uniform1f(e.uniforms.world_center_x,e.world_center_x),e.gl.uniform1f(e.uniforms.world_center_y,e.world_center_y),e.gl.uniform1f(e.uniforms.world_size,Math.min(e.world_height,e.world_width)/2),e.gl.uniform1f(e.uniforms.black_point,d),e.gl.uniform1f(e.uniforms.white_point,u),e.gl.uniform1f(e.uniforms.g2_arg,w),e.gl.uniform1f(e.uniforms.g3_arg,g),e.render.draw_frame(),r>=50&&(x=0,z=0,b=0,m=0,p=0,v=0),0===x&&0===z&&0===b||(t.world_center_x+=x*t.world_width,t.world_center_y+=z*t.world_height,e.world_center_x+=x*e.world_width,e.world_center_y+=z*e.world_height,x*=P,z*=P,Math.sqrt(x*x+z*z)<D&&(x=0,z=0),i+=b,et(),b*=E,Math.abs(b)<W&&(b=0),window.requestAnimationFrame(ot)))}function at(t){let e=t-j;if(j=t,0===e)return;n.gl.useProgram(n.render.shader_programs[0]),n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,n.render.framebuffers[0].framebuffer),n.gl.uniform1f(n.uniforms.aspect_ratio,l),n.gl.uniform1f(n.uniforms.world_center_x,n.world_center_x),n.gl.uniform1f(n.uniforms.world_center_y,n.world_center_y);let r=Math.min(n.world_height,n.world_width);n.gl.uniform1f(n.uniforms.world_size,r/2),n.gl.uniform1f(n.uniforms.step,r/s),n.gl.uniform1f(n.uniforms.g2_arg,w),n.gl.uniform1f(n.uniforms.g3_arg,g),n.render.draw_frame();let o=n.render.get_pixel_data(),a=[];const i=n.canvas_width;let c=n.canvas_width;for(let t=2;t<n.canvas_height-2;t++)for(let e=2;e<i-2;e++){let n=i*t+e;if(0!==o[4*n]){if(o[4*(n-1)]+o[4*(n+1)]+o[4*(n-i)]+o[4*(n+i)]+o[4*(n-1-i)]+o[4*(n+1-i)]+o[4*(n-1+i)]+o[4*(n+1+i)]<=255){0===o[4*(n-2*i-2)]+o[4*(n-2*i-1)]+o[4*(n-2*i)]+o[4*(n-2*i+1)]+o[4*(n-2*i+2)]+o[4*(n+2*i-2)]+o[4*(n+2*i-1)]+o[4*(n+2*i)]+o[4*(n+2*i+1)]+o[4*(n+2*i+2)]+o[4*(n-i-2)]+o[4*(n-2)]+o[4*(n+i-2)]+o[4*(n-i+2)]+o[4*(n+2)]+o[4*(n+i+2)]?a.push([t,e,!0]):a.push([t,e,!1])}}}for(let t=0;t<a.length;t++){if(a[t][0]<n.canvas_width/20||a[t][1]<n.canvas_height/20||a[t][0]>19*n.canvas_width/20||a[t][1]>19*n.canvas_height/20)continue;let e=-1,r=c;a[t][2]||(r=c/20,_>10&&(r*=_/10));for(let n=0;n<a.length;n++){if(n===t)continue;let l=Math.sqrt((a[t][0]-a[n][0])*(a[t][0]-a[n][0])+(a[t][1]-a[n][1])*(a[t][1]-a[n][1]));if(l<r&&l>=2){let _=(a[n][0]-a[t][0])/l*1.414214,c=(a[n][1]-a[t][1])/l*1.414214;_=Math.sign(_)*Math.floor(Math.abs(_)),c=Math.sign(c)*Math.floor(Math.abs(c));let s=0;if(0===_){let e=i*(a[t][0]+_)+(a[t][1]+c);s+=o[4*e],s+=o[4*(e=i*(a[t][0]+_+1)+(a[t][1]+c))],s+=o[4*(e=i*(a[t][0]+_-1)+(a[t][1]+c))]}else if(0===c){let e=i*(a[t][0]+_)+(a[t][1]+c);s+=o[4*e],s+=o[4*(e=i*(a[t][0]+_)+(a[t][1]+c+1))],s+=o[4*(e=i*(a[t][0]+_)+(a[t][1]+c-1))]}else{let e=i*(a[t][0]+_)+(a[t][1]+c);s+=o[4*e],s+=o[4*(e=i*a[t][0]+(a[t][1]+c))],s+=o[4*(e=i*(a[t][0]+_)+a[t][1])]}0===s&&(e=n,r=l)}}if(-1!==e)for(let n=1;n<2*r;n++){let l=n/(2*r),_=i*Math.round((1-l)*a[t][0]+l*a[e][0])+Math.round((1-l)*a[t][1]+l*a[e][1]);o[4*_]=0,o[4*_+1]=255,o[4*_+2]=0}}n.gl.texImage2D(n.gl.TEXTURE_2D,0,n.gl.RGBA,n.canvas_width,n.canvas_height,0,n.gl.RGBA,n.gl.UNSIGNED_BYTE,o),n.gl.useProgram(n.render.shader_programs[1]),n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,null),n.render.draw_frame(o),e>=50&&(A=0,K=0,C=0,k=0,F=0,q=0),0===A&&0===K&&0===C||(n.world_center_x+=A*n.world_width,n.world_center_y+=K*n.world_height,A*=P,K*=P,Math.sqrt(A*A+K*K)<D&&(A=0,K=0),_+=C,nt(),C*=E,Math.abs(C)<W&&(C=0),window.requestAnimationFrame(at))}function lt(t){let e=t-B;B=t,0!==e&&(r.gl.uniform1f(r.uniforms.g2_arg,w),r.gl.uniform1f(r.uniforms.g3_arg,g),o.gl.uniform1f(o.uniforms.g2_arg,w),o.gl.uniform1f(o.uniforms.g3_arg,g),r.render.draw_frame(),o.render.draw_frame())}function it(){t.fullscreen.currently_fullscreen?(a=window.innerWidth/window.innerHeight)>=1?(t.change_canvas_size(c,Math.floor(c/a)),e.change_canvas_size(c,Math.floor(c/a)),t.world_width=3*Math.pow(2,i)*a,t.world_height=3*Math.pow(2,i),e.world_width=3*Math.pow(2,i)*a,e.world_height=3*Math.pow(2,i)):(t.change_canvas_size(Math.floor(c*a),c),e.change_canvas_size(Math.floor(c*a),c),t.world_width=3*Math.pow(2,i),t.world_height=3*Math.pow(2,i)/a,e.world_width=3*Math.pow(2,i),e.world_height=3*Math.pow(2,i)/a):(a=1,t.change_canvas_size(c,c),e.change_canvas_size(c,c),t.world_width=3*Math.pow(2,i),t.world_height=3*Math.pow(2,i),e.world_width=3*Math.pow(2,i),e.world_height=3*Math.pow(2,i)),window.requestAnimationFrame(ot)}function _t(){n.fullscreen.currently_fullscreen?(l=window.innerWidth/window.innerHeight)>=1?(n.change_canvas_size(s,Math.floor(s/l)),n.world_width=3*Math.pow(2,_)*l,n.world_height=3*Math.pow(2,_)):(n.change_canvas_size(Math.floor(s*l),s),n.world_width=3*Math.pow(2,_),n.world_height=3*Math.pow(2,_)/l):(l=1,n.change_canvas_size(s,s),n.world_width=3*Math.pow(2,_),n.world_height=3*Math.pow(2,_)),window.requestAnimationFrame(at)}$.addEventListener("input",()=>{g=parseInt($.value||5e3)/1e3-5,G.textContent=Math.round(1e3*g)/1e3,o.draggables.world_coordinates[0]=[w,g],o.draggables.recalculate_locations(),window.requestAnimationFrame(ot),window.requestAnimationFrame(at),window.requestAnimationFrame(lt)}),G.textContent=g,Page.element.querySelector("#download-button").addEventListener("click",()=>{t.download_frame("wp.png")}),function(){let a=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float black_point;\n\t\t\tuniform float white_point;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tfloat dot_center_radius = world_size * .065;\n\t\t\tfloat dot_border_radius = world_size * .078;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("inverse_g2_g3, wp")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\treturn wp(z, tau);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\t\n\t\t\t\tfloat distance = length(tau - z);\n\t\t\t\t\n\t\t\t\tif (distance < dot_center_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse if (distance < dot_border_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.25, 0.25, 0.25, 1.0);\n\t\t\t\t}\n\t\t\t}\n\t\t`,l=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float black_point;\n\t\t\tuniform float white_point;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tfloat dot_center_radius = world_size * .065;\n\t\t\tfloat dot_border_radius = world_size * .078;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("inverse_g2_g3, wpprime")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\treturn wpprime(z, tau);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\t\n\t\t\t\tfloat distance = length(tau - z);\n\t\t\t\t\n\t\t\t\tif (distance < dot_center_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse if (distance < dot_border_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.25, 0.25, 0.25, 1.0);\n\t\t\t\t}\n\t\t\t}\n\t\t`,i=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tconst float aspect_ratio = 1.0;\n\t\t\t\n\t\t\tconst float world_center_x = 0.0;\n\t\t\tconst float world_center_y = 1.0;\n\t\t\tconst float world_size = 1.0;\n\t\t\t\n\t\t\tconst float black_point = 1.0;\n\t\t\tconst float white_point = 1.0;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tfloat dot_center_radius = world_size * .065;\n\t\t\tfloat dot_border_radius = world_size * .078;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("kleinJ, inverse_g2_g3")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\treturn kleinJ(z);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 tau = inverse_g2_g3(g2_arg, g3_arg);\n\t\t\t\t\n\t\t\t\tfloat distance = length(tau - z);\n\t\t\t\t\n\t\t\t\tif (distance < dot_center_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse if (distance < dot_border_radius)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0.25, 0.25, 0.25, 1.0);\n\t\t\t\t}\n\t\t\t}\n\t\t`,_=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tconst float aspect_ratio = 1.0;\n\t\t\t\n\t\t\tconst float world_center_x = 0.0;\n\t\t\tconst float world_center_y = 0.0;\n\t\t\tconst float world_size = 10.0;\n\t\t\t\n\t\t\tconst float black_point = 1.0;\n\t\t\tconst float white_point = 1.0;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${Site.get_glsl_bundle("kleinj_from_g2_g3")}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\treturn kleinj_from_g2_g3(z.x, z.y) * ONE;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = clamp(1.0 / (1.0 + .01 * (modulus / white_point / white_point)), 0.0, 1.0);\n\t\t\t\tfloat v = clamp(1.0 / (1.0 + .01 / (modulus * black_point * black_point)), 0.0, 1.0);\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t}\n\t\t`,c={renderer:"gpu",shader:a,canvas_width:500,canvas_height:500,world_width:2,world_height:2,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:it,mousedown_callback:N,touchstart_callback:N,mousedrag_callback:J,touchmove_callback:J,mouseup_callback:X,touchend_callback:X,wheel_callback:Q,pinch_callback:Z},d={renderer:"gpu",shader:l,canvas_width:500,canvas_height:500,world_width:2,world_height:2,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:it,mousedown_callback:N,touchstart_callback:N,mousedrag_callback:J,touchmove_callback:J,mouseup_callback:X,touchend_callback:X,wheel_callback:Q,pinch_callback:Z},u={renderer:"gpu",shader:"\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float step;\n\t\t\t\n\t\t\tuniform float g2_arg;\n\t\t\tuniform float g3_arg;\n\t\t\t\n\t\t\tconst int max_iterations = 200;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfloat f(vec2 z)\n\t\t\t{\n\t\t\t\treturn z.y * z.y   -   z.x * z.x * z.x   -   g2_arg * z.x   -   g3_arg;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tfloat threshhold = world_size * 1000.0;\n\t\t\t\t\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfor (int i = 0; i < max_iterations; i++)\n\t\t\t\t{\n\t\t\t\t\tfloat score = abs(f(z)) / threshhold;\n\t\t\t\t\t\n\t\t\t\t\tif (score < 1.0)\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat adjacent_score = (abs(f(z + vec2(step, 0.0))) + abs(f(z - vec2(step, 0.0))) + abs(f(z + vec2(0.0, step))) + abs(f(z - vec2(0.0, step)))) / threshhold;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (adjacent_score >= 6.0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthreshhold /= 1.25;\n\t\t\t\t}\n\t\t\t}\n\t\t",canvas_width:s,canvas_height:s,world_width:6,world_height:6,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:_t,mousedown_callback:H,touchstart_callback:H,mousedrag_callback:O,touchmove_callback:O,mouseup_callback:Y,touchend_callback:Y,wheel_callback:V,pinch_callback:tt},f={renderer:"gpu",shader:i,canvas_width:500,canvas_height:500},h={renderer:"gpu",shader:_,canvas_width:500,canvas_height:500,world_width:10,world_height:10,world_center_x:0,world_center_y:0,use_draggables:!0,draggables_mousemove_callback:rt,draggables_touchmove_callback:rt};(t=new Wilson(Page.element.querySelector("#wp-canvas"),c)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","black_point","white_point","g2_arg","g3_arg"]),t.gl.uniform1f(t.uniforms.aspect_ratio,1),(e=new Wilson(Page.element.querySelector("#wpprime-canvas"),d)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","black_point","white_point","g2_arg","g3_arg"]),e.gl.uniform1f(e.uniforms.aspect_ratio,1),(n=new Wilson(Page.element.querySelector("#ec-plot-canvas"),u)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","step","g2_arg","g3_arg"]),n.render.load_new_shader("\n\t\t\tprecision highp float;\n\t\t\tprecision highp sampler2D;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform sampler2D u_texture;\n\t\t\t\n\t\t\tuniform float texture_step;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\t//Dilate the pixels to make a thicker line.\n\t\t\t\tvec2 center = (uv + vec2(1.0, 1.0)) / 2.0;\n\t\t\t\t\n\t\t\t\tfloat state = (4.0 * texture2D(u_texture, center).y +\n\t\t\t\t\n\t\t\t\t\ttexture2D(u_texture, center + vec2(texture_step, 0.0)).y +\n\t\t\t\t\ttexture2D(u_texture, center - vec2(texture_step, 0.0)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(0.0, texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center - vec2(0.0, texture_step)).y +\n\t\t\t\t\t\n\t\t\t\t\ttexture2D(u_texture, center + vec2(texture_step, texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(texture_step, -texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(-texture_step, texture_step)).y +\n\t\t\t\t\ttexture2D(u_texture, center + vec2(-texture_step, -texture_step)).y\n\t\t\t\t) / 2.0;\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(state, state, state, 1.0);\n\t\t\t}\n\t\t"),n.render.init_uniforms(["texture_step"]),n.gl.uniform1f(n.uniforms.texture_step,1/s),n.render.create_framebuffer_texture_pair(),(r=new Wilson(Page.element.querySelector("#kleinj-canvas"),f)).render.init_uniforms(["g2_arg","g3_arg"]),(o=new Wilson(Page.element.querySelector("#g2-canvas"),h)).render.init_uniforms(["g2_arg","g3_arg"]),o.draggables.add(w,g),Page.set_element_styles(".wilson-applet-canvas-container","margin-top","0",!0),Page.set_element_styles(".wilson-applet-canvas-container","margin-bottom","0",!0),window.requestAnimationFrame(ot),window.requestAnimationFrame(at),setTimeout(()=>window.requestAnimationFrame(at),0),window.requestAnimationFrame(lt),m=0,p=0,v=0,x=0,z=0,b=0,k=0,F=0,q=0,A=0,K=0,C=0}(),Page.show(),window.addEventListener("resize",it),Page.temporary_handlers.resize.push(it),window.addEventListener("resize",_t),Page.temporary_handlers.resize.push(_t)}();