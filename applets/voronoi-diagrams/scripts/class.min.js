import{Applet}from"/scripts/src/applets.min.js";import{Wilson}from"/scripts/wilson.min.js";class VoronoiDiagram extends Applet{lastTimestamp=-1;numPoints=20;metric=2;resolution=1e3;pointRadius;points;constructor({canvas}){super(canvas);var t={renderer:"cpu",canvasWidth:this.resolution,canvasHeight:this.resolution,useFullscreen:!0,useFullscreenButton:!0,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png"};this.wilson=new Wilson(this.canvas,t)}run({resolution=500,numPoints=20,metric=2}){this.resolution=resolution,this.numPoints=numPoints,this.metric=metric,this.wilson.changeCanvasSize(this.resolution,this.resolution),this.pointRadius=.01*this.resolution,this.generatePoints(),window.requestAnimationFrame(this.drawFrame.bind(this))}generatePoints(){this.points=new Array(this.numPoints);for(let n=0;n<this.numPoints;n++)this.points[n]=[.8*(Math.random()-.5)*this.wilson.worldWidth+this.wilson.worldCenterX,.8*(Math.random()-.5)*this.wilson.worldHeight+this.wilson.worldCenterY];var i,s=new Array(this.numPoints),t=.1/this.numPoints;for(let o=0;o<this.numPoints;o++){s[o]=[0,0];for(let t=0;t<this.numPoints;t++)t!==o&&(i=(this.points[t][0]-this.points[o][0])**2+(this.points[t][1]-this.points[o][1])**2,s[o][0]+=(this.points[o][0]-this.points[t][0])/i,s[o][1]+=(this.points[o][1]-this.points[t][1])/i)}for(let e=0;e<this.numPoints;e++)this.points[e][0]+=t*s[e][0],this.points[e][1]+=t*s[e][1],this.points[e][0]=Math.min(Math.max(this.points[e][0],this.wilson.worldCenterX-this.wilson.worldWidth/2),this.wilson.worldCenterX+this.wilson.worldWidth/2),this.points[e][1]=Math.min(Math.max(this.points[e][1],this.wilson.worldCenterY-this.wilson.worldHeight/2),this.wilson.worldCenterY+this.wilson.worldHeight/2)}drawFrame(timestamp){var t=timestamp-this.lastTimestamp;this.lastTimestamp=timestamp,0==t||(this.drawPoints(),this.animationPaused)||window.requestAnimationFrame(this.drawFrame.bind(this))}drawPoints(){this.wilson.ctx.fillStyle="rgb(0, 0, 0)",this.wilson.ctx.fillRect(0,0,this.resolution,this.resolution),this.wilson.ctx.fillStyle="rgb(255, 255, 255)";for(let i=0;i<this.numPoints;i++){var t=this.wilson.utils.interpolate.worldToCanvas(...this.points[i]);this.wilson.ctx.beginPath(),this.wilson.ctx.moveTo(...t),this.wilson.ctx.arc(...t,this.pointRadius,0,2*Math.PI,!1),this.wilson.ctx.fill()}}}export{VoronoiDiagram};