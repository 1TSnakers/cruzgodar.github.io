"use strict";let canvasWidth=null,canvasHeight=null,maxDepth=null,maxPixelBrightness=null,boxSize=null,coefficients=[],brightness=[],x=0,y=0;function drawQuasiFuchsianGroup(){brightness=new Array(canvasWidth*canvasHeight);for(let a=0;a<brightness.length;a++)brightness[a]=0;for(let a=0;a<4;a++)searchStep(0,0,a,-1,-1,1);let e=0;for(let a=0;a<brightness.length;a++)e=Math.max(e,brightness[a]);for(let a=0;a<brightness.length;a++)brightness[a]=Math.pow(brightness[a]/e,.15);postMessage([brightness])}function searchStep(i,s,n,a,e,h){if(h!==maxDepth)for(let t=3;t<6;t++){x=i,y=s;var c=(n+t)%4;applyTransformation(c);let a=0,e=0;if(e=canvasWidth>=canvasHeight?(a=Math.floor((-y+boxSize/2)/boxSize*canvasHeight),Math.floor((x/(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasWidth)):(a=Math.floor((-y*(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasHeight),Math.floor((x+boxSize/2)/boxSize*canvasWidth)),0<=a&&a<canvasHeight&&0<=e&&e<canvasWidth){if(brightness[canvasWidth*a+e]===maxPixelBrightness)continue;brightness[canvasWidth*a+e]++}searchStep(x,y,c,a,e,h+1)}}function applyTransformation(a){var e=coefficients[a][0][0],t=coefficients[a][0][1],i=coefficients[a][1][0],s=coefficients[a][1][1],n=coefficients[a][2][0],h=coefficients[a][2][1],c=coefficients[a][3][0],a=coefficients[a][3][1],i=e*x-t*y+i,e=e*y+t*x+s,t=n*x-h*y+c,s=n*y+h*x+a,c=i*t+e*s,n=e*t-i*s,h=t*t+s*s;x=c/h,y=n/h}onmessage=a=>{canvasWidth=a.data[0],canvasHeight=a.data[1],maxDepth=a.data[2],maxPixelBrightness=a.data[3],boxSize=a.data[4],coefficients=a.data[5],drawQuasiFuchsianGroup()};