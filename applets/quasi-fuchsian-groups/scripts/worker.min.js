"use strict";onmessage=async function(a){canvasWidth=a.data[0],canvasHeight=a.data[1],maxDepth=a.data[2],maxPixelBrightness=a.data[3],boxSize=a.data[4],coefficients=a.data[5],await drawQuasiFuchsianGroup()};let canvasWidth=null,canvasHeight=null,maxDepth=null,maxPixelBrightness=null,boxSize=null,coefficients=[],brightness=[],x=0,y=0;function drawQuasiFuchsianGroup(){return new Promise(async function(a,e){brightness=new Array(canvasWidth*canvasHeight);for(let a=0;a<brightness.length;a++)brightness[a]=0;for(let a=0;a<4;a++)searchStep(0,0,a,-1,-1,1);let t=0;for(let a=0;a<brightness.length;a++)t=Math.max(t,brightness[a]);for(let a=0;a<brightness.length;a++)brightness[a]=Math.pow(brightness[a]/t,.15);postMessage([brightness]),a()})}function searchStep(i,s,n,a,e,c){if(c!==maxDepth)for(let t=3;t<6;t++){x=i,y=s;var h=(n+t)%4;applyTransformation(h);let a=0,e=0;if(e=canvasWidth>=canvasHeight?(a=Math.floor((-y+boxSize/2)/boxSize*canvasHeight),Math.floor((x/(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasWidth)):(a=Math.floor((-y*(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasHeight),Math.floor((x+boxSize/2)/boxSize*canvasWidth)),0<=a&&a<canvasHeight&&0<=e&&e<canvasWidth){if(brightness[canvasWidth*a+e]===maxPixelBrightness)continue;brightness[canvasWidth*a+e]++}searchStep(x,y,h,a,e,c+1)}}function applyTransformation(a){var e=coefficients[a][0][0],t=coefficients[a][0][1],i=coefficients[a][1][0],s=coefficients[a][1][1],n=coefficients[a][2][0],c=coefficients[a][2][1],h=coefficients[a][3][0],a=coefficients[a][3][1],i=e*x-t*y+i,e=e*y+t*x+s,t=n*x-c*y+h,s=n*y+c*x+a,h=i*t+e*s,n=e*t-i*s,c=t*t+s*s;x=h/c,y=n/c}