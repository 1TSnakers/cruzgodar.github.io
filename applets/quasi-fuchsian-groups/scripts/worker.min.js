"use strict";onmessage=async function(i){canvasWidth=i.data[0],canvasHeight=i.data[1],maxDepth=i.data[2],maxPixelBrightness=i.data[3],boxSize=i.data[4],coefficients=i.data[5],await drawQuasiFuchsianGroup()};let canvasWidth=null,canvasHeight=null,maxDepth=null,maxPixelBrightness=null,boxSize=null,coefficients=[],brightness=[],x=0,y=0;function drawQuasiFuchsianGroup(){return new Promise(async function(i,e){brightness=Array(canvasWidth*canvasHeight);for(let t=0;t<brightness.length;t++)brightness[t]=0;for(let a=0;a<4;a++)searchStep(0,0,a,-1,-1,1);let n=0;for(let s=0;s<brightness.length;s++)n=Math.max(n,brightness[s]);for(let c=0;c<brightness.length;c++)brightness[c]=Math.pow(brightness[c]/n,.15);postMessage([brightness]),i()})}function searchStep(i,e,t,a,n,s){if(s!==maxDepth)for(let c=3;c<6;c++){x=i,y=e;let h=(t+c)%4;applyTransformation(h);let o=0,f=0;if(canvasWidth>=canvasHeight?(o=Math.floor((-y+boxSize/2)/boxSize*canvasHeight),f=Math.floor((x/(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasWidth)):(o=Math.floor((-y*(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasHeight),f=Math.floor((x+boxSize/2)/boxSize*canvasWidth)),o>=0&&o<canvasHeight&&f>=0&&f<canvasWidth){if(brightness[canvasWidth*o+f]===maxPixelBrightness)continue;brightness[canvasWidth*o+f]++}searchStep(x,y,h,o,f,s+1)}}function applyTransformation(i){let e=coefficients[i][0][0],t=coefficients[i][0][1],a=coefficients[i][1][0],n=coefficients[i][1][1],s=coefficients[i][2][0],c=coefficients[i][2][1],h=coefficients[i][3][0],o=coefficients[i][3][1],f=e*x-t*y+a,r=e*y+t*x+n,l=s*x-c*y+h,g=s*y+c*x+o,b=l*l+g*g;x=(f*l+r*g)/b,y=(r*l-f*g)/b}