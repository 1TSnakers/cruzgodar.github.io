"use strict";let canvasWidth=null,canvasHeight=null,maxDepth=null,maxPixelBrightness=null,boxSize=null,coefficients=[],brightness=[],x=0,y=0;function drawQuasiFuchsianGroup(){brightness=new Array(canvasWidth*canvasHeight);for(let i=0;i<brightness.length;i++)brightness[i]=0;for(let i=0;i<4;i++)searchStep(0,0,i,-1,-1,1);let maxBrightness=0;for(let i=0;i<brightness.length;i++)maxBrightness=Math.max(maxBrightness,brightness[i]);for(let i=0;i<brightness.length;i++)brightness[i]=Math.pow(brightness[i]/maxBrightness,.15);postMessage([brightness])}function searchStep(startX,startY,lastTransformationIndex,lastRow,lastCol,depth){if(depth!==maxDepth)for(let i=3;i<6;i++){x=startX,y=startY;var transformationIndex=(lastTransformationIndex+i)%4;applyTransformation(transformationIndex);let row=0,col=0;if(col=canvasWidth>=canvasHeight?(row=Math.floor((-y+boxSize/2)/boxSize*canvasHeight),Math.floor((x/(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasWidth)):(row=Math.floor((-y*(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasHeight),Math.floor((x+boxSize/2)/boxSize*canvasWidth)),0<=row&&row<canvasHeight&&0<=col&&col<canvasWidth){if(brightness[canvasWidth*row+col]===maxPixelBrightness)continue;brightness[canvasWidth*row+col]++}searchStep(x,y,transformationIndex,row,col,depth+1)}}function applyTransformation(index){var ax=coefficients[index][0][0],ay=coefficients[index][0][1],bx=coefficients[index][1][0],by=coefficients[index][1][1],cx=coefficients[index][2][0],cy=coefficients[index][2][1],dx=coefficients[index][3][0],index=coefficients[index][3][1],bx=ax*x-ay*y+bx,ax=ax*y+ay*x+by,ay=cx*x-cy*y+dx,by=cx*y+cy*x+index,dx=bx*ay+ax*by,cx=ax*ay-bx*by,cy=ay*ay+by*by;x=dx/cy,y=cx/cy}onmessage=e=>{canvasWidth=e.data[0],canvasHeight=e.data[1],maxDepth=e.data[2],maxPixelBrightness=e.data[3],boxSize=e.data[4],coefficients=e.data[5],drawQuasiFuchsianGroup()};