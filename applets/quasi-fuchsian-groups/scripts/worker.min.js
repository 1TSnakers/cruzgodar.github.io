"use strict";onmessage=async function(s){canvas_width=s.data[0],canvas_height=s.data[1],max_depth=s.data[2],max_pixel_brightness=s.data[3],box_size=s.data[4],coefficients=s.data[5],await draw_quasi_fuchsian_group()};let canvas_width=null,canvas_height=null,max_depth=null,max_pixel_brightness=null,box_size=null,coefficients=[],brightness=[],x=0,y=0;function draw_quasi_fuchsian_group(){return new Promise(async function(s,a){brightness=new Array(canvas_width*canvas_height);for(let s=0;s<canvas_height;s++)for(let a=0;a<canvas_width;a++)brightness[canvas_width*s+a]=0;for(let s=0;s<4;s++)search_step(0,0,s,-1,-1,1);let t=brightness.flat().sort(function(s,a){return s-a}),i=t[Math.round(.999*t.length)-1];for(let s=0;s<canvas_height;s++)for(let a=0;a<canvas_width;a++)brightness[canvas_width*s+a]=Math.min(Math.sqrt(brightness[canvas_width*s+a]/i),1);for(let s=1;s<canvas_height-1;s++)for(let a=1;a<canvas_width-1;a++)0!==brightness[canvas_width*s+a]&&0===brightness[canvas_width*(s-1)+a]&&0===brightness[canvas_width*(s-1)+(a+1)]&&0===brightness[canvas_width*s+(a+1)]&&0===brightness[canvas_width*(s+1)+(a+1)]&&0===brightness[canvas_width*(s+1)+a]&&0===brightness[canvas_width*(s+1)+(a-1)]&&0===brightness[canvas_width*s+(a-1)]&&0===brightness[canvas_width*(s-1)+(a-1)]&&(brightness[canvas_width*s+a]=0);postMessage([brightness]),s()})}function search_step(s,a,t,i,n,e){if(e!==max_depth)for(let i=3;i<6;i++){x=s,y=a;let n=(t+i)%4;apply_transformation(n);let h=0,c=0;if(canvas_width>=canvas_height?(h=Math.floor((box_size/2-y)/box_size*canvas_height),c=Math.floor((x/(canvas_width/canvas_height)+box_size/2)/box_size*canvas_width)):(h=Math.floor((canvas_width/canvas_height*-y+box_size/2)/box_size*canvas_height),c=Math.floor((x+box_size/2)/box_size*canvas_width)),h>=0&&h<canvas_height&&c>=0&&c<canvas_width){if(brightness[canvas_width*h+c]===max_pixel_brightness)continue;brightness[canvas_width*h+c]++}search_step(x,y,n,h,c,e+1)}}function apply_transformation(s){let a=coefficients[s][0][0],t=coefficients[s][0][1],i=coefficients[s][1][0],n=coefficients[s][1][1],e=coefficients[s][2][0],h=coefficients[s][2][1],c=coefficients[s][3][0],_=coefficients[s][3][1],r=a*x-t*y+i,o=a*y+t*x+n,f=e*x-h*y+c,d=e*y+h*x+_,g=f*f+d*d;x=(r*f+o*d)/g,y=(o*f-r*d)/g}