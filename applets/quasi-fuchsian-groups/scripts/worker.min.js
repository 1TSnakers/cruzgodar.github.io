"use strict";let canvasWidth=null,canvasHeight=null,maxDepth=null,maxPixelBrightness=null,boxSize=null,coefficients=[],brightness=[],x=0,y=0;function drawQuasiFuchsianGroup(){brightness=new Array(canvasWidth*canvasHeight);for(let t=0;t<brightness.length;t++)brightness[t]=0;for(let a=0;a<4;a++)searchStep(0,0,a,-1,-1,1);let e=0;for(let i=0;i<brightness.length;i++)e=Math.max(e,brightness[i]);for(let s=0;s<brightness.length;s++)brightness[s]=Math.pow(brightness[s]/e,.15);postMessage([brightness])}function searchStep(startX,startY,lastTransformationIndex,lastRow,lastCol,depth){if(depth!==maxDepth)for(let a=3;a<6;a++){x=startX,y=startY;var i=(lastTransformationIndex+a)%4;applyTransformation(i);let e=0,t=0;if(t=canvasWidth>=canvasHeight?(e=Math.floor((-y+boxSize/2)/boxSize*canvasHeight),Math.floor((x/(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasWidth)):(e=Math.floor((-y*(canvasWidth/canvasHeight)+boxSize/2)/boxSize*canvasHeight),Math.floor((x+boxSize/2)/boxSize*canvasWidth)),0<=e&&e<canvasHeight&&0<=t&&t<canvasWidth){if(brightness[canvasWidth*e+t]===maxPixelBrightness)continue;brightness[canvasWidth*e+t]++}searchStep(x,y,i,e,t,depth+1)}}function applyTransformation(index){var e=coefficients[index][0][0],t=coefficients[index][0][1],a=coefficients[index][1][0],i=coefficients[index][1][1],s=coefficients[index][2][0],n=coefficients[index][2][1],h=coefficients[index][3][0],o=coefficients[index][3][1],a=e*x-t*y+a,e=e*y+t*x+i,t=s*x-n*y+h,i=s*y+n*x+o,h=a*t+e*i,s=e*t-a*i,n=t*t+i*i;x=h/n,y=s/n}onmessage=e=>{canvasWidth=e.data[0],canvasHeight=e.data[1],maxDepth=e.data[2],maxPixelBrightness=e.data[3],boxSize=e.data[4],coefficients=e.data[5],drawQuasiFuchsianGroup()};