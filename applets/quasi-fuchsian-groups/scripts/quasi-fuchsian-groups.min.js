!function(){"use strict";let e=300,t=document.querySelector("#quasi-fuchsian-groups-plot").getContext("2d",{alpha:!1}),o=[],r=[],n=null,u=[[2,0],[2,0]],l=[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0]],[],[]],a=[],c=[],s=-1,i=document.querySelector("#coefficient-selector").offsetWidth,m=document.querySelector("#coefficient-selector").offsetHeight,d=17.5,f=!1,p=!0,h=20,g=10,q=0,y=0;document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),r=[],o=[];for(let t=0;t<e;t++){r[t]=[],o[t]=[];for(let n=0;n<e;n++)q=t/e*4-2,y=2-n/e*4,r[t][n]=(Math.atan2(-y,-q)+Math.PI)/(2*Math.PI),o[t][n]=0}function w(){t.fillStyle="rgb(0, 0, 0)",t.fillRect(0,0,e,e);let n=new Complex(u[0]),a=new Complex(u[1]),c=new Complex([0,0]);c=n.mul(a);let s=new Complex([0,0]);s=n.mul(n).add(a.mul(a));let i=new Complex([0,0]);i=c.mul(c).sub(s.mul(4)).arg()>0?c.sub(c.mul(c).sub(s.mul(4)).sqrt()).div(2):c.add(c.mul(c).sub(s.mul(4)).sqrt()).div(2);let m=new Complex([0,0]);m=i.sub(2).mul(a).div(a.mul(i).sub(n.mul(2)).add(i.mul(new Complex([0,2]))));let d=new Complex([0,0]);d=n.div(2),l[0][0][0]=d.re,l[0][0][1]=d.im,l[0][3][0]=d.re,l[0][3][1]=d.im,d=n.mul(i).sub(a.mul(2)).add(new Complex([0,4])).div(i.mul(2).add(4).mul(m)),l[0][1][0]=d.re,l[0][1][1]=d.im,d=n.mul(i).sub(a.mul(2)).sub(new Complex([0,4])).mul(m).div(i.mul(2).sub(4)),l[0][2][0]=d.re,l[0][2][1]=d.im,d=a.sub(new Complex([0,2])).div(2),l[1][0][0]=d.re,l[1][0][1]=d.im,d=a.div(2),l[1][1][0]=d.re,l[1][1][1]=d.im,l[1][2][0]=d.re,l[1][2][1]=d.im,d=a.add(new Complex([0,2])).div(2),l[1][3][0]=d.re,l[1][3][1]=d.im;for(let e=0;e<2;e++){let t=l[e][0][0],o=l[e][0][1],r=l[e][1][0],n=l[e][1][1],u=l[e][2][0],a=l[e][2][1],c=l[e][3][0],s=l[e][3][1];l[e+2]=[[c,s],[-r,-n],[-u,-a],[t,o]]}for(let e=0;e<4;e++)b(0,0,e,-1,-1,1);let h=o.flat().sort((function(e,t){return e-t})),g=h[h.length-1],q=t.getImageData(0,0,e,e),y=q.data;for(let t=0;t<e;t++)for(let n=0;n<e;n++){let u=4*t*e+4*n,l=C(r[t][n],1,Math.pow(o[t][n]/g,.25));y[u]=l[0],y[u+1]=l[1],y[u+2]=l[2],y[u+3]=255}t.putImageData(q,0,0),f?(f=!1,window.requestAnimationFrame(w)):p=!0}function b(t,r,n,u,l,a){if(a!==h)for(let u=3;u<6;u++){q=t,y=r;let l=(n+u)%4;v(l);let c=Math.floor((2-y)/4*e),s=Math.floor((q+2)/4*e);if(c>=0&&c<e&&s>=0&&s<e){if(o[c][s]===g)continue;a>10&&o[c][s]++}b(q,y,l,c,s,a+1)}}function v(e){let t=l[e][0][0],o=l[e][0][1],r=l[e][1][0],n=l[e][1][1],u=l[e][2][0],a=l[e][2][1],c=l[e][3][0],s=l[e][3][1],i=t*q-o*y+r,m=t*y+o*q+n,d=u*q-a*y+c,f=u*y+a*q+s,p=d*d+f*f;q=(i*d+m*f)/p,y=(m*d-i*f)/p}function S(){for(let e=0;e<2;e++)a.push(document.querySelector("#coefficient-marker-"+e));for(let t=0;t<2;t++){c.push([Math.floor(e/2),Math.floor(e/2)]);let o=c[t][0]/e*m,r=c[t][1]/e*i;a[t].style.transform=`translate3d(${r-d}px, ${o-d}px, 0)`}window.addEventListener("resize",k),temporary_handlers.resize.push(k),setTimeout(k,1e3),w()}function x(t){s=-1;for(let n=0;n<2;n++)if(t.target.id==="coefficient-marker-"+n){t.preventDefault(),s=n,e=300,h=20,g=10,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),r=[],o=[];for(let t=0;t<e;t++){r[t]=[],o[t]=[];for(let n=0;n<e;n++)q=t/e*4-2,y=2-n/e*4,r[t][n]=(Math.atan2(-y,-q)+Math.PI)/(2*Math.PI),o[t][n]=0}f=!0,p&&(p=!1,window.requestAnimationFrame(w))}}function M(t){if(-1!==s){e=600,h=100,g=50,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),r=[],o=[];for(let t=0;t<e;t++){r[t]=[],o[t]=[];for(let n=0;n<e;n++)q=t/e*4-2,y=2-n/e*4,r[t][n]=(Math.atan2(-y,-q)+Math.PI)/(2*Math.PI),o[t][n]=0}f=!0,p&&(p=!1,window.requestAnimationFrame(w))}s=-1}function _(t){if(-1===s)return;let r=null,n=null,l=document.querySelector("#coefficient-selector").getBoundingClientRect();"touchmove"===t.type?(r=t.touches[0].clientY-l.top,n=t.touches[0].clientX-l.left):(r=t.clientY-l.top,n=t.clientX-l.left),r<d&&(r=d),r>m-d&&(r=m-d),n<d&&(n=d),n>i-d&&(n=i-d),a[s].style.transform=`translate3d(${n-d}px, ${r-d}px, 0)`,u[s][0]=n/i-.5+2,u[s][1]=1-r/m-.5;for(let t=0;t<e;t++)for(let r=0;r<e;r++)o[t][r]=0;f=!0,p&&(p=!1,window.requestAnimationFrame(w))}function k(){i=document.querySelector("#coefficient-selector").offsetWidth,m=document.querySelector("#coefficient-selector").offsetHeight;document.querySelector("#coefficient-selector").getBoundingClientRect();for(let e=0;e<2;e++){let t=Math.floor((1-(u[e][1]+.5))*m),o=Math.floor((u[e][0]-2+.5)*i);a[e].style.transform=`translate3d(${o-d}px, ${t-d}px, 0)`}}function C(e,t,o){let r,n,u,l,a,c,s,i;switch(l=Math.floor(6*e),a=6*e-l,c=o*(1-t),s=o*(1-a*t),i=o*(1-(1-a)*t),l%6){case 0:r=o,n=i,u=c;break;case 1:r=s,n=o,u=c;break;case 2:r=c,n=o,u=i;break;case 3:r=c,n=s,u=o;break;case 4:r=i,n=c,u=o;break;case 5:r=o,n=c,u=s}return[Math.round(255*r),Math.round(255*n),Math.round(255*u)]}!1===scripts_loaded.complexjs?load_script("/scripts/complex.min.js").then((function(){scripts_loaded.complexjs=!0,S()})).catch((function(e){console.error("Could not load ComplexJS")})):S(),document.querySelector("#download-button").addEventListener("click",(function(){e=parseInt(document.querySelector("#image-size-input").value||1e3),h=parseInt(document.querySelector("#max-depth-input").value||100),g=parseInt(document.querySelector("#max-pixel-brightness-input").value||50),r=[],o=[];for(let t=0;t<e;t++){r[t]=[],o[t]=[];for(let n=0;n<e;n++)q=t/e*4-2,y=2-n/e*4,r[t][n]=(Math.atan2(-y,-q)+Math.PI)/(2*Math.PI),o[t][n]=0}try{n.terminate()}catch(e){}n=DEBUG?new Worker("/applets/quasi-fuchsian-groups/scripts/worker.js"):new Worker("/applets/quasi-fuchsian-groups/scripts/worker.min.js");temporary_web_workers.push(n),n.onmessage=function(n){o=n.data[0],document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e);let u=t.getImageData(0,0,e,e),l=u.data;for(let t=0;t<e;t++)for(let n=0;n<e;n++){let u=4*t*e+4*n,a=C(r[t][n],1,o[t][n]);l[u]=a[0],l[u+1]=a[1],l[u+2]=a[2],l[u+3]=255}t.putImageData(u,0,0),function(){let e=document.createElement("a");e.download="a-quasi-fuchsian-group.png",e.href=document.querySelector("#quasi-fuchsian-groups-plot").toDataURL(),e.click(),e.remove()}()},n.postMessage([e,h,g,4,l])})),function(){1===url_vars.contrast&&(1===url_vars.theme?document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(192, 192, 192)":document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(64, 64, 64)");add_style("\n\t\t\t.coefficient-marker.hover\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\t\n\t\t\t}\n\t\t\t\n\t\t\t.coefficient-marker:not(:hover):focus\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\n\t\t\t\toutline: none;\n\t\t\t}\n\t\t",!0)}(),document.documentElement.addEventListener("touchstart",x,!1),document.documentElement.addEventListener("touchmove",_,!1),document.documentElement.addEventListener("touchend",M,!1),document.documentElement.addEventListener("mousedown",x,!1),document.documentElement.addEventListener("mousemove",_,!1),document.documentElement.addEventListener("mouseup",M,!1),temporary_handlers.touchstart.push(x),temporary_handlers.touchmove.push(_),temporary_handlers.touchend.push(M),temporary_handlers.mousedown.push(x),temporary_handlers.mousemove.push(_),temporary_handlers.mouseup.push(M),applet_canvases_to_resize=[document.querySelector("#quasi-fuchsian-groups-plot"),document.querySelector("#coefficient-selector")],applet_canvas_resize_callback=function(){i=document.querySelector("#coefficient-selector").offsetWidth,m=document.querySelector("#coefficient-selector").offsetHeight,k()},set_up_canvas_resizer()}();