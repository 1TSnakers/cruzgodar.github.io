!function(){"use strict";let e=300,t=3,o=document.querySelector("#quasi-fuchsian-groups-plot").getContext("2d",{alpha:!1}),r=[],n=[],u=null,l=[[2,0],[2,0]],a=[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0]],[],[]],c=[],s=[],i=-1,m=document.querySelector("#coefficient-selector").offsetWidth,d=document.querySelector("#coefficient-selector").offsetHeight,f=17.5,p=!1,h=!0,g=20,q=10,y=0,w=0;document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}function b(){o.fillStyle="rgb(0, 0, 0)",o.fillRect(0,0,e,e);let t=new Complex(l[0]),u=new Complex(l[1]),c=new Complex([0,0]);c=t.mul(u);let s=new Complex([0,0]);s=t.mul(t).add(u.mul(u));let i=new Complex([0,0]);i=c.sub(c.mul(c).sub(s.mul(4)).sqrt()).div(2);let m=new Complex([0,0]);m=i.sub(2).mul(u).div(u.mul(i).sub(t.mul(2)).add(i.mul(new Complex([0,2]))));let d=new Complex([0,0]);d=t.div(2),a[0][0][0]=d.re,a[0][0][1]=d.im,a[0][3][0]=d.re,a[0][3][1]=d.im,d=t.mul(i).sub(u.mul(2)).add(new Complex([0,4])).div(i.mul(2).add(4).mul(m)),a[0][1][0]=d.re,a[0][1][1]=d.im,d=t.mul(i).sub(u.mul(2)).sub(new Complex([0,4])).mul(m).div(i.mul(2).sub(4)),a[0][2][0]=d.re,a[0][2][1]=d.im,d=u.sub(new Complex([0,2])).div(2),a[1][0][0]=d.re,a[1][0][1]=d.im,d=u.div(2),a[1][1][0]=d.re,a[1][1][1]=d.im,a[1][2][0]=d.re,a[1][2][1]=d.im,d=u.add(new Complex([0,2])).div(2),a[1][3][0]=d.re,a[1][3][1]=d.im;for(let e=0;e<2;e++){let t=a[e][0][0],o=a[e][0][1],r=a[e][1][0],n=a[e][1][1],u=a[e][2][0],l=a[e][2][1],c=a[e][3][0],s=a[e][3][1];a[e+2]=[[c,s],[-r,-n],[-u,-l],[t,o]]}for(let e=0;e<4;e++)v(0,0,e,-1,-1,1);let f=r.flat().sort(function(e,t){return e-t}),g=f[f.length-1],q=o.getImageData(0,0,e,e),y=q.data;for(let t=0;t<e;t++)for(let o=0;o<e;o++){let u=4*t*e+4*o,l=E(n[t][o],1,Math.pow(r[t][o]/g,.25));y[u]=l[0],y[u+1]=l[1],y[u+2]=l[2],y[u+3]=255}o.putImageData(q,0,0),p?(p=!1,window.requestAnimationFrame(b)):h=!0}function v(o,n,u,l,a,c){if(c!==g)for(let l=3;l<6;l++){y=o,w=n;let a=(u+l)%4;x(a);let s=Math.floor((t/2-w)/t*e),i=Math.floor((y+t/2)/t*e);if(s>=0&&s<e&&i>=0&&i<e){if(r[s][i]===q)continue;c>10&&r[s][i]++,v(y,w,a,s,i,c+1)}}}function x(e){let t=a[e][0][0],o=a[e][0][1],r=a[e][1][0],n=a[e][1][1],u=a[e][2][0],l=a[e][2][1],c=a[e][3][0],s=a[e][3][1],i=t*y-o*w+r,m=t*w+o*y+n,d=u*y-l*w+c,f=u*w+l*y+s,p=d*d+f*f;y=(i*d+m*f)/p,w=(m*d-i*f)/p}function S(o){i=-1;for(let u=0;u<2;u++)if(o.target.id===`coefficient-marker-${u}`){o.preventDefault(),i=u,e=300,g=20,q=10,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}p=!0,h&&(h=!1,window.requestAnimationFrame(b))}}function M(o){if(-1!==i){e=600,g=100,q=50,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}p=!0,h&&(h=!1,window.requestAnimationFrame(b))}i=-1}function C(o){if(-1===i)return;let n=null,u=null,a=document.querySelector("#coefficient-selector").getBoundingClientRect();"touchmove"===o.type?(n=o.touches[0].clientY-a.top,u=o.touches[0].clientX-a.left):(n=o.clientY-a.top,u=o.clientX-a.left),n<f&&(n=f),n>d-f&&(n=d-f),u<f&&(u=f),u>m-f&&(u=m-f),c[i].style.transform=`translate3d(${u-f}px, ${n-f}px, 0)`,l[i][0]=3*(u/m*t-t/2),l[i][1]=3*(t/2-n/d*t);for(let t=0;t<e;t++)for(let o=0;o<e;o++)r[t][o]=0;p=!0,h&&(h=!1,window.requestAnimationFrame(b))}function k(){m=document.querySelector("#coefficient-selector").offsetWidth,d=document.querySelector("#coefficient-selector").offsetHeight;document.querySelector("#coefficient-selector").getBoundingClientRect();for(let e=0;e<2;e++){let o=Math.floor((t/2-l[e][1]/3)/t*d),r=Math.floor((t/2+l[e][0]/3)/t*m);c[e].style.transform=`translate3d(${r-f}px, ${o-f}px, 0)`}}function E(e,t,o){let r,n,u,l,a,c,s,i;switch(c=o*(1-t),s=o*(1-(a=6*e-(l=Math.floor(6*e)))*t),i=o*(1-(1-a)*t),l%6){case 0:r=o,n=i,u=c;break;case 1:r=s,n=o,u=c;break;case 2:r=c,n=o,u=i;break;case 3:r=c,n=s,u=o;break;case 4:r=i,n=c,u=o;break;case 5:r=o,n=c,u=s}return[Math.round(255*r),Math.round(255*n),Math.round(255*u)]}!1===scripts_loaded.complexjs&&load_script("/scripts/complex.min.js").then(function(){scripts_loaded.complexjs=!0,function(){for(let e=0;e<2;e++){let t=document.createElement("div");t.classList.add("coefficient-marker"),t.id=`coefficient-marker-${e}`,document.querySelector("#coefficient-selector").appendChild(t),c.push(t)}for(let t=0;t<2;t++){s.push([Math.floor(e/2),Math.floor(e/2)]);let o=s[t][0]/e*d,r=s[t][1]/e*m;c[t].style.transform=`translate3d(${r-f}px, ${o-f}px, 0)`}b()}()}).catch(function(e){console.error("Could not load ComplexJS")}),document.querySelector("#download-button").addEventListener("click",function(){e=parseInt(document.querySelector("#image-size-input").value||1e3),g=parseInt(document.querySelector("#max-depth-input").value||100),q=parseInt(document.querySelector("#max-pixel-brightness-input").value||50),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}try{u.terminate()}catch(e){}u=DEBUG?new Worker("/applets/quasi-fuchsian-groups/scripts/worker.js"):new Worker("/applets/quasi-fuchsian-groups/scripts/worker.min.js");temporary_web_workers.push(u),u.onmessage=function(t){r=t.data[0],document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e);let u=o.getImageData(0,0,e,e),l=u.data;for(let t=0;t<e;t++)for(let o=0;o<e;o++){let u=4*t*e+4*o,a=E(n[t][o],1,r[t][o]);l[u]=a[0],l[u+1]=a[1],l[u+2]=a[2],l[u+3]=255}o.putImageData(u,0,0),function(){let e=document.createElement("a");e.download="a-quasi-fuchsian-group.png",e.href=document.querySelector("#quasi-fuchsian-groups-plot").toDataURL(),e.click(),e.remove()}()},u.postMessage([e,g,q,t,a])}),function(){1===url_vars.contrast&&(1===url_vars.theme?document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(192, 192, 192)":document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(64, 64, 64)");add_style("\n\t\t\t.coefficient-marker.hover\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\t\n\t\t\t}\n\t\t\t\n\t\t\t.coefficient-marker:not(:hover):focus\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\n\t\t\t\toutline: none;\n\t\t\t}\n\t\t",!0)}(),document.documentElement.addEventListener("touchstart",S,!1),document.documentElement.addEventListener("touchmove",C,!1),document.documentElement.addEventListener("touchend",M,!1),document.documentElement.addEventListener("mousedown",S,!1),document.documentElement.addEventListener("mousemove",C,!1),document.documentElement.addEventListener("mouseup",M,!1),temporary_handlers.touchstart.push(S),temporary_handlers.touchmove.push(C),temporary_handlers.touchend.push(M),temporary_handlers.mousedown.push(S),temporary_handlers.mousemove.push(C),temporary_handlers.mouseup.push(M),window.addEventListener("resize",k),temporary_handlers.resize.push(k),setTimeout(k,1e3)}();