!function(){"use strict";let e=300,t=300,o=300,r=4,u=document.querySelector("#quasi-fuchsian-groups-plot").getContext("2d",{alpha:!1}),n=[],a=[],l=null,s=[[2,0],[2,0]],c=[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0]],[],[]],i=[],m=[],d=-1,f=document.querySelector("#coefficient-selector").offsetWidth,p=document.querySelector("#coefficient-selector").offsetHeight,h=17.5,g=!1,q=!0,y=20,_=10,b=0,w=0;document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",t),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",o),a=[],n=[];for(let e=0;e<o;e++){a[e]=[],n[e]=[];for(let u=0;u<t;u++)b=e/o*r-r/2,w=r/2-u/t*r,a[e][u]=(Math.atan2(-w,-b)+Math.PI)/(2*Math.PI),n[e][u]=0}function v(){u.fillStyle="rgb(0, 0, 0)",u.fillRect(0,0,t,o);let e=new Complex(s[0]),r=new Complex(s[1]),l=new Complex([0,0]);l=e.mul(r);let i=new Complex([0,0]);i=e.mul(e).add(r.mul(r));let m=new Complex([0,0]);m=l.mul(l).sub(i.mul(4)).arg()>0?l.sub(l.mul(l).sub(i.mul(4)).sqrt()).div(2):l.add(l.mul(l).sub(i.mul(4)).sqrt()).div(2);let d=new Complex([0,0]);d=m.sub(2).mul(r).div(r.mul(m).sub(e.mul(2)).add(m.mul(new Complex([0,2]))));let f=new Complex([0,0]);f=e.div(2),c[0][0][0]=f.re,c[0][0][1]=f.im,c[0][3][0]=f.re,c[0][3][1]=f.im,f=e.mul(m).sub(r.mul(2)).add(new Complex([0,4])).div(m.mul(2).add(4).mul(d)),c[0][1][0]=f.re,c[0][1][1]=f.im,f=e.mul(m).sub(r.mul(2)).sub(new Complex([0,4])).mul(d).div(m.mul(2).sub(4)),c[0][2][0]=f.re,c[0][2][1]=f.im,f=r.sub(new Complex([0,2])).div(2),c[1][0][0]=f.re,c[1][0][1]=f.im,f=r.div(2),c[1][1][0]=f.re,c[1][1][1]=f.im,c[1][2][0]=f.re,c[1][2][1]=f.im,f=r.add(new Complex([0,2])).div(2),c[1][3][0]=f.re,c[1][3][1]=f.im;for(let e=0;e<2;e++){let t=c[e][0][0],o=c[e][0][1],r=c[e][1][0],u=c[e][1][1],n=c[e][2][0],a=c[e][2][1],l=c[e][3][0],s=c[e][3][1];c[e+2]=[[l,s],[-r,-u],[-n,-a],[t,o]]}for(let e=0;e<4;e++)M(0,0,e,-1,-1,1);let p=n.flat().sort(function(e,t){return e-t}),h=p[p.length-1],y=u.getImageData(0,0,t,o),_=y.data;for(let e=0;e<o;e++)for(let o=0;o<t;o++){let r=4*e*t+4*o,u=A(a[e][o],1,Math.pow(n[e][o]/h,.25));_[r]=u[0],_[r+1]=u[1],_[r+2]=u[2],_[r+3]=255}u.putImageData(y,0,0),g?(g=!1,window.requestAnimationFrame(v)):q=!0}function M(e,u,a,l,s,c){if(c!==y)for(let l=3;l<6;l++){b=e,w=u;let s=(a+l)%4;S(s);let i=Math.floor((r/2-w)/r*o),m=Math.floor((b/(t/o)+r/2)/r*t);if(i>=0&&i<o&&m>=0&&m<t){if(n[i][m]===_)continue;c>10&&n[i][m]++}M(b,w,s,i,m,c+1)}}function S(e){let t=c[e][0][0],o=c[e][0][1],r=c[e][1][0],u=c[e][1][1],n=c[e][2][0],a=c[e][2][1],l=c[e][3][0],s=c[e][3][1],i=t*b-o*w+r,m=t*w+o*b+u,d=n*b-a*w+l,f=n*w+a*b+s,p=d*d+f*f;b=(i*d+m*f)/p,w=(m*d-i*f)/p}function x(){for(let e=0;e<2;e++)i.push(document.querySelector(`#coefficient-marker-${e}`));for(let e=0;e<2;e++){m.push([Math.floor(o/2),Math.floor(t/2)]);let r=m[e][0]/o*p,u=m[e][1]/(t/o)/t*f;i[e].style.transform=`translate3d(${u-h}px, ${r-h}px, 0)`,i[e].classList.add("no-floating-footer")}window.addEventListener("resize",E),temporary_handlers.resize.push(E),setTimeout(E,1e3),v()}function k(u){d=-1;for(let l=0;l<2;l++)if(u.target.id===`coefficient-marker-${l}`){u.preventDefault(),d=l,e=300,canvas_is_fullscreen?aspect_ratio>=1?(t=e,o=Math.floor(e/aspect_ratio)):(t=Math.floor(e*aspect_ratio),o=e):(t=e,o=e),y=20,_=10,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",t),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",o),a=[],n=[];for(let e=0;e<o;e++){a[e]=[],n[e]=[];for(let u=0;u<t;u++)b=e/o*r-r/2,w=r/2-u/t*r,a[e][u]=(Math.atan2(-w,-b)+Math.PI)/(2*Math.PI),n[e][u]=0}g=!0,q&&(q=!1,window.requestAnimationFrame(v))}}function C(u){if(-1!==d){e=1e3,canvas_is_fullscreen?aspect_ratio>=1?(t=e,o=Math.floor(e/aspect_ratio)):(t=Math.floor(e*aspect_ratio),o=e):(t=e,o=e),y=100,_=50,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",t),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",o),a=[],n=[];for(let e=0;e<o;e++){a[e]=[],n[e]=[];for(let u=0;u<t;u++)b=e/o*r-r/2,w=r/2-u/t*r,a[e][u]=(Math.atan2(-w,-b)+Math.PI)/(2*Math.PI),n[e][u]=0}g=!0,q&&(q=!1,window.requestAnimationFrame(v))}d=-1}function I(e){if(-1===d)return;let r=null,u=null,a=document.querySelector("#coefficient-selector").getBoundingClientRect();"touchmove"===e.type?(r=e.touches[0].clientY-a.top,u=e.touches[0].clientX-a.left):(r=e.clientY-a.top,u=e.clientX-a.left),r<h&&(r=h),r>p-h&&(r=p-h),u<h&&(u=h),u>f-h&&(u=f-h),i[d].style.transform=`translate3d(${u-h}px, ${r-h}px, 0)`,s[d][0]=u/f-.5+2,s[d][1]=1-r/p-.5;for(let e=0;e<o;e++)for(let o=0;o<t;o++)n[e][o]=0;g=!0,q&&(q=!1,window.requestAnimationFrame(v))}function E(){f=document.querySelector("#coefficient-selector").offsetWidth,p=document.querySelector("#coefficient-selector").offsetHeight;for(let e=0;e<2;e++){let t=Math.floor((1-(s[e][1]+.5))*p),o=Math.floor((s[e][0]-2+.5)*f);i[e].style.transform=`translate3d(${o-h}px, ${t-h}px, 0)`}v()}function A(e,t,o){let r,u,n,a,l,s,c,i;switch(s=o*(1-t),c=o*(1-(l=6*e-(a=Math.floor(6*e)))*t),i=o*(1-(1-l)*t),a%6){case 0:r=o,u=i,n=s;break;case 1:r=c,u=o,n=s;break;case 2:r=s,u=o,n=i;break;case 3:r=s,u=c,n=o;break;case 4:r=i,u=s,n=o;break;case 5:r=o,u=s,n=c}return[Math.round(255*r),Math.round(255*u),Math.round(255*n)]}!1===scripts_loaded.complexjs?load_script("/scripts/complex.min.js").then(function(){scripts_loaded.complexjs=!0,x()}).catch(function(e){console.error("Could not load ComplexJS")}):x(),document.querySelector("#download-button").addEventListener("click",function(){e=parseInt(document.querySelector("#image-size-input").value||1e3),y=parseInt(document.querySelector("#max-depth-input").value||100),_=parseInt(document.querySelector("#max-pixel-brightness-input").value||50),a=[],n=[];for(let e=0;e<o;e++){a[e]=[],n[e]=[];for(let u=0;u<t;u++)b=e/o*r-r/2,w=r/2-u/t*r,a[e][u]=(Math.atan2(-w,-b)+Math.PI)/(2*Math.PI),n[e][u]=0}try{l.terminate()}catch(e){}l=DEBUG?new Worker("/applets/quasi-fuchsian-groups/scripts/worker.js"):new Worker("/applets/quasi-fuchsian-groups/scripts/worker.min.js");temporary_web_workers.push(l),l.onmessage=function(r){n=r.data[0],document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e);let l=u.getImageData(0,0,t,o),s=l.data;for(let e=0;e<o;e++)for(let o=0;o<t;o++){let r=4*e*t+4*o,u=A(a[e][o],1,n[e][o]);s[r]=u[0],s[r+1]=u[1],s[r+2]=u[2],s[r+3]=255}u.putImageData(l,0,0),function(){let e=document.createElement("a");e.download="a-quasi-fuchsian-group.png",e.href=document.querySelector("#quasi-fuchsian-groups-plot").toDataURL(),e.click(),e.remove()}()},l.postMessage([t,o,y,_,r,c])}),function(){1===url_vars.contrast&&(1===url_vars.theme?document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(192, 192, 192)":document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(64, 64, 64)");add_style("\n\t\t\t.coefficient-marker.hover\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\t\n\t\t\t}\n\t\t\t\n\t\t\t.coefficient-marker:not(:hover):focus\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\n\t\t\t\toutline: none;\n\t\t\t}\n\t\t",!0)}(),document.documentElement.addEventListener("touchstart",k,!1),document.documentElement.addEventListener("touchmove",I,!1),document.documentElement.addEventListener("touchend",C,!1),document.documentElement.addEventListener("mousedown",k,!1),document.documentElement.addEventListener("mousemove",I,!1),document.documentElement.addEventListener("mouseup",C,!1),temporary_handlers.touchstart.push(k),temporary_handlers.touchmove.push(I),temporary_handlers.touchend.push(C),temporary_handlers.mousedown.push(k),temporary_handlers.mousemove.push(I),temporary_handlers.mouseup.push(C),applet_canvases_to_resize=[document.querySelector("#quasi-fuchsian-groups-plot"),document.querySelector("#coefficient-selector")],applet_canvas_resize_callback=function(){canvas_is_fullscreen?aspect_ratio>=1?(t=e,o=Math.floor(e/aspect_ratio)):(t=Math.floor(e*aspect_ratio),o=e):(t=e,o=e);for(let e=0;e<o;e++){a[e]=[],n[e]=[];for(let u=0;u<t;u++)b=e/o*r-r/2,w=r/2-u/t*r,a[e][u]=(Math.atan2(-w,-b)+Math.PI)/(2*Math.PI),n[e][u]=0}document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",t),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",o),E(),v()},applet_canvas_true_fullscreen=!0,set_up_canvas_resizer()}();