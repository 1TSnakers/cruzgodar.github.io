!function(){"use strict";let e=300,t=4,o=document.querySelector("#quasi-fuchsian-groups-plot").getContext("2d",{alpha:!1}),r=[],n=[],u=null,l=[[2,0],[2,0]],a=[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0]],[],[]],s=[],c=[],i=-1,m=document.querySelector("#coefficient-selector").offsetWidth,d=document.querySelector("#coefficient-selector").offsetHeight,f=17.5,p=!1,h=!0,g=20,q=10,y=0,w=0;document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}function b(){o.fillStyle="rgb(0, 0, 0)",o.fillRect(0,0,e,e);let t=new Complex(l[0]),u=new Complex(l[1]),s=new Complex([0,0]);s=t.mul(u);let c=new Complex([0,0]);c=t.mul(t).add(u.mul(u));let i=new Complex([0,0]);i=s.mul(s).sub(c.mul(4)).arg()>0?s.sub(s.mul(s).sub(c.mul(4)).sqrt()).div(2):s.add(s.mul(s).sub(c.mul(4)).sqrt()).div(2);let m=new Complex([0,0]);m=i.sub(2).mul(u).div(u.mul(i).sub(t.mul(2)).add(i.mul(new Complex([0,2]))));let d=new Complex([0,0]);d=t.div(2),a[0][0][0]=d.re,a[0][0][1]=d.im,a[0][3][0]=d.re,a[0][3][1]=d.im,d=t.mul(i).sub(u.mul(2)).add(new Complex([0,4])).div(i.mul(2).add(4).mul(m)),a[0][1][0]=d.re,a[0][1][1]=d.im,d=t.mul(i).sub(u.mul(2)).sub(new Complex([0,4])).mul(m).div(i.mul(2).sub(4)),a[0][2][0]=d.re,a[0][2][1]=d.im,d=u.sub(new Complex([0,2])).div(2),a[1][0][0]=d.re,a[1][0][1]=d.im,d=u.div(2),a[1][1][0]=d.re,a[1][1][1]=d.im,a[1][2][0]=d.re,a[1][2][1]=d.im,d=u.add(new Complex([0,2])).div(2),a[1][3][0]=d.re,a[1][3][1]=d.im;for(let e=0;e<2;e++){let t=a[e][0][0],o=a[e][0][1],r=a[e][1][0],n=a[e][1][1],u=a[e][2][0],l=a[e][2][1],s=a[e][3][0],c=a[e][3][1];a[e+2]=[[s,c],[-r,-n],[-u,-l],[t,o]]}for(let e=0;e<4;e++)v(0,0,e,-1,-1,1);let f=r.flat().sort(function(e,t){return e-t}),g=f[f.length-1],q=o.getImageData(0,0,e,e),y=q.data;for(let t=0;t<e;t++)for(let o=0;o<e;o++){let u=4*t*e+4*o,l=E(n[t][o],1,Math.pow(r[t][o]/g,.25));y[u]=l[0],y[u+1]=l[1],y[u+2]=l[2],y[u+3]=255}o.putImageData(q,0,0),p?(p=!1,window.requestAnimationFrame(b)):h=!0}function v(o,n,u,l,a,s){if(s!==g)for(let l=3;l<6;l++){y=o,w=n;let a=(u+l)%4;S(a);let c=Math.floor((t/2-w)/t*e),i=Math.floor((y+t/2)/t*e);if(c>=0&&c<e&&i>=0&&i<e){if(r[c][i]===q)continue;s>10&&r[c][i]++}v(y,w,a,c,i,s+1)}}function S(e){let t=a[e][0][0],o=a[e][0][1],r=a[e][1][0],n=a[e][1][1],u=a[e][2][0],l=a[e][2][1],s=a[e][3][0],c=a[e][3][1],i=t*y-o*w+r,m=t*w+o*y+n,d=u*y-l*w+s,f=u*w+l*y+c,p=d*d+f*f;y=(i*d+m*f)/p,w=(m*d-i*f)/p}function x(){for(let e=0;e<2;e++)s.push(document.querySelector(`#coefficient-marker-${e}`));for(let t=0;t<2;t++){c.push([Math.floor(e/2),Math.floor(e/2)]);let o=c[t][0]/e*d,r=c[t][1]/e*m;s[t].style.transform=`translate3d(${r-f}px, ${o-f}px, 0)`,s[t].classList.add("no-floating-footer")}window.addEventListener("resize",C),temporary_handlers.resize.push(C),setTimeout(C,1e3),b()}function M(o){i=-1;for(let u=0;u<2;u++)if(o.target.id===`coefficient-marker-${u}`){o.preventDefault(),i=u,e=300,g=20,q=10,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}p=!0,h&&(h=!1,window.requestAnimationFrame(b))}}function _(o){if(-1!==i){e=600,g=100,q=50,document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}p=!0,h&&(h=!1,window.requestAnimationFrame(b))}i=-1}function k(t){if(-1===i)return;let o=null,n=null,u=document.querySelector("#coefficient-selector").getBoundingClientRect();"touchmove"===t.type?(o=t.touches[0].clientY-u.top,n=t.touches[0].clientX-u.left):(o=t.clientY-u.top,n=t.clientX-u.left),o<f&&(o=f),o>d-f&&(o=d-f),n<f&&(n=f),n>m-f&&(n=m-f),s[i].style.transform=`translate3d(${n-f}px, ${o-f}px, 0)`,l[i][0]=n/m-.5+2,l[i][1]=1-o/d-.5;for(let t=0;t<e;t++)for(let o=0;o<e;o++)r[t][o]=0;p=!0,h&&(h=!1,window.requestAnimationFrame(b))}function C(){m=document.querySelector("#coefficient-selector").offsetWidth,d=document.querySelector("#coefficient-selector").offsetHeight;document.querySelector("#coefficient-selector").getBoundingClientRect();for(let e=0;e<2;e++){let t=Math.floor((1-(l[e][1]+.5))*d),o=Math.floor((l[e][0]-2+.5)*m);s[e].style.transform=`translate3d(${o-f}px, ${t-f}px, 0)`}}function E(e,t,o){let r,n,u,l,a,s,c,i;switch(s=o*(1-t),c=o*(1-(a=6*e-(l=Math.floor(6*e)))*t),i=o*(1-(1-a)*t),l%6){case 0:r=o,n=i,u=s;break;case 1:r=c,n=o,u=s;break;case 2:r=s,n=o,u=i;break;case 3:r=s,n=c,u=o;break;case 4:r=i,n=s,u=o;break;case 5:r=o,n=s,u=c}return[Math.round(255*r),Math.round(255*n),Math.round(255*u)]}!1===scripts_loaded.complexjs?load_script("/scripts/complex.min.js").then(function(){scripts_loaded.complexjs=!0,x()}).catch(function(e){console.error("Could not load ComplexJS")}):x(),document.querySelector("#download-button").addEventListener("click",function(){e=parseInt(document.querySelector("#image-size-input").value||1e3),g=parseInt(document.querySelector("#max-depth-input").value||100),q=parseInt(document.querySelector("#max-pixel-brightness-input").value||50),n=[],r=[];for(let o=0;o<e;o++){n[o]=[],r[o]=[];for(let u=0;u<e;u++)y=o/e*t-t/2,w=t/2-u/e*t,n[o][u]=(Math.atan2(-w,-y)+Math.PI)/(2*Math.PI),r[o][u]=0}try{u.terminate()}catch(e){}u=DEBUG?new Worker("/applets/quasi-fuchsian-groups/scripts/worker.js"):new Worker("/applets/quasi-fuchsian-groups/scripts/worker.min.js");temporary_web_workers.push(u),u.onmessage=function(t){r=t.data[0],document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("width",e),document.querySelector("#quasi-fuchsian-groups-plot").setAttribute("height",e);let u=o.getImageData(0,0,e,e),l=u.data;for(let t=0;t<e;t++)for(let o=0;o<e;o++){let u=4*t*e+4*o,a=E(n[t][o],1,r[t][o]);l[u]=a[0],l[u+1]=a[1],l[u+2]=a[2],l[u+3]=255}o.putImageData(u,0,0),function(){let e=document.createElement("a");e.download="a-quasi-fuchsian-group.png",e.href=document.querySelector("#quasi-fuchsian-groups-plot").toDataURL(),e.click(),e.remove()}()},u.postMessage([e,g,q,t,a])}),function(){1===url_vars.contrast&&(1===url_vars.theme?document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(192, 192, 192)":document.querySelector("#quasi-fuchsian-groups-plot").style.borderColor="rgb(64, 64, 64)");add_style("\n\t\t\t.coefficient-marker.hover\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\t\n\t\t\t}\n\t\t\t\n\t\t\t.coefficient-marker:not(:hover):focus\n\t\t\t{\n\t\t\t\tbackground-color: rgb(127, 127, 127);\n\t\t\t\toutline: none;\n\t\t\t}\n\t\t",!0)}(),document.documentElement.addEventListener("touchstart",M,!1),document.documentElement.addEventListener("touchmove",k,!1),document.documentElement.addEventListener("touchend",_,!1),document.documentElement.addEventListener("mousedown",M,!1),document.documentElement.addEventListener("mousemove",k,!1),document.documentElement.addEventListener("mouseup",_,!1),temporary_handlers.touchstart.push(M),temporary_handlers.touchmove.push(k),temporary_handlers.touchend.push(_),temporary_handlers.mousedown.push(M),temporary_handlers.mousemove.push(k),temporary_handlers.mouseup.push(_),applet_canvases_to_resize=[document.querySelector("#quasi-fuchsian-groups-plot"),document.querySelector("#coefficient-selector")],applet_canvas_resize_callback=function(){m=document.querySelector("#coefficient-selector").offsetWidth,d=document.querySelector("#coefficient-selector").offsetHeight,C()},set_up_canvas_resizer()}();