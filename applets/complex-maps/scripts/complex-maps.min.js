!function(){"use strict";let t=null,e=null,n=1,r=1,o=[],a=500,i=100,l=0,c=0,_=0,s=0,d=0,u=0,w=0,h=0;const f=.96,m=.0025,g=25e-5,v=.93,p=.01,x=.001;let y=-1,z=document.querySelector("#code-textarea");z.value="cexp(cinv(z))",document.querySelector("#generate-button").addEventListener("click",q);let M=document.querySelector("#resolution-input");M.addEventListener("input",()=>{a=parseInt(M.value||500),t.change_canvas_size(a,a),window.requestAnimationFrame(K)}),document.querySelector("#download-button").addEventListener("click",()=>{t.download_frame("a-complex-map.png")});let b=document.querySelector("#canvas-location");function q(){let n=z.value||"cexp(cinv(z))",a=`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float brightness_scale;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${COMPLEX_GLSL}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\treturn ${n};\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = 1.0 / (1.0 + .01 * modulus);\n\t\t\t\tfloat v = 1.0 / (1.0 + .01 / modulus);//max(1.0 / (1.0 + 1.0 / modulus), 1.0 / (1.0 + 1.0 * modulus));\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t}\n\t\t`,i={renderer:"gpu",shader:a,canvas_width:500,canvas_height:500,world_width:2,world_height:2,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:W,mousedown_callback:k,touchstart_callback:k,mousedrag_callback:A,touchmove_callback:A,mouseup_callback:F,touchend_callback:F,wheel_callback:L,pinch_callback:S},l={renderer:"gpu",shader:a,canvas_width:100,canvas_height:100};try{t.output_canvas_container.parentNode.remove(),e.output_canvas_container.parentNode.remove(),b.insertAdjacentHTML("beforebegin",'\n\t\t\t\t<div>\n\t\t\t\t\t<canvas id="output-canvas" class="output-canvas"></canvas>\n\t\t\t\t\t<canvas id="hidden-canvas" class="hidden-canvas"></canvas>\n\t\t\t\t</div>\n\t\t\t')}catch(t){}(t=new Wilson(document.querySelector("#output-canvas"),i)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","brightness_scale"]),(e=new Wilson(document.querySelector("#hidden-canvas"),l)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","brightness_scale"]),o=[],r=-.585,_=0,s=0,d=0,u=0,w=0,h=0,t.gl.uniform1f(t.uniforms.aspect_ratio,1),e.gl.uniform1f(e.uniforms.aspect_ratio,1),window.requestAnimationFrame(K)}function k(t,e,n){u=0,w=0,h=0,_=0,s=0,d=0}function A(e,n,r,o,a){t.world_center_x-=r,t.world_center_y-=o,_=-r/t.world_width,s=-o/t.world_height,window.requestAnimationFrame(K)}function F(t,e,n){Math.sqrt(_*_+s*s)>=m&&(u=_,w=s),Math.abs(d)>=p&&(h=d),window.requestAnimationFrame(K)}function L(t,e,n,o){l=t,c=e,Math.abs(n/100)<.3?r+=n/100:h+=.05*Math.sign(n),E()}function S(e,o,a,i){n>=1?(r-=a/t.world_width*10,d=-a/t.world_width*10):(r-=a/t.world_height*10,d=-a/t.world_height*10),l=e,c=o,E()}function E(){if(n>=1){let e=t.input.get_zoomed_world_center(l,c,3*Math.pow(2,r)*n,3*Math.pow(2,r));t.world_width=3*Math.pow(2,r)*n,t.world_height=3*Math.pow(2,r),t.world_center_x=e[0],t.world_center_y=e[1]}else{let e=t.input.get_zoomed_world_center(l,c,3*Math.pow(2,r),3*Math.pow(2,r)/n);t.world_width=3*Math.pow(2,r),t.world_height=3*Math.pow(2,r)/n,t.world_center_x=e[0],t.world_center_y=e[1]}window.requestAnimationFrame(K)}function K(a){let l=a-y;if(y=a,0===l)return;e.gl.uniform1f(e.uniforms.aspect_ratio,n),e.gl.uniform1f(e.uniforms.world_center_x,t.world_center_x),e.gl.uniform1f(e.uniforms.world_center_y,t.world_center_y),e.gl.uniform1f(e.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),e.gl.uniform1f(e.uniforms.brightness_scale,50),e.render.draw_frame();let c=e.render.get_pixel_data(),_=new Array(i*i);for(let t=0;t<i*i;t++)_[t]=c[4*t]+c[4*t+1]+c[4*t+2];_.sort((t,e)=>t-e);let s=Math.min(Math.max((_[Math.floor(i*i*.96)]+_[Math.floor(i*i*.98)])/50,.5),50);o.push(s),o.length>10&&o.shift(),s=1,t.gl.uniform1f(t.uniforms.aspect_ratio,n),t.gl.uniform1f(t.uniforms.world_center_x,t.world_center_x),t.gl.uniform1f(t.uniforms.world_center_y,t.world_center_y),t.gl.uniform1f(t.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),t.gl.uniform1f(t.uniforms.brightness_scale,s),t.render.draw_frame(),0===u&&0===w&&0===h||(t.world_center_x+=u*t.world_width,t.world_center_y+=w*t.world_height,u*=f,w*=f,Math.sqrt(u*u+w*w)<g&&(u=0,w=0),r+=h,E(),h*=v,Math.abs(h)<x&&(h=0),window.requestAnimationFrame(K))}function W(){t.fullscreen.currently_fullscreen?(n=window.innerWidth/window.innerHeight)>=1?(t.change_canvas_size(a,Math.floor(a/n)),t.world_width=3*Math.pow(2,r)*n,t.world_height=3*Math.pow(2,r)):(t.change_canvas_size(Math.floor(a*n),a),t.world_width=3*Math.pow(2,r),t.world_height=3*Math.pow(2,r)/n):(n=1,t.change_canvas_size(a,a),t.world_width=3*Math.pow(2,r),t.world_height=3*Math.pow(2,r)),window.requestAnimationFrame(K)}q(),window.addEventListener("resize",W),Page.temporary_handlers.resize.push(W)}();