!async function(){"use strict";Site.scripts_loaded.glsl||await Site.load_glsl();let t=null,e=1,n=1,o=[],r=500,i=1,a=1,l=0,c=0,_=0,d=0,s=0,u=0,w=0,h=0;const f=.96,p=.0025,m=25e-5,v=.93,g=.01,x=.001;let y=-1,M=document.querySelector("#code-textarea");M.value="cexp(cinv(z))",document.querySelector("#generate-button").addEventListener("click",A);let b=document.querySelector("#resolution-input");b.addEventListener("input",()=>{r=parseInt(b.value||500),t.change_canvas_size(r,r),window.requestAnimationFrame(G)});let z=document.querySelector("#black-point-input");z.addEventListener("input",()=>{i=parseFloat(z.value||1),window.requestAnimationFrame(G)});let q=document.querySelector("#white-point-input");q.addEventListener("input",()=>{a=parseFloat(q.value||1),window.requestAnimationFrame(G)}),document.querySelector("#download-button").addEventListener("click",()=>{t.download_frame("a-complex-map.png")});let k=document.querySelector("#canvas-location");function A(){let e=M.value||"cexp(cinv(z))",r={renderer:"gpu",shader:`\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tvarying vec2 uv;\n\t\t\t\n\t\t\tuniform float aspect_ratio;\n\t\t\t\n\t\t\tuniform float world_center_x;\n\t\t\tuniform float world_center_y;\n\t\t\tuniform float world_size;\n\t\t\t\n\t\t\tuniform float black_point;\n\t\t\tuniform float white_point;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t${COMPLEX_GLSL}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvec3 hsv2rgb(vec3 c)\n\t\t\t{\n\t\t\t\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t//Returns f(z) for a polynomial f with given roots.\n\t\t\tvec2 f(vec2 z)\n\t\t\t{\n\t\t\t\treturn ${e};\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tvec2 z;\n\t\t\t\t\n\t\t\t\tif (aspect_ratio >= 1.0)\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * aspect_ratio * world_size + world_center_x, uv.y * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tz = vec2(uv.x * world_size + world_center_x, uv.y / aspect_ratio * world_size + world_center_y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvec2 image_z = f(z);\n\t\t\t\tfloat modulus = length(image_z);\n\t\t\t\t\n\t\t\t\tfloat h = atan(image_z.y, image_z.x) / 6.283;\n\t\t\t\tfloat s = 1.0 / (1.0 + .01 * (modulus / white_point / white_point));\n\t\t\t\tfloat v = 1.0 / (1.0 + .01 / (modulus * black_point * black_point));\n\t\t\t\t\n\t\t\t\tgl_FragColor = vec4(hsv2rgb(vec3(h, s, v)), 1.0);\n\t\t\t}\n\t\t`,canvas_width:500,canvas_height:500,world_width:2,world_height:2,world_center_x:0,world_center_y:0,use_fullscreen:!0,true_fullscreen:!0,use_fullscreen_button:!0,enter_fullscreen_button_icon_path:"/graphics/general-icons/enter-fullscreen.png",exit_fullscreen_button_icon_path:"/graphics/general-icons/exit-fullscreen.png",switch_fullscreen_callback:I,mousedown_callback:F,touchstart_callback:F,mousedrag_callback:S,touchmove_callback:S,mouseup_callback:E,touchend_callback:E,wheel_callback:L,pinch_callback:K};try{t.output_canvas_container.parentNode.remove(),k.insertAdjacentHTML("beforebegin",'\n\t\t\t\t<div>\n\t\t\t\t\t<canvas id="output-canvas" class="output-canvas"></canvas>\n\t\t\t\t</div>\n\t\t\t')}catch(t){}(t=new Wilson(document.querySelector("#output-canvas"),r)).render.init_uniforms(["aspect_ratio","world_center_x","world_center_y","world_size","black_point","white_point"]),o=[],n=-.585,_=0,d=0,s=0,u=0,w=0,h=0,t.gl.uniform1f(t.uniforms.aspect_ratio,1),window.requestAnimationFrame(G)}function F(e,n,o){if(u=0,w=0,h=0,_=0,d=0,s=0,DEBUG){t.render.draw_frame();let o=t.utils.interpolate.world_to_canvas(e,n),r=new Uint8Array(4);this.parent.gl.readPixels(o[1],t.canvas_height-o[0],1,1,this.parent.gl.RGBA,this.parent.gl.UNSIGNED_BYTE,r);let l=r[0],c=r[1],_=r[2],d=Math.max(l,c,_),s=d-Math.min(l,c,_),u=0,w=0,h=0;0!==d&&(w=s/d),h=d/255;let f=2*(u=1-(u=0===s?0:l===d?(6+(c-_)/s)%6:c===d?2+(_-l)/s:_===d?4+(l-c)/s:0)/6)*Math.PI,p=0;if(1===h&&0===w)return void console.log("Infinity");if(0===h&&0===w)return void console.log("0");let m=(p=h<1?.01*h/(i*i*(1-h)):100*(1-w)*a*a/w)*Math.cos(f),v=p*Math.sin(f),g="+";v<0&&(g="-"),console.log(`${m} ${g} ${Math.abs(v)}i`)}}function S(e,n,o,r,i){t.world_center_x-=o,t.world_center_y-=r,_=-o/t.world_width,d=-r/t.world_height,window.requestAnimationFrame(G)}function E(t,e,n){Math.sqrt(_*_+d*d)>=p&&(u=_,w=d),Math.abs(s)>=g&&(h=s),window.requestAnimationFrame(G)}function L(t,e,o,r){l=t,c=e,Math.abs(o/100)<.3?n+=o/100:h+=.05*Math.sign(o),$()}function K(o,r,i,a){e>=1?(n-=i/t.world_width*10,s=-i/t.world_width*10):(n-=i/t.world_height*10,s=-i/t.world_height*10),l=o,c=r,$()}function $(){if(e>=1){let o=t.input.get_zoomed_world_center(l,c,3*Math.pow(2,n)*e,3*Math.pow(2,n));t.world_width=3*Math.pow(2,n)*e,t.world_height=3*Math.pow(2,n),t.world_center_x=o[0],t.world_center_y=o[1]}else{let o=t.input.get_zoomed_world_center(l,c,3*Math.pow(2,n),3*Math.pow(2,n)/e);t.world_width=3*Math.pow(2,n),t.world_height=3*Math.pow(2,n)/e,t.world_center_x=o[0],t.world_center_y=o[1]}window.requestAnimationFrame(G)}function G(o){let r=o-y;y=o,0!==r&&(t.gl.uniform1f(t.uniforms.aspect_ratio,e),t.gl.uniform1f(t.uniforms.world_center_x,t.world_center_x),t.gl.uniform1f(t.uniforms.world_center_y,t.world_center_y),t.gl.uniform1f(t.uniforms.world_size,Math.min(t.world_height,t.world_width)/2),t.gl.uniform1f(t.uniforms.black_point,i),t.gl.uniform1f(t.uniforms.white_point,a),t.render.draw_frame(),r>=50&&(u=0,w=0,h=0,_=0,d=0,s=0),0===u&&0===w&&0===h||(t.world_center_x+=u*t.world_width,t.world_center_y+=w*t.world_height,u*=f,w*=f,Math.sqrt(u*u+w*w)<m&&(u=0,w=0),n+=h,$(),h*=v,Math.abs(h)<x&&(h=0),window.requestAnimationFrame(G)))}function I(){t.fullscreen.currently_fullscreen?(e=window.innerWidth/window.innerHeight)>=1?(t.change_canvas_size(r,Math.floor(r/e)),t.world_width=3*Math.pow(2,n)*e,t.world_height=3*Math.pow(2,n)):(t.change_canvas_size(Math.floor(r*e),r),t.world_width=3*Math.pow(2,n),t.world_height=3*Math.pow(2,n)/e):(e=1,t.change_canvas_size(r,r),t.world_width=3*Math.pow(2,n),t.world_height=3*Math.pow(2,n)),window.requestAnimationFrame(G)}A(),window.addEventListener("resize",I),Page.temporary_handlers.resize.push(I)}();