import{FlagOverlap}from"./class.min.js";import{countryNameList,countryNames,possibleAnswers}from"./countryData.min.js";import{Button}from"/scripts/src/buttons.min.js";import{Checkbox}from"/scripts/src/checkboxes.min.js";import{addHoverEvent}from"/scripts/src/hoverEvents.min.js";import{$,$$,addTemporaryListener}from"/scripts/src/main.min.js";import{fuzzySearch}from"/scripts/src/utils.min.js";export default async function(){const s=new FlagOverlap({canvas:$("#output-canvas"),overlayCanvas:$("#overlay-canvas"),guessCanvases:Array.from($$(".guess-canvas")),overlayCanvases:Array.from($$(".overlay-canvas")),progressBars:Array.from($$(".progress-bar")),winOverlay:$("#win-overlay")}),r=new Checkbox({element:$("#show-diffs-checkbox"),name:"Show guess overlaps",onInput:function(){s.setShowDiffs(r.checked)},checked:!0,persistState:!1});let t=!1,n=0;const a=$("#guess-selector-input"),o=$("#country-list");for(const[d,m]of possibleAnswers.all.entries()){var c=document.createElement("div");c.classList.add("country-list-item"),c.innerHTML=`
			<img src="graphics/${m}.png">
			<p class="body-text">${countryNames[m]}</p>
		`,o.appendChild(c),addHoverEvent({element:c,addBounceOnTouch:()=>!0,callback:isHovering=>{isHovering&&(o.children.length>n&&n!==d&&o.children[n].classList.remove("hover"),n=d)}}),c.addEventListener("click",async()=>{await s.loadPromise,s.guessFlag(m)})}function i(){t=!0,o.style.display="flex",o.children.length>n&&o.children[n].classList.remove("hover"),(n=0)<o.children.length&&o.children[0].classList.add("hover"),requestAnimationFrame(()=>{o.style.transform="scale(1)",o.style.opacity=1})}function l(){t=!1,o.style.transform="scale(0.975)",o.style.opacity=0,setTimeout(()=>o.style.display="none",125)}a.addEventListener("focus",i),a.addEventListener("blur",l),a.addEventListener("input",function(){fuzzySearch(a.value,countryNameList),i()}),addTemporaryListener({object:document.documentElement,event:"keydown",callback:e=>{"Escape"===e.key&&t?document.activeElement.blur():"ArrowDown"===e.key?n<o.children.length-1&&(o.children[n].classList.remove("hover"),n++,o.children[n].classList.add("hover")):"ArrowUp"===e.key?0<n&&(o.children[n].classList.remove("hover"),n--,o.children[n].classList.add("hover")):"Enter"===e.key&&(o.children[n].click(),l())}});new Button({element:$("#replay-button"),name:"Play Again",onClick:()=>s.replay()});await s.loadPromise}