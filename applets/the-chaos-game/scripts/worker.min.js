"use strict";onmessage=async function(e){num_vertices=e.data[0],grid_size=e.data[1],await draw_chaos_game()};let num_vertices=null,grid_size=null,image=[],vertices=[],center_row=null,center_col=null,current_row=null,current_col=null,num_pixels_at_max=0;function draw_chaos_game(){return new Promise(function(e,r){image=[];for(let e=0;e<grid_size;e++){image.push([]);for(let r=0;r<grid_size;r++)image[e].push([0,0,0])}let t=2*Math.floor(num_vertices/2)*Math.PI/num_vertices,i=grid_size/2-grid_size/2.5,_=grid_size/2-grid_size/2.5*Math.cos(t),c=i+(grid_size-_);center_row=Math.floor(c/2+grid_size/2.5),center_col=Math.floor(grid_size/2),current_row=center_row,current_col=center_col,vertices=[];for(let e=0;e<num_vertices;e++){let r=e/num_vertices*2*Math.PI,t=Math.floor(-Math.cos(r)*grid_size/2.5+center_row),i=Math.floor(Math.sin(r)*grid_size/2.5+center_col);vertices.push([t,i])}let o=0;for(;;){o%(100*grid_size)==0&&postMessage([image]);let r=Math.floor(Math.random()*num_vertices);current_row=Math.floor((current_row+vertices[r][0])/2),current_col=Math.floor((current_col+vertices[r][1])/2);let t=HSVtoRGB((Math.atan2(current_col-grid_size/2,current_row-grid_size/2)+Math.PI)/(2*Math.PI),((current_row-grid_size/2)*(current_row-grid_size/2)+(current_col-grid_size/2)*(current_col-grid_size/2))/(grid_size*grid_size/13),1);t[0]/=255,t[1]/=255,t[2]/=255;for(let r=0;r<3;r++)if(image[current_row][current_col][r]+=8*t[r],image[current_row][current_col][r]>=255&&(num_pixels_at_max++,image[current_row][current_col][r]=255,num_pixels_at_max/(grid_size*grid_size)>.004))return postMessage([image]),void e();o++}postMessage([image]),e()})}function HSVtoRGB(e,r,t){let i,_,c,o,s,a,n,u;switch(a=t*(1-r),n=t*(1-(s=6*e-(o=Math.floor(6*e)))*r),u=t*(1-(1-s)*r),o%6){case 0:i=t,_=u,c=a;break;case 1:i=n,_=t,c=a;break;case 2:i=a,_=t,c=u;break;case 3:i=a,_=n,c=t;break;case 4:i=u,_=a,c=t;break;case 5:i=t,_=a,c=n}return[Math.round(255*i),Math.round(255*_),Math.round(255*c)]}